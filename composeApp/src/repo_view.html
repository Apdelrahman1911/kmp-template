
<html>
<head>
<meta charset="utf-8">
<title>Repo Viewer</title>
<style>
body {
  background: #272822; color: #f8f8f2;
  font-family: monospace; padding: 20px;
}
pre.tree {
  background: #1e1f1c; padding: 15px;
  border-radius: 6px; color: #a6e22e;
  overflow-x: auto; line-height: 1.4;
}
h1 { color: #a6e22e; }
h2 {
  margin-top: 40px;
  border-bottom: 1px solid #444;
  color: #66d9ef;
  font-size: 1.1rem;
}
button {
  background: #66d9ef; color: #272822;
  border: none; padding: 10px 15px;
  margin-right: 10px; border-radius: 4px;
  cursor: pointer; font-weight: bold;
}
button:hover { background: #5cb6cf; }
#buttons { margin-bottom: 20px; }
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #49483e }
.highlight { background: #272822; color: #F8F8F2 }
.highlight .c { color: #959077 } /* Comment */
.highlight .err { color: #ED007E; background-color: #1E0010 } /* Error */
.highlight .esc { color: #F8F8F2 } /* Escape */
.highlight .g { color: #F8F8F2 } /* Generic */
.highlight .k { color: #66D9EF } /* Keyword */
.highlight .l { color: #AE81FF } /* Literal */
.highlight .n { color: #F8F8F2 } /* Name */
.highlight .o { color: #FF4689 } /* Operator */
.highlight .x { color: #F8F8F2 } /* Other */
.highlight .p { color: #F8F8F2 } /* Punctuation */
.highlight .ch { color: #959077 } /* Comment.Hashbang */
.highlight .cm { color: #959077 } /* Comment.Multiline */
.highlight .cp { color: #959077 } /* Comment.Preproc */
.highlight .cpf { color: #959077 } /* Comment.PreprocFile */
.highlight .c1 { color: #959077 } /* Comment.Single */
.highlight .cs { color: #959077 } /* Comment.Special */
.highlight .gd { color: #FF4689 } /* Generic.Deleted */
.highlight .ge { color: #F8F8F2; font-style: italic } /* Generic.Emph */
.highlight .ges { color: #F8F8F2; font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #F8F8F2 } /* Generic.Error */
.highlight .gh { color: #F8F8F2 } /* Generic.Heading */
.highlight .gi { color: #A6E22E } /* Generic.Inserted */
.highlight .go { color: #66D9EF } /* Generic.Output */
.highlight .gp { color: #FF4689; font-weight: bold } /* Generic.Prompt */
.highlight .gs { color: #F8F8F2; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #959077 } /* Generic.Subheading */
.highlight .gt { color: #F8F8F2 } /* Generic.Traceback */
.highlight .kc { color: #66D9EF } /* Keyword.Constant */
.highlight .kd { color: #66D9EF } /* Keyword.Declaration */
.highlight .kn { color: #FF4689 } /* Keyword.Namespace */
.highlight .kp { color: #66D9EF } /* Keyword.Pseudo */
.highlight .kr { color: #66D9EF } /* Keyword.Reserved */
.highlight .kt { color: #66D9EF } /* Keyword.Type */
.highlight .ld { color: #E6DB74 } /* Literal.Date */
.highlight .m { color: #AE81FF } /* Literal.Number */
.highlight .s { color: #E6DB74 } /* Literal.String */
.highlight .na { color: #A6E22E } /* Name.Attribute */
.highlight .nb { color: #F8F8F2 } /* Name.Builtin */
.highlight .nc { color: #A6E22E } /* Name.Class */
.highlight .no { color: #66D9EF } /* Name.Constant */
.highlight .nd { color: #A6E22E } /* Name.Decorator */
.highlight .ni { color: #F8F8F2 } /* Name.Entity */
.highlight .ne { color: #A6E22E } /* Name.Exception */
.highlight .nf { color: #A6E22E } /* Name.Function */
.highlight .nl { color: #F8F8F2 } /* Name.Label */
.highlight .nn { color: #F8F8F2 } /* Name.Namespace */
.highlight .nx { color: #A6E22E } /* Name.Other */
.highlight .py { color: #F8F8F2 } /* Name.Property */
.highlight .nt { color: #FF4689 } /* Name.Tag */
.highlight .nv { color: #F8F8F2 } /* Name.Variable */
.highlight .ow { color: #FF4689 } /* Operator.Word */
.highlight .pm { color: #F8F8F2 } /* Punctuation.Marker */
.highlight .w { color: #F8F8F2 } /* Text.Whitespace */
.highlight .mb { color: #AE81FF } /* Literal.Number.Bin */
.highlight .mf { color: #AE81FF } /* Literal.Number.Float */
.highlight .mh { color: #AE81FF } /* Literal.Number.Hex */
.highlight .mi { color: #AE81FF } /* Literal.Number.Integer */
.highlight .mo { color: #AE81FF } /* Literal.Number.Oct */
.highlight .sa { color: #E6DB74 } /* Literal.String.Affix */
.highlight .sb { color: #E6DB74 } /* Literal.String.Backtick */
.highlight .sc { color: #E6DB74 } /* Literal.String.Char */
.highlight .dl { color: #E6DB74 } /* Literal.String.Delimiter */
.highlight .sd { color: #E6DB74 } /* Literal.String.Doc */
.highlight .s2 { color: #E6DB74 } /* Literal.String.Double */
.highlight .se { color: #AE81FF } /* Literal.String.Escape */
.highlight .sh { color: #E6DB74 } /* Literal.String.Heredoc */
.highlight .si { color: #E6DB74 } /* Literal.String.Interpol */
.highlight .sx { color: #E6DB74 } /* Literal.String.Other */
.highlight .sr { color: #E6DB74 } /* Literal.String.Regex */
.highlight .s1 { color: #E6DB74 } /* Literal.String.Single */
.highlight .ss { color: #E6DB74 } /* Literal.String.Symbol */
.highlight .bp { color: #F8F8F2 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #A6E22E } /* Name.Function.Magic */
.highlight .vc { color: #F8F8F2 } /* Name.Variable.Class */
.highlight .vg { color: #F8F8F2 } /* Name.Variable.Global */
.highlight .vi { color: #F8F8F2 } /* Name.Variable.Instance */
.highlight .vm { color: #F8F8F2 } /* Name.Variable.Magic */
.highlight .il { color: #AE81FF } /* Literal.Number.Integer.Long */
</style>
</head>
<body>
<h1>ğŸ“ Repository Structure</h1>

<div id="buttons">
  <button onclick="copyAll()">ğŸ“‹ Copy All Text</button>
  <button onclick="downloadText()">ğŸ’¾ Download as .txt</button>
</div>

<pre id="tree" class="tree">â”œâ”€â”€ androidMain
â”‚   â”œâ”€â”€ kotlin
â”‚   â”‚   â””â”€â”€ me
â”‚   â”‚       â””â”€â”€ onvo
â”‚   â”‚           â””â”€â”€ onvo
â”‚   â”‚               â”œâ”€â”€ core
â”‚   â”‚               â”‚   â”œâ”€â”€ datastore
â”‚   â”‚               â”‚   â”‚   â””â”€â”€ DataStoreFactory.android.kt
â”‚   â”‚               â”‚   â”œâ”€â”€ device
â”‚   â”‚               â”‚   â”‚   â””â”€â”€ DeviceInfoProvider.android.kt
â”‚   â”‚               â”‚   â”œâ”€â”€ network
â”‚   â”‚               â”‚   â”‚   â””â”€â”€ HttpClientFactory.android.kt
â”‚   â”‚               â”‚   â””â”€â”€ util
â”‚   â”‚               â”‚       â””â”€â”€ CryptoUtil.android.kt
â”‚   â”‚               â”œâ”€â”€ di
â”‚   â”‚               â”‚   â”œâ”€â”€ initKoinAndroid.kt
â”‚   â”‚               â”‚   â””â”€â”€ platformModule.android.kt
â”‚   â”‚               â”œâ”€â”€ theme
â”‚   â”‚               â”‚   â””â”€â”€ splash_screen
â”‚   â”‚               â”‚       â””â”€â”€ shouldShowSplash.android.kt
â”‚   â”‚               â”œâ”€â”€ MainActivity.kt
â”‚   â”‚               â”œâ”€â”€ OnvoApp.kt
â”‚   â”‚               â””â”€â”€ Platform.android.kt
â”‚   â”œâ”€â”€ res
â”‚   â”‚   â”œâ”€â”€ drawable
â”‚   â”‚   â”‚   â””â”€â”€ ic_launcher_background.xml
â”‚   â”‚   â”œâ”€â”€ drawable-v24
â”‚   â”‚   â”‚   â””â”€â”€ ic_launcher_foreground.xml
â”‚   â”‚   â”œâ”€â”€ mipmap-anydpi-v26
â”‚   â”‚   â”‚   â”œâ”€â”€ ic_launcher.xml
â”‚   â”‚   â”‚   â””â”€â”€ ic_launcher_round.xml
â”‚   â”‚   â”œâ”€â”€ mipmap-hdpi
â”‚   â”‚   â”œâ”€â”€ mipmap-mdpi
â”‚   â”‚   â”œâ”€â”€ mipmap-xhdpi
â”‚   â”‚   â”œâ”€â”€ mipmap-xxhdpi
â”‚   â”‚   â”œâ”€â”€ mipmap-xxxhdpi
â”‚   â”‚   â””â”€â”€ values
â”‚   â”‚       â”œâ”€â”€ colors.xml
â”‚   â”‚       â”œâ”€â”€ strings.xml
â”‚   â”‚       â””â”€â”€ themes.xml
â”‚   â””â”€â”€ AndroidManifest.xml
â”œâ”€â”€ appleMain
â”‚   â””â”€â”€ kotlin
â”‚       â””â”€â”€ me
â”‚           â””â”€â”€ onvo
â”‚               â””â”€â”€ onvo
â”‚                   â”œâ”€â”€ core
â”‚                   â”‚   â””â”€â”€ network
â”‚                   â””â”€â”€ theme
â”‚                       â””â”€â”€ splash_screen
â”œâ”€â”€ commonMain
â”‚   â”œâ”€â”€ composeResources
â”‚   â”‚   â””â”€â”€ drawable
â”‚   â”‚       â””â”€â”€ compose-multiplatform.xml
â”‚   â””â”€â”€ kotlin
â”‚       â””â”€â”€ me
â”‚           â””â”€â”€ onvo
â”‚               â””â”€â”€ onvo
â”‚                   â”œâ”€â”€ core
â”‚                   â”‚   â”œâ”€â”€ config
â”‚                   â”‚   â”‚   â””â”€â”€ AppConfig.kt
â”‚                   â”‚   â”œâ”€â”€ datastore
â”‚                   â”‚   â”‚   â”œâ”€â”€ DataStoreFactory.kt
â”‚                   â”‚   â”‚   â””â”€â”€ PreferencesManager.kt
â”‚                   â”‚   â”œâ”€â”€ device
â”‚                   â”‚   â”‚   â””â”€â”€ DeviceInfoProvider.kt
â”‚                   â”‚   â”œâ”€â”€ network
â”‚                   â”‚   â”‚   â”œâ”€â”€ HttpClientFactory.kt
â”‚                   â”‚   â”‚   â””â”€â”€ NetworkConstants.kt
â”‚                   â”‚   â”œâ”€â”€ util
â”‚                   â”‚   â”‚   â”œâ”€â”€ CryptoUtil.kt
â”‚                   â”‚   â”‚   â””â”€â”€ State.kt
â”‚                   â”‚   â””â”€â”€ zxzx.kt
â”‚                   â”œâ”€â”€ data
â”‚                   â”‚   â”œâ”€â”€ mapper
â”‚                   â”‚   â”œâ”€â”€ network
â”‚                   â”‚   â”‚   â”œâ”€â”€ profile
â”‚                   â”‚   â”‚   â”œâ”€â”€ ApiService.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ ApiServiceImpl.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ AuthApiService.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ AuthApiServiceImpl.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ PasswordResetApiService.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ PasswordResetApiServiceImpl.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ ProfileApiService.kt
â”‚                   â”‚   â”‚   â””â”€â”€ ProfileApiServiceImpl.kt
â”‚                   â”‚   â”œâ”€â”€ repository
â”‚                   â”‚   â”‚   â”œâ”€â”€ AuthRepositoryImpl.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ ItemsRepositoryImpl.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ PasswordResetRepositoryImpl.kt
â”‚                   â”‚   â”‚   â””â”€â”€ ProfileRepositoryImpl.kt
â”‚                   â”‚   â””â”€â”€ zxczxc.kt
â”‚                   â”œâ”€â”€ di
â”‚                   â”‚   â”œâ”€â”€ AppComponent.kt
â”‚                   â”‚   â”œâ”€â”€ appModule.kt
â”‚                   â”‚   â”œâ”€â”€ authModule.kt
â”‚                   â”‚   â”œâ”€â”€ dataStoreModule.kt
â”‚                   â”‚   â”œâ”€â”€ initKoin.kt
â”‚                   â”‚   â”œâ”€â”€ networkModule.kt
â”‚                   â”‚   â”œâ”€â”€ platformModule.kt
â”‚                   â”‚   â”œâ”€â”€ profileModule.kt
â”‚                   â”‚   â”œâ”€â”€ RepositoryModule.kt
â”‚                   â”‚   â”œâ”€â”€ UseCaseModule.kt
â”‚                   â”‚   â””â”€â”€ ViewModelModule.kt
â”‚                   â”œâ”€â”€ domain
â”‚                   â”‚   â”œâ”€â”€ model
â”‚                   â”‚   â”‚   â”œâ”€â”€ auth.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ PasswordReset.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ Profile.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ Source.kt
â”‚                   â”‚   â”‚   â””â”€â”€ SourceState.kt
â”‚                   â”‚   â”œâ”€â”€ repository
â”‚                   â”‚   â”‚   â”œâ”€â”€ AuthRepository.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ ItemsRepository.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ PasswordResetRepository.kt
â”‚                   â”‚   â”‚   â””â”€â”€ ProfileRepository.kt
â”‚                   â”‚   â”œâ”€â”€ usecase
â”‚                   â”‚   â”‚   â”œâ”€â”€ auth
â”‚                   â”‚   â”‚   â”‚   â”œâ”€â”€ CheckInputUseCase.kt
â”‚                   â”‚   â”‚   â”‚   â”œâ”€â”€ GetTokenUseCase.kt
â”‚                   â”‚   â”‚   â”‚   â”œâ”€â”€ GetUserSessionUseCase.kt
â”‚                   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginUseCase.kt
â”‚                   â”‚   â”‚   â”‚   â””â”€â”€ LogoutUseCase.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ passwordreset
â”‚                   â”‚   â”‚   â”‚   â”œâ”€â”€ ChangePasswordUseCase.kt
â”‚                   â”‚   â”‚   â”‚   â”œâ”€â”€ RequestResetCodeUseCase.kt
â”‚                   â”‚   â”‚   â”‚   â””â”€â”€ SubmitResetCodeUseCase.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ profile
â”‚                   â”‚   â”‚   â”‚   â”œâ”€â”€ GetCurrentUserStatusUseCase.kt
â”‚                   â”‚   â”‚   â”‚   â””â”€â”€ GetUserProfileUseCase.kt
â”‚                   â”‚   â”‚   â””â”€â”€ GetSourcesUseCase.kt
â”‚                   â”‚   â””â”€â”€ assadsa.kt
â”‚                   â”œâ”€â”€ navigation
â”‚                   â”‚   â”œâ”€â”€ AppNavigation.kt
â”‚                   â”‚   â””â”€â”€ Screen.kt
â”‚                   â”œâ”€â”€ presentation
â”‚                   â”‚   â”œâ”€â”€ ui
â”‚                   â”‚   â”‚   â”œâ”€â”€ LoginScreen.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ PasswordResetScreen.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ ProfileScreen.kt
â”‚                   â”‚   â”‚   â””â”€â”€ SourcesScreen.kt
â”‚                   â”‚   â”œâ”€â”€ viewmodel
â”‚                   â”‚   â”‚   â”œâ”€â”€ AuthViewModel.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ PasswordResetViewModel.kt
â”‚                   â”‚   â”‚   â”œâ”€â”€ ProfileViewModel.kt
â”‚                   â”‚   â”‚   â””â”€â”€ SourcesViewModel.kt
â”‚                   â”‚   â”œâ”€â”€ asdas.kt
â”‚                   â”‚   â””â”€â”€ AuthUiState.kt
â”‚                   â”œâ”€â”€ test
â”‚                   â”‚   â”œâ”€â”€ screens.kt
â”‚                   â”‚   â””â”€â”€ SettingsScreen.kt
â”‚                   â”œâ”€â”€ theme
â”‚                   â”‚   â”œâ”€â”€ splash_screen
â”‚                   â”‚   â”‚   â”œâ”€â”€ shouldShowSplash.kt
â”‚                   â”‚   â”‚   â””â”€â”€ SplashScreen.kt
â”‚                   â”‚   â”œâ”€â”€ ThemeManager.kt
â”‚                   â”‚   â”œâ”€â”€ Themes.kt
â”‚                   â”‚   â””â”€â”€ ThemeViewModel.kt
â”‚                   â”œâ”€â”€ App.kt
â”‚                   â”œâ”€â”€ Greeting.kt
â”‚                   â””â”€â”€ Platform.kt
â”œâ”€â”€ iosMain
â”‚   â””â”€â”€ kotlin
â”‚       â””â”€â”€ me
â”‚           â””â”€â”€ onvo
â”‚               â””â”€â”€ onvo
â”‚                   â”œâ”€â”€ core
â”‚                   â”‚   â”œâ”€â”€ device
â”‚                   â”‚   â”‚   â””â”€â”€ DeviceInfoProvider.ios.kt
â”‚                   â”‚   â””â”€â”€ util
â”‚                   â”‚       â””â”€â”€ CryptoUtil.ios.kt
â”‚                   â”œâ”€â”€ di
â”‚                   â”‚   â””â”€â”€ platformModule.ios.kt
â”‚                   â”œâ”€â”€ theme
â”‚                   â”‚   â””â”€â”€ splash_screen
â”‚                   â”‚       â””â”€â”€ shouldShowSplash.ios.kt
â”‚                   â”œâ”€â”€ MainViewController.kt
â”‚                   â””â”€â”€ Platform.ios.kt
â”œâ”€â”€ jvmMain
â”‚   â””â”€â”€ kotlin
â”‚       â””â”€â”€ me
â”‚           â””â”€â”€ onvo
â”‚               â””â”€â”€ onvo
â”‚                   â”œâ”€â”€ core
â”‚                   â”‚   â”œâ”€â”€ datastore
â”‚                   â”‚   â”‚   â””â”€â”€ DataStoreFactory.jvm.kt
â”‚                   â”‚   â”œâ”€â”€ device
â”‚                   â”‚   â”‚   â””â”€â”€ DeviceInfoProvider.jvm.kt
â”‚                   â”‚   â”œâ”€â”€ network
â”‚                   â”‚   â”‚   â””â”€â”€ HttpClientFactory.jvm.kt
â”‚                   â”‚   â””â”€â”€ util
â”‚                   â”‚       â””â”€â”€ CryptoUtil.jvm.kt
â”‚                   â”œâ”€â”€ di
â”‚                   â”‚   â””â”€â”€ platformModule.jvm.kt
â”‚                   â”œâ”€â”€ theme
â”‚                   â”‚   â””â”€â”€ splash_screen
â”‚                   â”‚       â””â”€â”€ shouldShowSplash.jvm.kt
â”‚                   â”œâ”€â”€ main.kt
â”‚                   â””â”€â”€ Platform.jvm.kt
â”œâ”€â”€ nativeMain
â”‚   â””â”€â”€ kotlin
â”‚       â””â”€â”€ me
â”‚           â””â”€â”€ onvo
â”‚               â””â”€â”€ onvo
â”‚                   â””â”€â”€ core
â”‚                       â”œâ”€â”€ datastore
â”‚                       â”‚   â””â”€â”€ DataStoreFactory.native.kt
â”‚                       â””â”€â”€ network
â”‚                           â””â”€â”€ HttpClientFactory.native.kt
â””â”€â”€ repo_viewer.py</pre>

<h1>ğŸ“„ Code Contents</h1>
<div id="code"><h2 id='androidMain_AndroidManifest.xml'>androidMain\AndroidManifest.xml</h2><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.READ_PHONE_STATE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;application</span>
<span class="w">        </span><span class="na">android:allowBackup=</span><span class="s">&quot;true&quot;</span>
<span class="w">        </span><span class="na">android:icon=</span><span class="s">&quot;@mipmap/ic_launcher&quot;</span>
<span class="w">        </span><span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span>
<span class="w">        </span><span class="na">android:roundIcon=</span><span class="s">&quot;@mipmap/ic_launcher_round&quot;</span>
<span class="w">        </span><span class="na">android:supportsRtl=</span><span class="s">&quot;true&quot;</span>
<span class="w">        </span><span class="na">android:name=</span><span class="s">&quot;.OnvoApp&quot;</span>
<span class="w">        </span><span class="na">android:theme=</span><span class="s">&quot;@style/AppTheme&quot;</span><span class="nt">&gt;</span>

<span class="w">        </span><span class="nt">&lt;activity</span>
<span class="w">            </span><span class="na">android:exported=</span><span class="s">&quot;true&quot;</span>
<span class="w">            </span><span class="na">android:name=</span><span class="s">&quot;.MainActivity&quot;</span>
<span class="w">            </span><span class="na">android:theme=</span><span class="s">&quot;@style/SplashTheme&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;intent-filter&gt;</span>
<span class="w">                </span><span class="nt">&lt;action</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;category</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/intent-filter&gt;</span>
<span class="w">        </span><span class="nt">&lt;/activity&gt;</span>
<span class="w">    </span><span class="nt">&lt;/application&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_core_datastore_DataStoreFactory.android.kt'>androidMain\kotlin\me\onvo\onvo\core\datastore\DataStoreFactory.android.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.core.DataStore</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.Preferences</span>
<span class="k">import</span><span class="w"> </span><span class="nn">android.content.Context</span>

<span class="kd">private</span><span class="w"> </span><span class="kd">lateinit</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">applicationContext</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">initPreferencesDataStore</span><span class="p">(</span><span class="n">appContext</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">appContext</span>
<span class="p">}</span>


<span class="kd">fun</span><span class="w"> </span><span class="nf">getPreferencesDataStorePath</span><span class="p">(</span><span class="n">appContext</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="p">):</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">appContext</span><span class="p">.</span><span class="na">filesDir</span><span class="p">.</span><span class="na">resolve</span><span class="p">(</span><span class="n">dataStoreFileName</span><span class="p">).</span><span class="na">absolutePath</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">createPreferencesDataStore</span><span class="p">():</span><span class="w"> </span><span class="n">DataStore</span><span class="o">&lt;</span><span class="n">Preferences</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getPreferencesDataStorePath</span><span class="p">(</span><span class="n">applicationContext</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">getPreferencesDataStore</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_core_device_DeviceInfoProvider.android.kt'>androidMain\kotlin\me\onvo\onvo\core\device\DeviceInfoProvider.android.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device</span>

<span class="k">import</span><span class="w"> </span><span class="nn">android.annotation.SuppressLint</span>
<span class="k">import</span><span class="w"> </span><span class="nn">android.content.Context</span>
<span class="k">import</span><span class="w"> </span><span class="nn">android.content.pm.PackageManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">android.os.Build</span>
<span class="k">import</span><span class="w"> </span><span class="nn">android.provider.Settings</span>
<span class="k">import</span><span class="w"> </span><span class="nn">android.telephony.TelephonyManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.DeviceInfo</span>
<span class="k">import</span><span class="w"> </span><span class="nn">java.util.*</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">DeviceInfoProvider</span><span class="p">(</span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">context</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@SuppressLint</span><span class="p">(</span><span class="s">&quot;HardwareIds&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getDeviceInfo</span><span class="p">():</span><span class="w"> </span><span class="n">DeviceInfo</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">deviceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Settings</span><span class="p">.</span><span class="na">Secure</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="na">contentResolver</span><span class="p">,</span><span class="w"> </span><span class="n">Settings</span><span class="p">.</span><span class="na">Secure</span><span class="p">.</span><span class="na">ANDROID_ID</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kc">null</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">DeviceInfo</span><span class="p">(</span>
<span class="w">            </span><span class="n">deviceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deviceId</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">brand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Build</span><span class="p">.</span><span class="na">BRAND</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Build</span><span class="p">.</span><span class="na">MODEL</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">systemName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Android&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">systemVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Build</span><span class="p">.</span><span class="na">VERSION</span><span class="p">.</span><span class="na">RELEASE</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">appVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAppVersion</span><span class="p">(),</span>
<span class="w">            </span><span class="n">buildNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAppBuildNumber</span><span class="p">(),</span>
<span class="w">            </span><span class="n">uniqueId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deviceId</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">deviceName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Build</span><span class="p">.</span><span class="na">DEVICE</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">isTablet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isTablet</span><span class="p">(),</span>
<span class="w">            </span><span class="n">carrier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCarrier</span><span class="p">(),</span>
<span class="w">            </span><span class="n">timezone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TimeZone</span><span class="p">.</span><span class="na">getDefault</span><span class="p">().</span><span class="na">id</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAppVersion</span><span class="p">():</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">pInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">packageManager</span><span class="p">.</span><span class="na">getPackageInfo</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="na">packageName</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">            </span><span class="n">pInfo</span><span class="p">.</span><span class="na">versionName</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;1.0.0&quot;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">PackageManager</span><span class="p">.</span><span class="na">NameNotFoundException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="s">&quot;1.0.0&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAppBuildNumber</span><span class="p">():</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">pInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">packageManager</span><span class="p">.</span><span class="na">getPackageInfo</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="na">packageName</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Build</span><span class="p">.</span><span class="na">VERSION</span><span class="p">.</span><span class="na">SDK_INT</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">Build</span><span class="p">.</span><span class="na">VERSION_CODES</span><span class="p">.</span><span class="na">P</span><span class="p">)</span>
<span class="w">                </span><span class="n">pInfo</span><span class="p">.</span><span class="na">longVersionCode</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="nd">@Suppress</span><span class="p">(</span><span class="s">&quot;DEPRECATION&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">pInfo</span><span class="p">.</span><span class="na">versionCode</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="s">&quot;1&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isTablet</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">configuration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">resources</span><span class="p">.</span><span class="na">configuration</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">configuration</span><span class="p">.</span><span class="na">screenLayout</span><span class="w"> </span><span class="n">and</span>
<span class="w">                </span><span class="n">android</span><span class="p">.</span><span class="na">content</span><span class="p">.</span><span class="na">res</span><span class="p">.</span><span class="na">Configuration</span><span class="p">.</span><span class="na">SCREENLAYOUT_SIZE_MASK</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span>
<span class="w">                </span><span class="n">android</span><span class="p">.</span><span class="na">content</span><span class="p">.</span><span class="na">res</span><span class="p">.</span><span class="na">Configuration</span><span class="p">.</span><span class="na">SCREENLAYOUT_SIZE_LARGE</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getCarrier</span><span class="p">():</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">tm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getSystemService</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="na">TELEPHONY_SERVICE</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">TelephonyManager</span>
<span class="w">            </span><span class="n">tm</span><span class="p">.</span><span class="na">networkOperatorName</span><span class="p">.</span><span class="na">takeIf</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="s">&quot;Unknown&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_core_network_HttpClientFactory.android.kt'>androidMain\kotlin\me\onvo\onvo\core\network\HttpClientFactory.android.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.HttpClient</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.engine.okhttp.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.HttpTimeout</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.contentnegotiation.ContentNegotiation</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.serialization.kotlinx.json.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.Json</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.logging.*</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">HttpClientFactory</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">create</span><span class="p">():</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">(</span><span class="n">OkHttp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">install</span><span class="p">(</span><span class="n">ContentNegotiation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">json</span><span class="p">(</span><span class="n">Json</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ignoreUnknownKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">install</span><span class="p">(</span><span class="n">Logging</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Logger</span><span class="p">.</span><span class="na">SIMPLE</span><span class="p">;</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogLevel</span><span class="p">.</span><span class="na">INFO</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="n">install</span><span class="p">(</span><span class="n">HttpTimeout</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">requestTimeoutMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15000</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="n">engine</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// optional: configure OkHttpClient via preconfigured if you want cert pinning, interceptors, etc.</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_core_util_CryptoUtil.android.kt'>androidMain\kotlin\me\onvo\onvo\core\util\CryptoUtil.android.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util</span>

<span class="k">import</span><span class="w"> </span><span class="nn">java.security.MessageDigest</span>


<span class="kd">actual</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">CryptoUtil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">md5</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">md</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MessageDigest</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;MD5&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">digest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">md</span><span class="p">.</span><span class="na">digest</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">())</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">digest</span><span class="p">.</span><span class="na">joinToString</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;%02x&quot;</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_di_initKoinAndroid.kt'>androidMain\kotlin\me\onvo\onvo\di\initKoinAndroid.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">android.app.Application</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.android.ext.koin.androidContext</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.context.startKoin</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">initKoinAndroid</span><span class="p">(</span><span class="n">app</span><span class="p">:</span><span class="w"> </span><span class="n">Application</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">startKoin</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">androidContext</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="w">        </span><span class="n">modules</span><span class="p">(</span>
<span class="w">            </span><span class="n">networkModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">repositoryModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">useCaseModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">appModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">dataStoreModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">viewModelModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">authModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">platformModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">profileModule</span><span class="p">,</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_di_platformModule.android.kt'>androidMain\kotlin\me\onvo\onvo\di\platformModule.android.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.module.Module</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device.DeviceInfoProvider</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.android.ext.koin.androidContext</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">platformModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">DeviceInfoProvider</span><span class="p">(</span><span class="n">androidContext</span><span class="p">())</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_MainActivity.kt'>androidMain\kotlin\me\onvo\onvo\MainActivity.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">android.os.Bundle</span>
<span class="k">import</span><span class="w"> </span><span class="nn">android.util.Log</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.activity.ComponentActivity</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.activity.compose.setContent</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.activity.enableEdgeToEdge</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.Image</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.tooling.preview.Preview</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.core.splashscreen.SplashScreen.Companion.installSplashScreen</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore.initPreferencesDataStore</span>
<span class="k">import</span><span class="w"> </span><span class="nn">onvo.composeapp.generated.resources.Res</span>
<span class="k">import</span><span class="w"> </span><span class="nn">onvo.composeapp.generated.resources.compose_multiplatform</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.jetbrains.compose.resources.painterResource</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">MainActivity</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ComponentActivity</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span><span class="w"> </span><span class="n">Bundle?)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">initPreferencesDataStore</span><span class="p">(</span><span class="n">applicationContext</span><span class="p">)</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">splashScreen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">installSplashScreen</span><span class="p">()</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nv">keepSplashScreen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="n">splashScreen</span><span class="p">.</span><span class="na">setKeepOnScreenCondition</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">keepSplashScreen</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
<span class="w">        </span><span class="n">enableEdgeToEdge</span><span class="p">()</span>

<span class="w">        </span><span class="n">setContent</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&quot;MainActivityasdasdasd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;setContent&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">App</span><span class="p">()</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">window</span><span class="p">.</span><span class="na">decorView</span><span class="p">.</span><span class="na">post</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">keepSplashScreen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">//@Preview</span>
<span class="c1">//@Composable</span>
<span class="c1">//fun AppAndroidPreview() {</span>
<span class="c1">//    App()</span>
<span class="c1">//}</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_OnvoApp.kt'>androidMain\kotlin\me\onvo\onvo\OnvoApp.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">android.app.Application</span>
<span class="k">import</span><span class="w"> </span><span class="nn">android.util.Log</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.di.initKoin</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.di.initKoinAndroid</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.di.networkModule</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.android.ext.koin.androidContext</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.context.startKoin</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">OnvoApp</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Application</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">()</span>


<span class="w">        </span><span class="n">initKoinAndroid</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_Platform.android.kt'>androidMain\kotlin\me\onvo\onvo\Platform.android.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">android.os.Build</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">AndroidPlatform</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Platform</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Android </span><span class="si">${</span><span class="n">Build</span><span class="p">.</span><span class="na">VERSION</span><span class="p">.</span><span class="na">SDK_INT</span><span class="si">}</span><span class="s">&quot;</span>
<span class="p">}</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getPlatform</span><span class="p">():</span><span class="w"> </span><span class="n">Platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AndroidPlatform</span><span class="p">()</span>
</pre></div>
<h2 id='androidMain_kotlin_me_onvo_onvo_theme_splash_screen_shouldShowSplash.android.kt'>androidMain\kotlin\me\onvo\onvo\theme\splash_screen\shouldShowSplash.android.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.splash_screen</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">shouldShowSplash</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span>
<span class="w">    </span><span class="k">get</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</pre></div>
<h2 id='androidMain_res_drawable_ic_launcher_background.xml'>androidMain\res\drawable\ic_launcher_background.xml</h2><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;vector</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
<span class="w">    </span><span class="na">android:width=</span><span class="s">&quot;108dp&quot;</span>
<span class="w">    </span><span class="na">android:height=</span><span class="s">&quot;108dp&quot;</span>
<span class="w">    </span><span class="na">android:viewportWidth=</span><span class="s">&quot;108&quot;</span>
<span class="w">    </span><span class="na">android:viewportHeight=</span><span class="s">&quot;108&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#3DDC84&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,0h108v108h-108z&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M9,0L9,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M19,0L19,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M29,0L29,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M39,0L39,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M49,0L49,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M59,0L59,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M69,0L69,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M79,0L79,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M89,0L89,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M99,0L99,108&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,9L108,9&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,19L108,19&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,29L108,29&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,39L108,39&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,49L108,49&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,59L108,59&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,69L108,69&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,79L108,79&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,89L108,89&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M0,99L108,99&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M19,29L89,29&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M19,39L89,39&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M19,49L89,49&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M19,59L89,59&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M19,69L89,69&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M19,79L89,79&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M29,19L29,89&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M39,19L39,89&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M49,19L49,89&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M59,19L59,89&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M69,19L69,89&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M79,19L79,89&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;0.8&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#33FFFFFF&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/vector&gt;</span>
</pre></div>
<h2 id='androidMain_res_drawable-v24_ic_launcher_foreground.xml'>androidMain\res\drawable-v24\ic_launcher_foreground.xml</h2><div class="highlight"><pre><span></span><span class="nt">&lt;vector</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
<span class="w">    </span><span class="na">xmlns:aapt=</span><span class="s">&quot;http://schemas.android.com/aapt&quot;</span>
<span class="w">    </span><span class="na">android:width=</span><span class="s">&quot;108dp&quot;</span>
<span class="w">    </span><span class="na">android:height=</span><span class="s">&quot;108dp&quot;</span>
<span class="w">    </span><span class="na">android:viewportWidth=</span><span class="s">&quot;108&quot;</span>
<span class="w">    </span><span class="na">android:viewportHeight=</span><span class="s">&quot;108&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">android:pathData=</span><span class="s">&quot;M31,63.928c0,0 6.4,-11 12.1,-13.1c7.2,-2.6 26,-1.4 26,-1.4l38.1,38.1L107,108.928l-32,-1L31,63.928z&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;aapt:attr</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:fillColor&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;gradient</span>
<span class="w">                </span><span class="na">android:endX=</span><span class="s">&quot;85.84757&quot;</span>
<span class="w">                </span><span class="na">android:endY=</span><span class="s">&quot;92.4963&quot;</span>
<span class="w">                </span><span class="na">android:startX=</span><span class="s">&quot;42.9492&quot;</span>
<span class="w">                </span><span class="na">android:startY=</span><span class="s">&quot;49.59793&quot;</span>
<span class="w">                </span><span class="na">android:type=</span><span class="s">&quot;linear&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;item</span>
<span class="w">                    </span><span class="na">android:color=</span><span class="s">&quot;#44000000&quot;</span>
<span class="w">                    </span><span class="na">android:offset=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;item</span>
<span class="w">                    </span><span class="na">android:color=</span><span class="s">&quot;#00000000&quot;</span>
<span class="w">                    </span><span class="na">android:offset=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/gradient&gt;</span>
<span class="w">        </span><span class="nt">&lt;/aapt:attr&gt;</span>
<span class="w">    </span><span class="nt">&lt;/path&gt;</span>
<span class="w">    </span><span class="nt">&lt;path</span>
<span class="w">        </span><span class="na">android:fillColor=</span><span class="s">&quot;#FFFFFF&quot;</span>
<span class="w">        </span><span class="na">android:fillType=</span><span class="s">&quot;nonZero&quot;</span>
<span class="w">        </span><span class="na">android:pathData=</span><span class="s">&quot;M65.3,45.828l3.8,-6.6c0.2,-0.4 0.1,-0.9 -0.3,-1.1c-0.4,-0.2 -0.9,-0.1 -1.1,0.3l-3.9,6.7c-6.3,-2.8 -13.4,-2.8 -19.7,0l-3.9,-6.7c-0.2,-0.4 -0.7,-0.5 -1.1,-0.3C38.8,38.328 38.7,38.828 38.9,39.228l3.8,6.6C36.2,49.428 31.7,56.028 31,63.928h46C76.3,56.028 71.8,49.428 65.3,45.828zM43.4,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2c-0.3,-0.7 -0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C45.3,56.528 44.5,57.328 43.4,57.328L43.4,57.328zM64.6,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2s-0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C66.5,56.528 65.6,57.328 64.6,57.328L64.6,57.328z&quot;</span>
<span class="w">        </span><span class="na">android:strokeWidth=</span><span class="s">&quot;1&quot;</span>
<span class="w">        </span><span class="na">android:strokeColor=</span><span class="s">&quot;#00000000&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/vector&gt;</span>
</pre></div>
<h2 id='androidMain_res_mipmap-anydpi-v26_ic_launcher.xml'>androidMain\res\mipmap-anydpi-v26\ic_launcher.xml</h2><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;adaptive-icon</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;background</span><span class="w"> </span><span class="na">android:drawable=</span><span class="s">&quot;@drawable/ic_launcher_background&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;foreground</span><span class="w"> </span><span class="na">android:drawable=</span><span class="s">&quot;@drawable/ic_launcher_foreground&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/adaptive-icon&gt;</span>
</pre></div>
<h2 id='androidMain_res_mipmap-anydpi-v26_ic_launcher_round.xml'>androidMain\res\mipmap-anydpi-v26\ic_launcher_round.xml</h2><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;adaptive-icon</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;background</span><span class="w"> </span><span class="na">android:drawable=</span><span class="s">&quot;@drawable/ic_launcher_background&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;foreground</span><span class="w"> </span><span class="na">android:drawable=</span><span class="s">&quot;@drawable/ic_launcher_foreground&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/adaptive-icon&gt;</span>
</pre></div>
<h2 id='androidMain_res_values_colors.xml'>androidMain\res\values\colors.xml</h2><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;splash_background&quot;</span><span class="nt">&gt;</span>#6200EE<span class="nt">&lt;/color&gt;</span>
<span class="w">    </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;primary&quot;</span><span class="nt">&gt;</span>#6200EE<span class="nt">&lt;/color&gt;</span>
<span class="w">    </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;primary_dark&quot;</span><span class="nt">&gt;</span>#3700B3<span class="nt">&lt;/color&gt;</span>
<span class="w">    </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;accent&quot;</span><span class="nt">&gt;</span>#03DAC6<span class="nt">&lt;/color&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</pre></div>
<h2 id='androidMain_res_values_strings.xml'>androidMain\res\values\strings.xml</h2><div class="highlight"><pre><span></span><span class="nt">&lt;resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;app_name&quot;</span><span class="nt">&gt;</span>ONVO<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</pre></div>
<h2 id='androidMain_res_values_themes.xml'>androidMain\res\values\themes.xml</h2><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- Base application theme --&gt;</span>
<span class="w">    </span><span class="nt">&lt;style</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;AppTheme&quot;</span><span class="w"> </span><span class="na">parent=</span><span class="s">&quot;android:Theme.Material.Light.NoActionBar&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:statusBarColor&quot;</span><span class="nt">&gt;</span>@android:color/transparent<span class="nt">&lt;/item&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:windowLightStatusBar&quot;</span><span class="nt">&gt;</span>true<span class="nt">&lt;/item&gt;</span>
<span class="w">    </span><span class="nt">&lt;/style&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- Splash Screen Theme --&gt;</span>
<span class="w">    </span><span class="nt">&lt;style</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;SplashTheme&quot;</span><span class="w"> </span><span class="na">parent=</span><span class="s">&quot;AppTheme&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:windowBackground&quot;</span><span class="nt">&gt;</span>@color/splash_background<span class="nt">&lt;/item&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:statusBarColor&quot;</span><span class="nt">&gt;</span>@color/splash_background<span class="nt">&lt;/item&gt;</span>
<span class="w">    </span><span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</pre></div>
<h2 id='commonMain_composeResources_drawable_compose-multiplatform.xml'>commonMain\composeResources\drawable\compose-multiplatform.xml</h2><div class="highlight"><pre><span></span><span class="nt">&lt;vector</span>
<span class="w">    </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
<span class="w">    </span><span class="na">xmlns:aapt=</span><span class="s">&quot;http://schemas.android.com/aapt&quot;</span>
<span class="w">    </span><span class="na">android:width=</span><span class="s">&quot;450dp&quot;</span>
<span class="w">    </span><span class="na">android:height=</span><span class="s">&quot;450dp&quot;</span>
<span class="w">    </span><span class="na">android:viewportWidth=</span><span class="s">&quot;64&quot;</span>
<span class="w">    </span><span class="na">android:viewportHeight=</span><span class="s">&quot;64&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;path</span>
<span class="w">      </span><span class="na">android:pathData=</span><span class="s">&quot;M56.25,18V46L32,60 7.75,46V18L32,4Z&quot;</span>
<span class="w">      </span><span class="na">android:fillColor=</span><span class="s">&quot;#6075f2&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;path</span>
<span class="w">      </span><span class="na">android:pathData=</span><span class="s">&quot;m41.5,26.5v11L32,43V60L56.25,46V18Z&quot;</span>
<span class="w">      </span><span class="na">android:fillColor=</span><span class="s">&quot;#6b57ff&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;path</span>
<span class="w">      </span><span class="na">android:pathData=</span><span class="s">&quot;m32,43 l-9.5,-5.5v-11L7.75,18V46L32,60Z&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;aapt:attr</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:fillColor&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;gradient</span>
<span class="w">          </span><span class="na">android:centerX=</span><span class="s">&quot;23.131&quot;</span>
<span class="w">          </span><span class="na">android:centerY=</span><span class="s">&quot;18.441&quot;</span>
<span class="w">          </span><span class="na">android:gradientRadius=</span><span class="s">&quot;42.132&quot;</span>
<span class="w">          </span><span class="na">android:type=</span><span class="s">&quot;radial&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">android:offset=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">android:color=</span><span class="s">&quot;#FF5383EC&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">android:offset=</span><span class="s">&quot;0.867&quot;</span><span class="w"> </span><span class="na">android:color=</span><span class="s">&quot;#FF7F52FF&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/gradient&gt;</span>
<span class="w">    </span><span class="nt">&lt;/aapt:attr&gt;</span>
<span class="w">  </span><span class="nt">&lt;/path&gt;</span>
<span class="w">  </span><span class="nt">&lt;path</span>
<span class="w">      </span><span class="na">android:pathData=</span><span class="s">&quot;M22.5,26.5 L32,21 41.5,26.5 56.25,18 32,4 7.75,18Z&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;aapt:attr</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:fillColor&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;gradient</span>
<span class="w">          </span><span class="na">android:startX=</span><span class="s">&quot;44.172&quot;</span>
<span class="w">          </span><span class="na">android:startY=</span><span class="s">&quot;4.377&quot;</span>
<span class="w">          </span><span class="na">android:endX=</span><span class="s">&quot;17.973&quot;</span>
<span class="w">          </span><span class="na">android:endY=</span><span class="s">&quot;34.035&quot;</span>
<span class="w">          </span><span class="na">android:type=</span><span class="s">&quot;linear&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">android:offset=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">android:color=</span><span class="s">&quot;#FF33C3FF&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">android:offset=</span><span class="s">&quot;0.878&quot;</span><span class="w"> </span><span class="na">android:color=</span><span class="s">&quot;#FF5383EC&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/gradient&gt;</span>
<span class="w">    </span><span class="nt">&lt;/aapt:attr&gt;</span>
<span class="w">  </span><span class="nt">&lt;/path&gt;</span>
<span class="w">  </span><span class="nt">&lt;path</span>
<span class="w">      </span><span class="na">android:pathData=</span><span class="s">&quot;m32,21 l9.526,5.5v11L32,43 22.474,37.5v-11z&quot;</span>
<span class="w">      </span><span class="na">android:fillColor=</span><span class="s">&quot;#000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/vector&gt;</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_App.kt'>commonMain\kotlin\me\onvo\onvo\App.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>


<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.MaterialTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.navigation.AppNavigation</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui.SourcesScreen</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.AuthViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.SourcesViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.compose.koinInject</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.isSystemInDarkTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.darkColorScheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.lightColorScheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.AppTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeMode</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.splash_screen.SplashScreen</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.splash_screen.shouldShowSplash</span>


<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>


<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">showSplash</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="n">shouldShowSplash</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>


<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">themeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">ThemeViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">koinInject</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">themeMode</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">.</span><span class="na">themeMode</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isDarkMode</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">.</span><span class="na">isDarkMode</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">systemInDarkTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isSystemInDarkTheme</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Determine if dark theme should be used</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">useDarkTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">themeMode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">LIGHT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">DARK</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">SYSTEM</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">systemInDarkTheme</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">MaterialTheme</span><span class="p">(</span>
<span class="w">        </span><span class="n">colorScheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">useDarkTheme</span><span class="p">)</span><span class="w"> </span><span class="n">darkColorScheme</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">lightColorScheme</span><span class="p">()</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showSplash</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">SplashScreen</span><span class="p">(</span>
<span class="w">                </span><span class="n">onSplashFinished</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">showSplash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">AppNavigation</span><span class="p">(</span><span class="n">themeViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">//@Composable</span>
<span class="c1">//fun App() {</span>
<span class="c1">//    MaterialTheme {</span>
<span class="c1">//        val viewModel: SourcesViewModel = koinInject()</span>
<span class="c1">//        SourcesScreen(viewModel = viewModel)</span>
<span class="c1">//    }</span>
<span class="c1">//}</span>
<span class="c1">//</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_config_AppConfig.kt'>commonMain\kotlin\me\onvo\onvo\core\config\AppConfig.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.config</span>


<span class="kd">object</span><span class="w"> </span><span class="nc">AppConfig</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w">   </span><span class="nv">BASE_URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://api.onvo.me/&quot;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">TIMEOUT_MILLIS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15000L</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">ENABLE_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>

<span class="w">    </span><span class="kd">object</span><span class="w"> </span><span class="nc">Database</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;app_database.db&quot;</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">VERSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_datastore_DataStoreFactory.kt'>commonMain\kotlin\me\onvo\onvo\core\datastore\DataStoreFactory.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.core.DataStore</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.PreferenceDataStoreFactory</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.Preferences</span>
<span class="k">import</span><span class="w"> </span><span class="nn">okio.Path.Companion.toPath</span>

<span class="kd">internal</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">dataStoreFileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;onvo.preferences_pb&quot;</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">getPreferencesDataStore</span><span class="p">(</span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PreferenceDataStoreFactory</span><span class="p">.</span><span class="na">createWithPath</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">path</span><span class="p">.</span><span class="na">toPath</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">expect</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">createPreferencesDataStore</span><span class="p">():</span><span class="w"> </span><span class="n">DataStore</span><span class="o">&lt;</span><span class="n">Preferences</span><span class="o">&gt;</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_datastore_PreferencesManager.kt'>commonMain\kotlin\me\onvo\onvo\core\datastore\PreferencesManager.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/core/datastore/PreferencesManager.kt</span>
<span class="c1">// Complete updated PreferencesManager with auth methods</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.core.DataStore</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.Preferences</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.booleanPreferencesKey</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.edit</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.stringPreferencesKey</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.Flow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.first</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.map</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeMode</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">PreferencesManager</span><span class="p">(</span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">dataStore</span><span class="p">:</span><span class="w"> </span><span class="n">DataStore</span><span class="o">&lt;</span><span class="n">Preferences</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">companion</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="c1">// Theme preferences</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">IS_DARK_MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">booleanPreferencesKey</span><span class="p">(</span><span class="s">&quot;is_dark_mode&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">THEME_MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringPreferencesKey</span><span class="p">(</span><span class="s">&quot;theme_mode&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Drawable/Image preferences</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">SELECTED_AVATAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringPreferencesKey</span><span class="p">(</span><span class="s">&quot;selected_avatar&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">CUSTOM_BACKGROUND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringPreferencesKey</span><span class="p">(</span><span class="s">&quot;custom_background&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Auth preferences</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">AUTH_TOKEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringPreferencesKey</span><span class="p">(</span><span class="s">&quot;auth_token&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">USER_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringPreferencesKey</span><span class="p">(</span><span class="s">&quot;user_id&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">USER_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringPreferencesKey</span><span class="p">(</span><span class="s">&quot;user_name&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Other preferences</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">IS_FIRST_LAUNCH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">booleanPreferencesKey</span><span class="p">(</span><span class="s">&quot;is_first_launch&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ========== Theme Functions ==========</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setDarkMode</span><span class="p">(</span><span class="n">isDark</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">IS_DARK_MODE</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isDark</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isDarkMode</span><span class="p">():</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataStore</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">IS_DARK_MODE</span><span class="o">]</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setThemeMode</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">THEME_MODE</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="p">.</span><span class="na">name</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getThemeMode</span><span class="p">():</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="n">ThemeMode</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataStore</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">modeName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">preferences</span><span class="o">[</span><span class="n">THEME_MODE</span><span class="o">]</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">SYSTEM</span><span class="p">.</span><span class="na">name</span>
<span class="w">            </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">modeName</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ========== Drawable/Image Functions ==========</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setSelectedAvatar</span><span class="p">(</span><span class="n">avatarPath</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">SELECTED_AVATAR</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avatarPath</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getSelectedAvatar</span><span class="p">():</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="kt">String?</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataStore</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">SELECTED_AVATAR</span><span class="o">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setCustomBackground</span><span class="p">(</span><span class="n">backgroundPath</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">CUSTOM_BACKGROUND</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">backgroundPath</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getCustomBackground</span><span class="p">():</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="kt">String?</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataStore</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">CUSTOM_BACKGROUND</span><span class="o">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ========== Auth Functions ==========</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">saveAuthToken</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">AUTH_TOKEN</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAuthToken</span><span class="p">():</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataStore</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">AUTH_TOKEN</span><span class="o">]</span>
<span class="w">        </span><span class="p">}.</span><span class="na">first</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearAuthToken</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">AUTH_TOKEN</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">saveUserSession</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">USER_ID</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userId</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">USER_NAME</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userName</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getUserSession</span><span class="p">():</span><span class="w"> </span><span class="n">Pair</span><span class="o">&lt;</span><span class="kt">String?</span><span class="p">,</span><span class="w"> </span><span class="kt">String?</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataStore</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">Pair</span><span class="p">(</span><span class="n">preferences</span><span class="o">[</span><span class="n">USER_ID</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">preferences</span><span class="o">[</span><span class="n">USER_NAME</span><span class="o">]</span><span class="p">)</span>
<span class="w">        </span><span class="p">}.</span><span class="na">first</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearUserSession</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">USER_ID</span><span class="p">)</span>
<span class="w">            </span><span class="n">preferences</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">USER_NAME</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ========== Other Utility Functions ==========</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isFirstLaunch</span><span class="p">():</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataStore</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">IS_FIRST_LAUNCH</span><span class="o">]</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setFirstLaunchComplete</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">IS_FIRST_LAUNCH</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearAll</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="p">.</span><span class="na">clear</span><span class="p">()</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_device_DeviceInfoProvider.kt'>commonMain\kotlin\me\onvo\onvo\core\device\DeviceInfoProvider.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.DeviceInfo</span>

<span class="kd">expect</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">DeviceInfoProvider</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getDeviceInfo</span><span class="p">():</span><span class="w"> </span><span class="n">DeviceInfo</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_network_HttpClientFactory.kt'>commonMain\kotlin\me\onvo\onvo\core\network\HttpClientFactory.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.HttpClient</span>

<span class="kd">expect</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">HttpClientFactory</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">create</span><span class="p">():</span><span class="w"> </span><span class="n">HttpClient</span>

<span class="p">}</span>

<span class="c1">// Extension for easy access</span>
<span class="kd">fun</span><span class="w"> </span><span class="n">HttpClientFactory</span><span class="p">.</span><span class="nf">createConfigured</span><span class="p">():</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create</span><span class="p">()</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_network_NetworkConstants.kt'>commonMain\kotlin\me\onvo\onvo\core\network\NetworkConstants.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.network</span>


<span class="kd">object</span><span class="w"> </span><span class="nc">NetworkConstants</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">HEADER_AUTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Authorization&quot;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">HEADER_CONTENT_TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Content-Type&quot;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">CONTENT_TYPE_JSON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;application/json&quot;</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_util_CryptoUtil.kt'>commonMain\kotlin\me\onvo\onvo\core\util\CryptoUtil.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util</span>

<span class="kd">expect</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">CryptoUtil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">md5</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="kt">String</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_util_State.kt'>commonMain\kotlin\me\onvo\onvo\core\util\State.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util</span>


<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">State</span><span class="o">&lt;</span><span class="k">out</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Success</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">data</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">exception</span><span class="p">:</span><span class="w"> </span><span class="n">Throwable</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Nothing</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Loading</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Nothing</span><span class="o">&gt;</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">inline</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">State</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="na">onSuccess</span><span class="p">(</span><span class="n">action</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">)</span><span class="w"> </span><span class="n">action</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span>
<span class="p">}</span>

<span class="kd">inline</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">State</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span><span class="n">action</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">)</span><span class="w"> </span><span class="n">action</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_core_zxzx.kt'>commonMain\kotlin\me\onvo\onvo\core\zxzx.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core</span>

<span class="kd">object</span><span class="w"> </span><span class="nc">zxzx</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_network_ApiService.kt'>commonMain\kotlin\me\onvo\onvo\data\network\ApiService.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.Source</span>


<span class="c1">// commonMain</span>
<span class="kd">interface</span><span class="w"> </span><span class="nc">ApiService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">fetchItems</span><span class="p">():</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Source</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_network_ApiServiceImpl.kt'>commonMain\kotlin\me\onvo\onvo\data\network\ApiServiceImpl.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.HttpClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.call.body</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.request.get</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.statement.HttpResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.statement.bodyAsText</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.builtins.ListSerializer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.Json</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.Source</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ApiServiceImpl</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">client</span><span class="p">:</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">baseUrl</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">json</span><span class="p">:</span><span class="w"> </span><span class="n">Json</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ApiService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">fetchItems</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Source</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;https://yamimanga.me/source&quot;</span><span class="p">).</span><span class="na">bodyAsText</span><span class="p">()</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="na">decodeFromString</span><span class="p">(</span><span class="n">ListSerializer</span><span class="p">(</span><span class="n">Source</span><span class="p">.</span><span class="na">Serializer</span><span class="p">),</span><span class="w"> </span><span class="n">raw</span><span class="p">)</span>
<span class="w">            </span><span class="n">items</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Ã¢Å’ Error decoding response: </span><span class="si">${</span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="si">}</span><span class="s">\nRaw data: </span><span class="si">$</span><span class="n">raw</span><span class="s">&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">emptyList</span><span class="p">()</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_network_AuthApiService.kt'>commonMain\kotlin\me\onvo\onvo\data\network\AuthApiService.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.CheckInputResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.LoginRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.LoginResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.TokenRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.TokenResponse</span>


<span class="kd">interface</span><span class="w"> </span><span class="nc">AuthApiService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getToken</span><span class="p">(</span><span class="n">request</span><span class="p">:</span><span class="w"> </span><span class="n">TokenRequest</span><span class="p">):</span><span class="w"> </span><span class="n">TokenResponse</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">checkInput</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">CheckInputResponse</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">:</span><span class="w"> </span><span class="n">LoginRequest</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">LoginResponse</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">logout</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_network_AuthApiServiceImpl.kt'>commonMain\kotlin\me\onvo\onvo\data\network\AuthApiServiceImpl.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/data/network/AuthApiService.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.call.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.request.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.http.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.CheckInputRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.CheckInputResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.LoginRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.LoginResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.TokenRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.TokenResponse</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">AuthApiServiceImpl</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">client</span><span class="p">:</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">baseUrl</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthApiService</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getToken</span><span class="p">(</span><span class="n">request</span><span class="p">:</span><span class="w"> </span><span class="n">TokenRequest</span><span class="p">):</span><span class="w"> </span><span class="n">TokenResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">token&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">setBody</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="w">        </span><span class="p">}.</span><span class="na">body</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">checkInput</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">CheckInputResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">v2/auth/check&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">bearerAuth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">            </span><span class="n">setBody</span><span class="p">(</span><span class="n">CheckInputRequest</span><span class="p">(</span><span class="n">input</span><span class="p">))</span>
<span class="w">        </span><span class="p">}.</span><span class="na">body</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">:</span><span class="w"> </span><span class="n">LoginRequest</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">LoginResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">v2/auth/login&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">bearerAuth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">            </span><span class="n">setBody</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="w">        </span><span class="p">}.</span><span class="na">body</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">logout</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">client</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">v2/auth/logout&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">bearerAuth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_network_PasswordResetApiService.kt'>commonMain\kotlin\me\onvo\onvo\data\network\PasswordResetApiService.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.*</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">PasswordResetApiService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">requestResetCode</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">PasswordResetCodeResponse</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">submitResetCode</span><span class="p">(</span><span class="n">code</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">PasswordResetCodeVerifyResponse</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">changePassword</span><span class="p">(</span><span class="n">newPassword</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">PasswordChangeResponse</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_network_PasswordResetApiServiceImpl.kt'>commonMain\kotlin\me\onvo\onvo\data\network\PasswordResetApiServiceImpl.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.HttpClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.call.body</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.request.bearerAuth</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.request.post</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.request.setBody</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.http.ContentType</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.http.contentType</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordChangeRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordChangeResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordResetCodeResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordResetCodeSubmit</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordResetCodeVerifyResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordResetRequest</span>


<span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetApiServiceImpl</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">client</span><span class="p">:</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">baseUrl</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetApiService</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">requestResetCode</span><span class="p">(</span>
<span class="w">        </span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">PasswordResetCodeResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">v2/auth/reset/request&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">bearerAuth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">            </span><span class="n">setBody</span><span class="p">(</span><span class="n">PasswordResetRequest</span><span class="p">(</span><span class="n">userId</span><span class="p">))</span>
<span class="w">        </span><span class="p">}.</span><span class="na">body</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">submitResetCode</span><span class="p">(</span>
<span class="w">        </span><span class="n">code</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">PasswordResetCodeVerifyResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">v2/auth/reset/submit&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">bearerAuth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">            </span><span class="n">setBody</span><span class="p">(</span><span class="n">PasswordResetCodeSubmit</span><span class="p">(</span><span class="n">code</span><span class="p">))</span>
<span class="w">        </span><span class="p">}.</span><span class="na">body</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">changePassword</span><span class="p">(</span>
<span class="w">        </span><span class="n">newPassword</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">PasswordChangeResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">v2/auth/reset/change&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">bearerAuth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">            </span><span class="n">setBody</span><span class="p">(</span><span class="n">PasswordChangeRequest</span><span class="p">(</span><span class="n">newPassword</span><span class="p">))</span>
<span class="w">        </span><span class="p">}.</span><span class="na">body</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_network_ProfileApiService.kt'>commonMain\kotlin\me\onvo\onvo\data\network\ProfileApiService.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthStatusResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.UserProfileResponse</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">ProfileApiService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAuthStatus</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">AuthStatusResponse</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">):</span><span class="w"> </span><span class="n">UserProfileResponse</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_network_ProfileApiServiceImpl.kt'>commonMain\kotlin\me\onvo\onvo\data\network\ProfileApiServiceImpl.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.call.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.request.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.statement.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.http.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthStatusResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.UserProfileResponse</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ProfileApiServiceImpl</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">client</span><span class="p">:</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">baseUrl</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ProfileApiService</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAuthStatus</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">AuthStatusResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="p">:</span><span class="w"> </span><span class="n">HttpResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">v2/auth/status&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">bearerAuth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Check if unauthorized (401)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="na">Unauthorized</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">UnauthorizedException</span><span class="p">(</span><span class="s">&quot;Session expired or invalid token&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">body</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">):</span><span class="w"> </span><span class="n">UserProfileResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="n">baseUrl</span><span class="si">}</span><span class="s">v2/users&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">contentType</span><span class="p">(</span><span class="n">ContentType</span><span class="p">.</span><span class="na">Application</span><span class="p">.</span><span class="na">Json</span><span class="p">)</span>
<span class="w">            </span><span class="n">parameter</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span>
<span class="w">            </span><span class="n">token</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">bearerAuth</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">}.</span><span class="na">body</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Custom exception for unauthorized access</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UnauthorizedException</span><span class="p">(</span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_repository_AuthRepositoryImpl.kt'>commonMain\kotlin\me\onvo\onvo\data\repository\AuthRepositoryImpl.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/data/repository/AuthRepositoryImpl.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore.PreferencesManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.AuthApiService</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.CheckInputResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.DeviceInfo</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.LoginRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.LoginResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.TokenRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.TokenResponse</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">AuthRepositoryImpl</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authApiService</span><span class="p">:</span><span class="w"> </span><span class="n">AuthApiService</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">preferencesManager</span><span class="p">:</span><span class="w"> </span><span class="n">PreferencesManager</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getToken</span><span class="p">(</span><span class="n">deviceInfo</span><span class="p">:</span><span class="w"> </span><span class="n">DeviceInfo</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">TokenResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authApiService</span><span class="p">.</span><span class="na">getToken</span><span class="p">(</span><span class="n">TokenRequest</span><span class="p">(</span><span class="n">deviceInfo</span><span class="p">))</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to get token&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">checkInput</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">CheckInputResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authApiService</span><span class="p">.</span><span class="na">checkInput</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>

<span class="w">            </span><span class="c1">// Check if response contains an error</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isError</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">error</span><span class="p">),</span>
<span class="w">                    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;User not found&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s">&quot;Invalid response&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Received invalid response from server&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to check input&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span>
<span class="w">        </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="n">password</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">LoginResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoginRequest</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authApiService</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>

<span class="w">            </span><span class="c1">// Check if response contains an error</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isError</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">error</span><span class="p">),</span>
<span class="w">                    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Login failed&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s">&quot;Invalid credentials&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Login failed. Please check your credentials.&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Login failed&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">logout</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="kt">Unit</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">authApiService</span><span class="p">.</span><span class="na">logout</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="kt">Unit</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Logout failed&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Local storage methods</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">saveAuthToken</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">saveAuthToken</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAuthToken</span><span class="p">():</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearAuthToken</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">clearAuthToken</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">saveUserSession</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">saveUserSession</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getUserSession</span><span class="p">():</span><span class="w"> </span><span class="n">Pair</span><span class="o">&lt;</span><span class="kt">String?</span><span class="p">,</span><span class="w"> </span><span class="kt">String?</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">getUserSession</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearUserSession</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">clearUserSession</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_repository_ItemsRepositoryImpl.kt'>commonMain\kotlin\me\onvo\onvo\data\repository\ItemsRepositoryImpl.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository</span>


<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.ApiService</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.Source</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.ItemsRepository</span>


<span class="kd">class</span><span class="w"> </span><span class="nc">ItemsRepositoryImpl</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">api</span><span class="p">:</span><span class="w"> </span><span class="n">ApiService</span><span class="p">,</span>

<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ItemsRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getItems</span><span class="p">():</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Source</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">api</span><span class="p">.</span><span class="na">fetchItems</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_repository_PasswordResetRepositoryImpl.kt'>commonMain\kotlin\me\onvo\onvo\data\repository\PasswordResetRepositoryImpl.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository</span>


<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.PasswordResetApiService</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.PasswordResetRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetRepositoryImpl</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">passwordResetApiService</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetApiService</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">requestResetCode</span><span class="p">(</span>
<span class="w">        </span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordResetCodeResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">passwordResetApiService</span><span class="p">.</span><span class="na">requestResetCode</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">error</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown error&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to send reset code&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to request reset code&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">submitResetCode</span><span class="p">(</span>
<span class="w">        </span><span class="n">code</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordResetCodeVerifyResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">passwordResetApiService</span><span class="p">.</span><span class="na">submitResetCode</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">error</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Invalid code&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Code verification failed&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to verify code&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">changePassword</span><span class="p">(</span>
<span class="w">        </span><span class="n">newPassword</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordChangeResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">passwordResetApiService</span><span class="p">.</span><span class="na">changePassword</span><span class="p">(</span><span class="n">newPassword</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">exception</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">error</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to change password&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Password change failed&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to change password&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_repository_ProfileRepositoryImpl.kt'>commonMain\kotlin\me\onvo\onvo\data\repository\ProfileRepositoryImpl.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore.PreferencesManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.ProfileApiService</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.UnauthorizedException</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthUserData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.UserProfile</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.ProfileRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ProfileRepositoryImpl</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">profileApiService</span><span class="p">:</span><span class="w"> </span><span class="n">ProfileApiService</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">preferencesManager</span><span class="p">:</span><span class="w"> </span><span class="n">PreferencesManager</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ProfileRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getCurrentUserStatus</span><span class="p">():</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">AuthUserData</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">                </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;No auth token&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="s">&quot;Please login first&quot;</span>
<span class="w">                </span><span class="p">)</span>

<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profileApiService</span><span class="p">.</span><span class="na">getAuthStatus</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isLoged</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">data</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Not logged in&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="s">&quot;Session expired. Please login again&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">UnauthorizedException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Clear token on unauthorized</span>
<span class="w">            </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">clearAuthToken</span><span class="p">()</span>
<span class="w">            </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">clearUserSession</span><span class="p">()</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Session expired. Please login again&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to get user status&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">UserProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profileApiService</span><span class="p">.</span><span class="na">getUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">user</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to load profile&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearSession</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">clearAuthToken</span><span class="p">()</span>
<span class="w">        </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">clearUserSession</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_data_zxczxc.kt'>commonMain\kotlin\me\onvo\onvo\data\zxczxc.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.data</span>

<span class="kd">object</span><span class="w"> </span><span class="nc">zxczxc</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_AppComponent.kt'>commonMain\kotlin\me\onvo\onvo\di\AppComponent.kt</h2><div class="highlight"><pre><span></span><span class="c1">//package me.onvo.onvo.di</span>
<span class="c1">//</span>
<span class="c1">//</span>
<span class="c1">//</span>
<span class="c1">//import dev.zacsweers.metro.AppScope</span>
<span class="c1">//import dev.zacsweers.metro.DependencyGraph</span>
<span class="c1">//import dev.zacsweers.metro.Provides</span>
<span class="c1">//import dev.zacsweers.metro.SingleIn</span>
<span class="c1">//import dev.zacsweers.metro.createGraph</span>
<span class="c1">//import io.ktor.client.HttpClient</span>
<span class="c1">//import io.ktor.client.plugins.contentnegotiation.ContentNegotiation</span>
<span class="c1">//import io.ktor.serialization.kotlinx.json.json</span>
<span class="c1">//import kotlinx.serialization.json.Json</span>
<span class="c1">//import me.onvo.onvo.data.network.ApiService</span>
<span class="c1">//import me.onvo.onvo.data.network.ApiServiceImpl</span>
<span class="c1">//import me.onvo.onvo.data.network.HttpClientFactory</span>
<span class="c1">//import me.onvo.onvo.presentation.viewmodel.SourcesViewModel</span>
<span class="c1">//</span>
<span class="c1">//@DependencyGraph(AppScope::class)</span>
<span class="c1">//@SingleIn(AppScope::class)</span>
<span class="c1">//abstract class AppGraph {</span>
<span class="c1">//</span>
<span class="c1">//    // Expose ViewModel to UI</span>
<span class="c1">//    abstract val sourcesViewModel: SourcesViewModel</span>
<span class="c1">//</span>
<span class="c1">//    // Network providers</span>
<span class="c1">//    @Provides</span>
<span class="c1">//    @SingleIn(AppScope::class)</span>
<span class="c1">//    fun provideJson(): Json = Json {</span>
<span class="c1">//        ignoreUnknownKeys = true</span>
<span class="c1">//        isLenient = true</span>
<span class="c1">//        coerceInputValues = true</span>
<span class="c1">//        prettyPrint = false</span>
<span class="c1">//    }</span>
<span class="c1">//</span>
<span class="c1">//    @Provides</span>
<span class="c1">//    @SingleIn(AppScope::class)</span>
<span class="c1">//    fun provideHttpClient(json: Json): HttpClient {</span>
<span class="c1">//        return HttpClientFactory().createClient().config {</span>
<span class="c1">//            install(ContentNegotiation) {</span>
<span class="c1">//                json(json)</span>
<span class="c1">//            }</span>
<span class="c1">//        }</span>
<span class="c1">//    }</span>
<span class="c1">//</span>
<span class="c1">//    @Provides</span>
<span class="c1">//    @SingleIn(AppScope::class)</span>
<span class="c1">//    fun provideBaseUrl(): String = &quot;https://yamimanga.me/&quot;</span>
<span class="c1">//</span>
<span class="c1">//    @Provides</span>
<span class="c1">//    @SingleIn(AppScope::class)</span>
<span class="c1">//    fun provideApiService(</span>
<span class="c1">//        client: HttpClient,</span>
<span class="c1">//        baseUrl: String,</span>
<span class="c1">//        json: Json</span>
<span class="c1">//    ): ApiService = ApiServiceImpl(client, baseUrl, json)</span>
<span class="c1">//</span>
<span class="c1">//    companion object {</span>
<span class="c1">//        fun create(): AppGraph = createGraph&lt;AppGraph&gt;()</span>
<span class="c1">//    }</span>
<span class="c1">//}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_appModule.kt'>commonMain\kotlin\me\onvo\onvo\di\appModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.AuthViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.SourcesViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>


<span class="kd">val</span><span class="w"> </span><span class="nv">appModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ThemeManager</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">SourcesViewModel</span><span class="p">(</span><span class="k">get</span><span class="p">())</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_authModule.kt'>commonMain\kotlin\me\onvo\onvo\di\authModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.AuthApiService</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.AuthApiServiceImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.PasswordResetApiService</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.PasswordResetApiServiceImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository.AuthRepositoryImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository.PasswordResetRepositoryImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.PasswordResetRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.auth.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.passwordreset.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.AuthViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.PasswordResetViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.qualifier.named</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">authModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Auth API Service</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">AuthApiService</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">AuthApiServiceImpl</span><span class="p">(</span>
<span class="w">            </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(</span><span class="n">named</span><span class="p">(</span><span class="s">&quot;baseUrl&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Password Reset API Service</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">PasswordResetApiService</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">PasswordResetApiServiceImpl</span><span class="p">(</span>
<span class="w">            </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(</span><span class="n">named</span><span class="p">(</span><span class="s">&quot;baseUrl&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Auth Repository</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">AuthRepository</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">AuthRepositoryImpl</span><span class="p">(</span>
<span class="w">            </span><span class="n">authApiService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">preferencesManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Password Reset Repository</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">PasswordResetRepository</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">PasswordResetRepositoryImpl</span><span class="p">(</span>
<span class="w">            </span><span class="n">passwordResetApiService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Auth Use Cases</span>
<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GetTokenUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">deviceInfoProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">CheckInputUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">LoginUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">LogoutUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GetUserSessionUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Password Reset Use Cases</span>
<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">RequestResetCodeUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">passwordResetRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SubmitResetCodeUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">passwordResetRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ChangePasswordUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">passwordResetRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ViewModels</span>
<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">AuthViewModel</span><span class="p">(</span>
<span class="w">            </span><span class="n">getTokenUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">checkInputUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">loginUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">logoutUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">getUserSessionUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">getCurrentUserStatusUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span><span class="w">  </span><span class="c1">// Added this dependency</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">PasswordResetViewModel</span><span class="p">(</span>
<span class="w">            </span><span class="n">checkInputUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">requestResetCodeUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">submitResetCodeUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">changePasswordUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">authRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_dataStoreModule.kt'>commonMain\kotlin\me\onvo\onvo\di\dataStoreModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>


<span class="c1">// di module</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore.PreferencesManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.core.DataStore</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.Preferences</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore.createPreferencesDataStore</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">dataStoreModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// make DataStore&lt;Preferences&gt; available</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">DataStore</span><span class="o">&lt;</span><span class="n">Preferences</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">createPreferencesDataStore</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// PreferencesManager uses the DataStore</span>
<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">PreferencesManager</span><span class="p">(</span><span class="k">get</span><span class="p">())</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_initKoin.kt'>commonMain\kotlin\me\onvo\onvo\di\initKoin.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>


<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.context.startKoin</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">initKoin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">startKoin</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">modules</span><span class="p">(</span>
<span class="w">            </span><span class="n">networkModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">repositoryModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">useCaseModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">appModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">dataStoreModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">viewModelModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">authModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">platformModule</span><span class="p">,</span>
<span class="w">            </span><span class="n">profileModule</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_networkModule.kt'>commonMain\kotlin\me\onvo\onvo\di\networkModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.HttpClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.contentnegotiation.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.serialization.kotlinx.json.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.Json</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.config.AppConfig</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.network.HttpClientFactory</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.ApiService</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.ApiServiceImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.qualifier.named</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.logging.*</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">networkModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">Json</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Json</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ignoreUnknownKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="n">isLenient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="n">coerceInputValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="n">prettyPrint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// register baseUrl as a named String</span>
<span class="w">    </span><span class="n">single</span><span class="p">(</span><span class="n">named</span><span class="p">(</span><span class="s">&quot;baseUrl&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">AppConfig</span><span class="p">.</span><span class="na">BASE_URL</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">HttpClient</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">HttpClientFactory</span><span class="p">().</span><span class="na">create</span><span class="p">().</span><span class="na">config</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">install</span><span class="p">(</span><span class="n">ContentNegotiation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">json</span><span class="p">(</span><span class="k">get</span><span class="p">())</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">AppConfig</span><span class="p">.</span><span class="na">ENABLE_LOGGING</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">install</span><span class="p">(</span><span class="n">Logging</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Logger</span><span class="p">.</span><span class="na">SIMPLE</span>
<span class="w">                    </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogLevel</span><span class="p">.</span><span class="na">ALL</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">install</span><span class="p">(</span><span class="n">HttpTimeout</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">requestTimeoutMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AppConfig</span><span class="p">.</span><span class="na">TIMEOUT_MILLIS</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">install</span><span class="p">(</span><span class="n">HttpRedirect</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">checkHttpMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="c1">// allows POST redirects</span>
<span class="w">                </span><span class="n">allowHttpsDowngrade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">defaultRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">url</span><span class="p">(</span><span class="n">AppConfig</span><span class="p">.</span><span class="na">BASE_URL</span><span class="p">)</span>
<span class="w">                </span><span class="n">headers</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/json&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="c1">// Optional: Accept JSON as well</span>
<span class="w">                </span><span class="n">headers</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;Accept&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/json&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">ApiService</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// get() -&gt; HttpClient, get(named(&quot;baseUrl&quot;)) -&gt; String, get() -&gt; Json</span>
<span class="w">        </span><span class="n">ApiServiceImpl</span><span class="p">(</span><span class="k">get</span><span class="p">(),</span><span class="w"> </span><span class="k">get</span><span class="p">(</span><span class="n">named</span><span class="p">(</span><span class="s">&quot;baseUrl&quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_platformModule.kt'>commonMain\kotlin\me\onvo\onvo\di\platformModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>


<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device.DeviceInfoProvider</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>

<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.module.Module</span>

<span class="kd">expect</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">platformModule</span><span class="p">:</span><span class="w"> </span><span class="n">Module</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_profileModule.kt'>commonMain\kotlin\me\onvo\onvo\di\profileModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.ProfileApiService</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.network.ProfileApiServiceImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository.ProfileRepositoryImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.ProfileRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.profile.GetCurrentUserStatusUseCase</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.profile.GetUserProfileUseCase</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.ProfileViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.qualifier.named</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">profileModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// API Service</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">ProfileApiService</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ProfileApiServiceImpl</span><span class="p">(</span>
<span class="w">            </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(</span><span class="n">named</span><span class="p">(</span><span class="s">&quot;baseUrl&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Repository</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">ProfileRepository</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ProfileRepositoryImpl</span><span class="p">(</span>
<span class="w">            </span><span class="n">profileApiService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">preferencesManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Use Cases</span>
<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GetCurrentUserStatusUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">profileRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GetUserProfileUseCase</span><span class="p">(</span>
<span class="w">            </span><span class="n">profileRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ViewModel</span>
<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ProfileViewModel</span><span class="p">(</span>
<span class="w">            </span><span class="n">getCurrentUserStatusUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">(),</span>
<span class="w">            </span><span class="n">getUserProfileUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_RepositoryModule.kt'>commonMain\kotlin\me\onvo\onvo\di\RepositoryModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository.ItemsRepositoryImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.ItemsRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">repositoryModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">ItemsRepository</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ItemsRepositoryImpl</span><span class="p">(</span><span class="n">api</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_UseCaseModule.kt'>commonMain\kotlin\me\onvo\onvo\di\UseCaseModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.GetSourcesUseCase</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">useCaseModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">factory</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GetSourcesUseCase</span><span class="p">(</span><span class="n">repository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_di_ViewModelModule.kt'>commonMain\kotlin\me\onvo\onvo\di\ViewModelModule.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.data.repository.ItemsRepositoryImpl</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.ItemsRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.SourcesViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">viewModelModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="c1">//    single&lt; SourcesViewModel&gt;  {</span>
<span class="c1">//        SourcesViewModel(getSourcesUseCase = get())</span>
<span class="c1">//    }</span>
<span class="w">    </span><span class="n">single</span><span class="o">&lt;</span><span class="n">ThemeViewModel</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ThemeViewModel</span><span class="p">(</span><span class="k">get</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_assadsa.kt'>commonMain\kotlin\me\onvo\onvo\domain\assadsa.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain</span>

<span class="kd">object</span><span class="w"> </span><span class="nc">assadsa</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_model_auth.kt'>commonMain\kotlin\me\onvo\onvo\domain\model\auth.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/domain/model/auth.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model</span>

<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.Serializable</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">DeviceInfo</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">deviceId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">brand</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">model</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">systemName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">systemVersion</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">appVersion</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">buildNumber</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">uniqueId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">deviceName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isTablet</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">carrier</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">timezone</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">TokenRequest</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">info</span><span class="p">:</span><span class="w"> </span><span class="n">DeviceInfo</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">TokenResponse</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">vuse</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">CheckInputRequest</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>

<span class="c1">// Updated response model to handle both success and error</span>
<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">CheckInputResponse</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Int?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">fullname</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">image</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">username</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Error fields</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isSuccess</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isError</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">LoginRequest</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">password</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="c1">// MD5 hashed</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PlusInfo</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">status</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">billing_period</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">start_date</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">end_date</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">external_id</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">payment_method</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserCounts</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">messages</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">archives</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sent</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">notifications</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserSettings</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">theme</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">them</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">lang</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">ctm</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">aoe</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">reminder</span><span class="p">:</span><span class="w"> </span><span class="kt">Int?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">SessionUser</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">session_id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">username</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">image</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">fullname</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">firstname</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">bio</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">counts</span><span class="p">:</span><span class="w"> </span><span class="n">UserCounts? </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">settings</span><span class="p">:</span><span class="w"> </span><span class="n">UserSettings? </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span>

<span class="c1">// Updated response model to handle both success and error</span>
<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">LoginResponse</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">status</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isLoged</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">plus</span><span class="p">:</span><span class="w"> </span><span class="n">PlusInfo? </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">data</span><span class="p">:</span><span class="w"> </span><span class="n">SessionUser? </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Error fields</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isSuccess</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isLoged</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isError</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>

<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">AuthState</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isAuthenticated</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">authToken</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_model_PasswordReset.kt'>commonMain\kotlin\me\onvo\onvo\domain\model\PasswordReset.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/domain/model/PasswordReset.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model</span>

<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.Serializable</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetRequest</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetCodeResponse</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">alert</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">code</span><span class="p">:</span><span class="w"> </span><span class="kt">Int?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">status</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Error fields</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isSuccess</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;success&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isError</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetCodeSubmit</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">code</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetCodeVerifyResponse</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">status</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isSuccess</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;success&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isError</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordChangeRequest</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">password</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordChangeResponse</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">status</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isLoged</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">plus</span><span class="p">:</span><span class="w"> </span><span class="n">PlusInfo? </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">data</span><span class="p">:</span><span class="w"> </span><span class="n">SessionUser? </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isSuccess</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isLoged</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isError</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>

<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetUiState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Initial</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Loading</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">CodeSent</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">CodeVerified</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordChanged</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="n">ErrorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ErrorType</span><span class="p">.</span><span class="na">GENERAL</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">()</span>

<span class="w">    </span><span class="kd">enum</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">ErrorType</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GENERAL</span><span class="p">,</span>
<span class="w">        </span><span class="n">NO_EMAIL</span><span class="p">,</span>
<span class="w">        </span><span class="n">INVALID_CODE</span><span class="p">,</span>
<span class="w">        </span><span class="n">USER_NOT_FOUND</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_model_Profile.kt'>commonMain\kotlin\me\onvo\onvo\domain\model\Profile.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/domain/model/Profile.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model</span>

<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.SerialName</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.Serializable</span>

<span class="c1">// ========== Auth Status Response (Simple Profile) ==========</span>
<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">AuthStatusResponse</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">status</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isLoged</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">plus</span><span class="p">:</span><span class="w"> </span><span class="n">PlusInfo</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">data</span><span class="p">:</span><span class="w"> </span><span class="n">AuthUserData</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">AuthUserData</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@SerialName</span><span class="p">(</span><span class="s">&quot;session_id&quot;</span><span class="p">)</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">sessionId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">username</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">image</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">fullname</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">firstname</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">bio</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">counts</span><span class="p">:</span><span class="w"> </span><span class="n">UserCounts</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">settings</span><span class="p">:</span><span class="w"> </span><span class="n">UserSettings</span>
<span class="p">)</span>

<span class="c1">// ========== Full User Profile Response ==========</span>
<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserProfileResponse</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">user</span><span class="p">:</span><span class="w"> </span><span class="n">UserProfile</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">links</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserLink</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">emptyList</span><span class="p">()</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserProfile</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">statue</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">usnm</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">username</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">fnme</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">fullname</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">firstname</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">img</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">image</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">bio</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">lnks</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserLink</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">emptyList</span><span class="p">(),</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">cnt</span><span class="p">:</span><span class="w"> </span><span class="n">UserProfileCounts</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">vrfy</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@SerialName</span><span class="p">(</span><span class="s">&quot;is_verified&quot;</span><span class="p">)</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">isVerified</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">charms</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">flw</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">followed</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@SerialName</span><span class="p">(</span><span class="s">&quot;followed_back&quot;</span><span class="p">)</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">followedBack</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">mute</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">muted</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">tmp</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">holder</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">story</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserProfileCounts</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">colls</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">msg</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">likes</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">views</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">followers</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">following</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>

<span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserLink</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">t</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">d</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w">  </span><span class="c1">// display text</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">url</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Helper to get icon based on type</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">linkType</span><span class="p">:</span><span class="w"> </span><span class="n">LinkType</span>
<span class="w">        </span><span class="k">get</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="na">lowercase</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="s">&quot;ln&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">LINKEDIN</span>
<span class="w">            </span><span class="s">&quot;wa&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">WHATSAPP</span>
<span class="w">            </span><span class="s">&quot;sp&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">SPOTIFY</span>
<span class="w">            </span><span class="s">&quot;sc&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">SNAPCHAT</span>
<span class="w">            </span><span class="s">&quot;ig&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">INSTAGRAM</span>
<span class="w">            </span><span class="s">&quot;rd&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">REDDIT</span>
<span class="w">            </span><span class="s">&quot;sn&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">SOUND_CLOUD</span>
<span class="w">            </span><span class="s">&quot;pt&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">PINTEREST</span>
<span class="w">            </span><span class="s">&quot;gh&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">GITHUB</span>
<span class="w">            </span><span class="s">&quot;tw&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">TWITTER</span>
<span class="w">            </span><span class="s">&quot;gm&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">GMAIL</span>
<span class="w">            </span><span class="s">&quot;bh&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">BEHANCE</span>
<span class="w">            </span><span class="s">&quot;yt&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">YOUTUBE</span>
<span class="w">            </span><span class="s">&quot;tk&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">TIKTOK</span>
<span class="w">            </span><span class="s">&quot;an&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">ANIME</span>
<span class="w">            </span><span class="s">&quot;fb&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">FACEBOOK</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LinkType</span><span class="p">.</span><span class="na">OTHER</span>
<span class="w">        </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">enum</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">LinkType</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">displayName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">LINKEDIN</span><span class="p">(</span><span class="s">&quot;LinkedIn&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">WHATSAPP</span><span class="p">(</span><span class="s">&quot;WhatsApp&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">SPOTIFY</span><span class="p">(</span><span class="s">&quot;Spotify&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">SNAPCHAT</span><span class="p">(</span><span class="s">&quot;Snapchat&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">INSTAGRAM</span><span class="p">(</span><span class="s">&quot;Instagram&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">REDDIT</span><span class="p">(</span><span class="s">&quot;Reddit&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">SOUND_CLOUD</span><span class="p">(</span><span class="s">&quot;SoundCloud&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">PINTEREST</span><span class="p">(</span><span class="s">&quot;Pinterest&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">GITHUB</span><span class="p">(</span><span class="s">&quot;GitHub&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">TWITTER</span><span class="p">(</span><span class="s">&quot;Twitter&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">GMAIL</span><span class="p">(</span><span class="s">&quot;Gmail&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">BEHANCE</span><span class="p">(</span><span class="s">&quot;Behance&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">YOUTUBE</span><span class="p">(</span><span class="s">&quot;YouTube&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">TIKTOK</span><span class="p">(</span><span class="s">&quot;TikTok&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">ANIME</span><span class="p">(</span><span class="s">&quot;Anime&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">FACEBOOK</span><span class="p">(</span><span class="s">&quot;Facebook&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">OTHER</span><span class="p">(</span><span class="s">&quot;Link&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// ========== UI State Models ==========</span>
<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">ProfileUiState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Loading</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Success</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">profile</span><span class="p">:</span><span class="w"> </span><span class="n">UserProfile</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">AuthStatusUiState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Loading</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Success</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">user</span><span class="p">:</span><span class="w"> </span><span class="n">AuthUserData</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_model_Source.kt'>commonMain\kotlin\me\onvo\onvo\domain\model\Source.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model</span>


<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.KSerializer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.Serializable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.SerializationException</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.descriptors.SerialDescriptor</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.descriptors.buildClassSerialDescriptor</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.encoding.Decoder</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.encoding.Encoder</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.JsonDecoder</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.JsonEncoder</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.JsonObject</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.JsonPrimitive</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.booleanOrNull</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.contentOrNull</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.jsonObject</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.jsonPrimitive</span>

<span class="nd">@Serializable</span><span class="p">(</span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Source</span><span class="p">.</span><span class="na">Serializer</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Source</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">api</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">baseUrl</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">baseVersion</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="p">:</span><span class="w"> </span><span class="n">SourceState</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">imageBaseUrl</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">imageUrlVersion</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">shouldDelete</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">object</span><span class="w"> </span><span class="nc">Serializer</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">KSerializer</span><span class="o">&lt;</span><span class="n">Source</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">descriptor</span><span class="p">:</span><span class="w"> </span><span class="n">SerialDescriptor</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="n">buildClassSerialDescriptor</span><span class="p">(</span><span class="s">&quot;Source&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">deserialize</span><span class="p">(</span><span class="n">decoder</span><span class="p">:</span><span class="w"> </span><span class="n">Decoder</span><span class="p">):</span><span class="w"> </span><span class="n">Source</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">jsonDecoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decoder</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="n">JsonDecoder</span>
<span class="w">                </span><span class="o">?:</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">SerializationException</span><span class="p">(</span><span class="s">&quot;This serializer can be used only with Json&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecoder</span><span class="p">.</span><span class="na">decodeJsonElement</span><span class="p">()</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element</span><span class="p">.</span><span class="na">jsonObject</span>

<span class="w">            </span><span class="kd">fun</span><span class="w"> </span><span class="n">JsonObject</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">):</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span>
<span class="w">                </span><span class="k">this</span><span class="o">[</span><span class="n">key</span><span class="o">]?.</span><span class="na">jsonPrimitive</span><span class="o">?.</span><span class="na">content</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="n">default</span>

<span class="w">            </span><span class="kd">fun</span><span class="w"> </span><span class="n">JsonObject</span><span class="p">.</span><span class="nf">getInt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">):</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span>
<span class="w">                </span><span class="k">this</span><span class="o">[</span><span class="n">key</span><span class="o">]?.</span><span class="na">jsonPrimitive</span><span class="o">?.</span><span class="na">content</span><span class="o">?.</span><span class="na">toIntOrNull</span><span class="p">()</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="n">default</span>

<span class="w">            </span><span class="kd">fun</span><span class="w"> </span><span class="n">JsonObject</span><span class="p">.</span><span class="nf">getBoolean</span><span class="p">(</span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">):</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">el</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">default</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">prim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">el</span><span class="p">.</span><span class="na">jsonPrimitive</span>
<span class="w">                </span><span class="c1">// Prefer real boolean if present</span>
<span class="w">                </span><span class="n">prim</span><span class="p">.</span><span class="na">booleanOrNull</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="c1">// Otherwise try parsing textual content</span>
<span class="w">                </span><span class="n">prim</span><span class="p">.</span><span class="na">contentOrNull</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">text</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ignoreCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                        </span><span class="n">text</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;false&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ignoreCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">false</span>
<span class="w">                        </span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                        </span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">false</span>
<span class="w">                        </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">default</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">default</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">// Resolve state: prefer &quot;state&quot; string, fallback to &quot;isWorking&quot; boolean for backward compatibility</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="p">:</span><span class="w"> </span><span class="n">SourceState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">obj</span><span class="p">.</span><span class="na">containsKey</span><span class="p">(</span><span class="s">&quot;state&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="o">[</span><span class="s">&quot;state&quot;</span><span class="o">]?.</span><span class="na">jsonPrimitive</span><span class="o">?.</span><span class="na">contentOrNull</span><span class="o">?.</span><span class="na">trim</span><span class="p">()</span><span class="o">?.</span><span class="na">uppercase</span><span class="p">()</span>
<span class="w">                    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">raw</span><span class="p">.</span><span class="na">isNullOrEmpty</span><span class="p">())</span><span class="w"> </span><span class="n">SourceState</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">SourceState</span><span class="p">.</span><span class="na">STOPPED</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// unknown value -&gt; STOPPED as safe default</span>
<span class="w">                        </span><span class="n">SourceState</span><span class="p">.</span><span class="na">STOPPED</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">obj</span><span class="p">.</span><span class="na">containsKey</span><span class="p">(</span><span class="s">&quot;isWorking&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isWorkingRaw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="o">[</span><span class="s">&quot;isWorking&quot;</span><span class="o">]?.</span><span class="na">jsonPrimitive</span><span class="o">?.</span><span class="na">contentOrNull</span><span class="o">?.</span><span class="na">trim</span><span class="p">()</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isWorking</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isWorkingRaw</span><span class="o">?.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ignoreCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isWorking</span><span class="p">)</span><span class="w"> </span><span class="n">SourceState</span><span class="p">.</span><span class="na">WORKING</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">SourceState</span><span class="p">.</span><span class="na">STOPPED</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// no info -&gt; choose a safe default (STOPPED)</span>
<span class="w">                    </span><span class="n">SourceState</span><span class="p">.</span><span class="na">STOPPED</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Source</span><span class="p">(</span>
<span class="w">                </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">api</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;baseUrl&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">baseVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;baseVersion&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">,</span>
<span class="w">                </span><span class="n">imageBaseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;imageBaseUrl&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">imageUrlVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;imageUrlVersion&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">shouldDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getBoolean</span><span class="p">(</span><span class="s">&quot;delate&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="n">encoder</span><span class="p">:</span><span class="w"> </span><span class="n">Encoder</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="n">Source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">jsonEncoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encoder</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="n">JsonEncoder</span>
<span class="w">                </span><span class="o">?:</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">SerializationException</span><span class="p">(</span><span class="s">&quot;This serializer can be used only with Json&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="c1">// We write the new &quot;state&quot; string (not the old boolean)</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">jo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buildMap</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">put</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">JsonPrimitive</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="na">name</span><span class="p">))</span>
<span class="w">                </span><span class="n">put</span><span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">JsonPrimitive</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="na">api</span><span class="p">))</span>
<span class="w">                </span><span class="n">put</span><span class="p">(</span><span class="s">&quot;baseUrl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">JsonPrimitive</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="na">baseUrl</span><span class="p">))</span>
<span class="w">                </span><span class="n">put</span><span class="p">(</span><span class="s">&quot;baseVersion&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">JsonPrimitive</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="na">baseVersion</span><span class="p">))</span>
<span class="w">                </span><span class="n">put</span><span class="p">(</span><span class="s">&quot;state&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">JsonPrimitive</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="na">state</span><span class="p">.</span><span class="na">name</span><span class="p">))</span>
<span class="w">                </span><span class="n">put</span><span class="p">(</span><span class="s">&quot;imageBaseUrl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">JsonPrimitive</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="na">imageBaseUrl</span><span class="p">))</span>
<span class="w">                </span><span class="n">put</span><span class="p">(</span><span class="s">&quot;imageUrlVersion&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">JsonPrimitive</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="na">imageUrlVersion</span><span class="p">))</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">jsonEncoder</span><span class="p">.</span><span class="na">encodeJsonElement</span><span class="p">(</span><span class="n">JsonObject</span><span class="p">(</span><span class="n">jo</span><span class="p">))</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_model_SourceState.kt'>commonMain\kotlin\me\onvo\onvo\domain\model\SourceState.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model</span>

<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.Serializable</span>


<span class="nd">@Serializable</span>
<span class="kd">enum</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">SourceState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">WORKING</span><span class="p">,</span>
<span class="w">    </span><span class="n">UNDER_MAINTENANCE</span><span class="p">,</span>
<span class="w">    </span><span class="n">STOPPED</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_repository_AuthRepository.kt'>commonMain\kotlin\me\onvo\onvo\domain\repository\AuthRepository.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.CheckInputResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.DeviceInfo</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.LoginResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.TokenResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">AuthRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getToken</span><span class="p">(</span><span class="n">deviceInfo</span><span class="p">:</span><span class="w"> </span><span class="n">DeviceInfo</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">TokenResponse</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">checkInput</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">CheckInputResponse</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">LoginResponse</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">logout</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="kt">Unit</span><span class="o">&gt;</span>

<span class="w">    </span><span class="c1">// Local storage methods</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">saveAuthToken</span><span class="p">(</span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAuthToken</span><span class="p">():</span><span class="w"> </span><span class="kt">String?</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearAuthToken</span><span class="p">()</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">saveUserSession</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getUserSession</span><span class="p">():</span><span class="w"> </span><span class="n">Pair</span><span class="o">&lt;</span><span class="kt">String?</span><span class="p">,</span><span class="w"> </span><span class="kt">String?</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearUserSession</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_repository_ItemsRepository.kt'>commonMain\kotlin\me\onvo\onvo\domain\repository\ItemsRepository.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.Source</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">ItemsRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getItems</span><span class="p">():</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Source</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_repository_PasswordResetRepository.kt'>commonMain\kotlin\me\onvo\onvo\domain\repository\PasswordResetRepository.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/domain/repository/PasswordResetRepository.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.*</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">PasswordResetRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">requestResetCode</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordResetCodeResponse</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">submitResetCode</span><span class="p">(</span><span class="n">code</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordResetCodeVerifyResponse</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">changePassword</span><span class="p">(</span><span class="n">newPassword</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordChangeResponse</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_repository_ProfileRepository.kt'>commonMain\kotlin\me\onvo\onvo\domain\repository\ProfileRepository.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthUserData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.UserProfile</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">ProfileRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getCurrentUserStatus</span><span class="p">():</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">AuthUserData</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">UserProfile</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearSession</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_auth_CheckInputUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\auth\CheckInputUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.auth</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.CheckInputResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CheckInputUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">CheckInputResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">isBlank</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Input cannot be empty&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please enter your email, username, or phone number&quot;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">            </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;No auth token&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please restart the app&quot;</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">checkInput</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">trim</span><span class="p">(),</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_auth_GetTokenUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\auth\GetTokenUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.auth</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device.DeviceInfoProvider</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.TokenResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">GetTokenUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">deviceInfoProvider</span><span class="p">:</span><span class="w"> </span><span class="n">DeviceInfoProvider</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">():</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">TokenResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">deviceInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deviceInfoProvider</span><span class="p">.</span><span class="na">getDeviceInfo</span><span class="p">()</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getToken</span><span class="p">(</span><span class="n">deviceInfo</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Save token for future use</span>
<span class="w">                </span><span class="n">authRepository</span><span class="p">.</span><span class="na">saveAuthToken</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">token</span><span class="p">)</span>
<span class="w">                </span><span class="n">result</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">result</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">result</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_auth_GetUserSessionUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\auth\GetUserSessionUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.auth</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">GetUserSessionUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">():</span><span class="w"> </span><span class="n">AuthState</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="p">(</span><span class="nv">userId</span><span class="p">,</span><span class="w"> </span><span class="nv">userName</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getUserSession</span><span class="p">()</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">authToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">AuthState</span><span class="p">(</span>
<span class="w">            </span><span class="n">isAuthenticated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">authToken</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">            </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span>
<span class="w">            </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userName</span><span class="p">,</span>
<span class="w">            </span><span class="n">authToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authToken</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_auth_LoginUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\auth\LoginUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.auth</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.CryptoUtil</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.LoginResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">LoginUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">LoginResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">.</span><span class="na">isBlank</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">password</span><span class="p">.</span><span class="na">isBlank</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Invalid credentials&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;ID and password cannot be empty&quot;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">            </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;No auth token&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please restart the app&quot;</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Encrypt password with MD5</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">encryptedPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CryptoUtil</span><span class="p">.</span><span class="na">md5</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">encryptedPassword</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">isLoged</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// Save user session</span>
<span class="w">                    </span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">data</span><span class="o">?.</span><span class="na">id</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">userId</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                        </span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">username</span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                            </span><span class="n">authRepository</span><span class="p">.</span><span class="na">saveUserSession</span><span class="p">(</span><span class="n">userId</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span><span class="w"> </span><span class="n">userName</span><span class="p">.</span><span class="na">toString</span><span class="p">())</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">result</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">result</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">result</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_auth_LogoutUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\auth\LogoutUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.auth</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>


<span class="kd">class</span><span class="w"> </span><span class="nc">LogoutUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">():</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="kt">Unit</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">            </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;No auth token&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Already logged out&quot;</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">logout</span><span class="p">(</span><span class="n">token</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Clear local session</span>
<span class="w">                </span><span class="n">authRepository</span><span class="p">.</span><span class="na">clearUserSession</span><span class="p">()</span>
<span class="w">                </span><span class="n">result</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Clear local session even if API call fails</span>
<span class="w">                </span><span class="n">authRepository</span><span class="p">.</span><span class="na">clearUserSession</span><span class="p">()</span>
<span class="w">                </span><span class="n">result</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">result</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_GetSourcesUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\GetSourcesUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase</span>

<span class="c1">//import dev.zacsweers.metro.Inject</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.Source</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.ItemsRepository</span>

<span class="c1">//@Inject</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">GetSourcesUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">repository</span><span class="p">:</span><span class="w"> </span><span class="n">ItemsRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">():</span><span class="w"> </span><span class="n">Result</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Source</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">sources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="na">getItems</span><span class="p">()</span>
<span class="w">            </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Result</span><span class="p">.</span><span class="na">failure</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_passwordreset_ChangePasswordUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\passwordreset\ChangePasswordUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.passwordreset</span>


<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.CryptoUtil</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordChangeResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.PasswordResetRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ChangePasswordUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">passwordResetRepository</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetRepository</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">newPassword</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordChangeResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">newPassword</span><span class="p">.</span><span class="na">isBlank</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">newPassword</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Invalid password&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Password must be at least 6 characters&quot;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">            </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;No auth token&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please restart the app&quot;</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Encrypt password with MD5</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">encryptedPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CryptoUtil</span><span class="p">.</span><span class="na">md5</span><span class="p">(</span><span class="n">newPassword</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">passwordResetRepository</span><span class="p">.</span><span class="na">changePassword</span><span class="p">(</span><span class="n">encryptedPassword</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Update user session with new credentials</span>
<span class="w">                </span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">data</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">authRepository</span><span class="p">.</span><span class="na">saveUserSession</span><span class="p">(</span>
<span class="w">                        </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span>
<span class="w">                        </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="na">username</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">result</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">result</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">result</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_passwordreset_RequestResetCodeUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\passwordreset\RequestResetCodeUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.passwordreset</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordResetCodeResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.PasswordResetRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">RequestResetCodeUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">passwordResetRepository</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetRepository</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordResetCodeResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">userId</span><span class="p">.</span><span class="na">isBlank</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;User ID cannot be empty&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please enter a valid user ID&quot;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">            </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;No auth token&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please restart the app&quot;</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">passwordResetRepository</span><span class="p">.</span><span class="na">requestResetCode</span><span class="p">(</span><span class="n">userId</span><span class="p">.</span><span class="na">trim</span><span class="p">(),</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_passwordreset_SubmitResetCodeUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\passwordreset\SubmitResetCodeUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.passwordreset</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordResetCodeVerifyResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.PasswordResetRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">SubmitResetCodeUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">passwordResetRepository</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetRepository</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">code</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PasswordResetCodeVerifyResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="p">.</span><span class="na">isBlank</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">code</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Invalid code&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please enter a valid 6-digit code&quot;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authRepository</span><span class="p">.</span><span class="na">getAuthToken</span><span class="p">()</span>
<span class="w">            </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;No auth token&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please restart the app&quot;</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">passwordResetRepository</span><span class="p">.</span><span class="na">submitResetCode</span><span class="p">(</span><span class="n">code</span><span class="p">.</span><span class="na">trim</span><span class="p">(),</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_profile_GetCurrentUserStatusUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\profile\GetCurrentUserStatusUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.profile</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthUserData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.ProfileRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">GetCurrentUserStatusUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">profileRepository</span><span class="p">:</span><span class="w"> </span><span class="n">ProfileRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">():</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">AuthUserData</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">profileRepository</span><span class="p">.</span><span class="na">getCurrentUserStatus</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_domain_usecase_profile_GetUserProfileUseCase.kt'>commonMain\kotlin\me\onvo\onvo\domain\usecase\profile\GetUserProfileUseCase.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.profile</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.UserProfile</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.ProfileRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">GetUserProfileUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">profileRepository</span><span class="p">:</span><span class="w"> </span><span class="n">ProfileRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">):</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">UserProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">userId</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Invalid user ID&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="s">&quot;Please provide a valid user ID&quot;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">profileRepository</span><span class="p">.</span><span class="na">getUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_Greeting.kt'>commonMain\kotlin\me\onvo\onvo\Greeting.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">Greeting</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getPlatform</span><span class="p">()</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">greet</span><span class="p">():</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Hello, </span><span class="si">${</span><span class="n">platform</span><span class="p">.</span><span class="na">name</span><span class="si">}</span><span class="s">!&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_navigation_AppNavigation.kt'>commonMain\kotlin\me\onvo\onvo\navigation\AppNavigation.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.navigation</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.CircleShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.filled.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.draw.clip</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.layout.ContentScale</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.NavHostController</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.NavHost</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.currentBackStackEntryAsState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.rememberNavController</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.toRoute</span>
<span class="k">import</span><span class="w"> </span><span class="nn">coil3.compose.AsyncImage</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui.LoginScreen</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui.PasswordResetScreen</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui.ProfileScreen</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui.SourcesScreen</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.AuthViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.PasswordResetViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.SourcesViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.test.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.compose.koinInject</span>

<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">AppNavigation</span><span class="p">(</span>
<span class="w">    </span><span class="n">authViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">AuthViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">koinInject</span><span class="p">(),</span>
<span class="w">    </span><span class="n">passwordResetViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">koinInject</span><span class="p">(),</span>
<span class="w">    </span><span class="n">themeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">ThemeViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberNavController</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sourcesViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SourcesViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">koinInject</span><span class="p">()</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isUserLoggedIn</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">authViewModel</span><span class="p">.</span><span class="na">isLoggedIn</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">authState</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">authViewModel</span><span class="p">.</span><span class="na">authState</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentUser</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">authViewModel</span><span class="p">.</span><span class="na">currentUser</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isInitialized</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">authViewModel</span><span class="p">.</span><span class="na">isInitialized</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Monitor password reset login state</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isPasswordResetLoggedIn</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">passwordResetViewModel</span><span class="p">.</span><span class="na">isLoggedIn</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Show loading screen while initializing</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isInitialized</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Box</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">            </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">                </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">CircularProgressIndicator</span><span class="p">()</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Initializing...&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Determine start destination</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">startDestination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isUserLoggedIn</span><span class="p">)</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">Home</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">Login</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">bottomBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isUserLoggedIn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">BottomNavigationBar</span><span class="p">(</span>
<span class="w">                    </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">                    </span><span class="n">currentUserImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentUser</span><span class="o">?.</span><span class="na">image</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">floatingActionButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isUserLoggedIn</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">shouldShowFab</span><span class="p">(</span><span class="n">navController</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">FloatingActionButton</span><span class="p">(</span>
<span class="w">                    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">CreatePost</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Add</span><span class="p">,</span><span class="w"> </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Create Post&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">paddingValues</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">NavHost</span><span class="p">(</span>
<span class="w">            </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">            </span><span class="n">startDestination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startDestination</span><span class="p">,</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">paddingValues</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Login Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">Login</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">LoginScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">viewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authViewModel</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onLoginSuccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">Home</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">popUpTo</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">Login</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">inclusive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">onForgotPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">passwordResetViewModel</span><span class="p">.</span><span class="na">reset</span><span class="p">()</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">ForgotPassword</span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Forgot Password Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">ForgotPassword</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">PasswordResetScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">viewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">passwordResetViewModel</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onBackClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">passwordResetViewModel</span><span class="p">.</span><span class="na">reset</span><span class="p">()</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigateUp</span><span class="p">()</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">onPasswordChanged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isPasswordResetLoggedIn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">authViewModel</span><span class="p">.</span><span class="na">refreshSession</span><span class="p">()</span>
<span class="w">                            </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">Home</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">popUpTo</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">inclusive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">passwordResetViewModel</span><span class="p">.</span><span class="na">reset</span><span class="p">()</span>
<span class="w">                            </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">Login</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">popUpTo</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">inclusive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                    </span><span class="n">prefilledUserId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Change Password Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">ChangePassword</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">LaunchedEffect</span><span class="p">(</span><span class="kt">Unit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">passwordResetViewModel</span><span class="p">.</span><span class="na">reset</span><span class="p">()</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="n">PasswordResetScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">viewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">passwordResetViewModel</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onBackClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">passwordResetViewModel</span><span class="p">.</span><span class="na">reset</span><span class="p">()</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigateUp</span><span class="p">()</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">onPasswordChanged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isFromSettings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">passwordResetViewModel</span><span class="p">.</span><span class="na">reset</span><span class="p">()</span>
<span class="w">                            </span><span class="n">navController</span><span class="p">.</span><span class="na">navigateUp</span><span class="p">()</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                    </span><span class="n">prefilledUserId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authState</span><span class="p">.</span><span class="na">userId</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Home Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">Home</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">SourcesScreen</span><span class="p">(</span><span class="n">sourcesViewModel</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Search Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">Search</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">SearchScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">onUserClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">userId</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">UserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">))</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Discovery Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">Discovery</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">DiscoveryScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">onUserClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">userId</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">UserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">))</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Profile Screen (Current User)</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">Profile</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">ProfileScreen</span><span class="p">()</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Settings Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">Settings</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">SettingsScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">themeViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onSettingClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">settingType</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">SettingsDetail</span><span class="p">(</span><span class="n">settingType</span><span class="p">))</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">onChangePassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">ChangePassword</span><span class="p">)</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">onLogout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">authViewModel</span><span class="p">.</span><span class="na">logout</span><span class="p">()</span>
<span class="w">                        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">Login</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">popUpTo</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">inclusive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// User Profile Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">UserProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">backStackEntry</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">userProfile</span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">UserProfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">backStackEntry</span><span class="p">.</span><span class="na">toRoute</span><span class="p">()</span>
<span class="w">                </span><span class="n">UserProfileScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userProfile</span><span class="p">.</span><span class="na">userId</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onBackClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigateUp</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Settings Detail Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">SettingsDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">backStackEntry</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">settingsDetail</span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">SettingsDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">backStackEntry</span><span class="p">.</span><span class="na">toRoute</span><span class="p">()</span>
<span class="w">                </span><span class="n">SettingsDetailScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">settingType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settingsDetail</span><span class="p">.</span><span class="na">settingType</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onBackClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigateUp</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Create Post Screen</span>
<span class="w">            </span><span class="n">composable</span><span class="o">&lt;</span><span class="n">Screen</span><span class="p">.</span><span class="na">CreatePost</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">CreatePostScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">onPostCreated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigateUp</span><span class="p">()</span><span class="w"> </span><span class="p">},</span>
<span class="w">                    </span><span class="n">onBackClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigateUp</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">shouldShowFab</span><span class="p">(</span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span><span class="p">):</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentRoute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">currentBackStackEntryAsState</span><span class="p">().</span><span class="na">value</span><span class="o">?.</span><span class="na">destination</span><span class="o">?.</span><span class="na">route</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">currentRoute</span><span class="o">?.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;Home&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">BottomNavigationBar</span><span class="p">(</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span><span class="p">,</span>
<span class="w">    </span><span class="n">currentUserImage</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">        </span><span class="n">BottomNavItem</span><span class="p">(</span><span class="s">&quot;Home&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Home</span><span class="p">,</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">Home</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span>
<span class="w">        </span><span class="n">BottomNavItem</span><span class="p">(</span><span class="s">&quot;Search&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Search</span><span class="p">,</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">Search</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span>
<span class="w">        </span><span class="n">BottomNavItem</span><span class="p">(</span><span class="s">&quot;Discovery&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">LocationOn</span><span class="p">,</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">Discovery</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span>
<span class="w">        </span><span class="n">BottomNavItem</span><span class="p">(</span><span class="s">&quot;Profile&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Person</span><span class="p">,</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">Profile</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span><span class="w"> </span><span class="c1">// Use image</span>
<span class="w">        </span><span class="n">BottomNavItem</span><span class="p">(</span><span class="s">&quot;Settings&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Settings</span><span class="p">,</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">Settings</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="n">NavigationBar</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">navBackStackEntry</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">currentBackStackEntryAsState</span><span class="p">()</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentRoute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navBackStackEntry</span><span class="o">?.</span><span class="na">destination</span><span class="o">?.</span><span class="na">route</span>

<span class="w">        </span><span class="n">items</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">NavigationBarItem</span><span class="p">(</span>
<span class="w">                </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">useProfileImage</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">currentUserImage</span><span class="p">.</span><span class="na">isNullOrEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// Show user profile image</span>
<span class="w">                        </span><span class="n">AsyncImage</span><span class="p">(</span>
<span class="w">                            </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentUserImage</span><span class="p">,</span>
<span class="w">                            </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="na">label</span><span class="p">,</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                                </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                                </span><span class="p">.</span><span class="na">clip</span><span class="p">(</span><span class="n">CircleShape</span><span class="p">),</span>
<span class="w">                            </span><span class="n">contentScale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ContentScale</span><span class="p">.</span><span class="na">Crop</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// Show regular icon</span>
<span class="w">                        </span><span class="n">Icon</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">icon</span><span class="p">,</span><span class="w"> </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="na">label</span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">label</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentRoute</span><span class="o">?.</span><span class="na">contains</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">screen</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">simpleName</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">screen</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">popUpTo</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">Home</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">saveState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="w">                        </span><span class="n">launchSingleTop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                        </span><span class="n">restoreState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">private</span><span class="w"> </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">BottomNavItem</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">label</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">icon</span><span class="p">:</span><span class="w"> </span><span class="n">androidx</span><span class="p">.</span><span class="na">compose</span><span class="p">.</span><span class="na">ui</span><span class="p">.</span><span class="na">graphics</span><span class="p">.</span><span class="na">vector</span><span class="p">.</span><span class="na">ImageVector</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">screen</span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">useProfileImage</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="p">)</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_navigation_Screen.kt'>commonMain\kotlin\me\onvo\onvo\navigation\Screen.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/navigation/Screen.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.navigation</span>

<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.Serializable</span>

<span class="c1">// Sealed interface for type-safe navigation</span>
<span class="kd">sealed</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nc">Screen</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Login</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">ForgotPassword</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">ChangePassword</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Home</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Search</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Discovery</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Profile</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Settings</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserProfile</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">SettingsDetail</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">settingType</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>

<span class="w">    </span><span class="nd">@Serializable</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">CreatePost</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_Platform.kt'>commonMain\kotlin\me\onvo\onvo\Platform.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">Platform</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">}</span>

<span class="kd">expect</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getPlatform</span><span class="p">():</span><span class="w"> </span><span class="n">Platform</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_asdas.kt'>commonMain\kotlin\me\onvo\onvo\presentation\asdas.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation</span>

<span class="kd">object</span><span class="w"> </span><span class="nc">asdas</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_AuthUiState.kt'>commonMain\kotlin\me\onvo\onvo\presentation\AuthUiState.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation</span>

<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">AuthUiState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Initial</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Loading</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">CheckInputSuccess</span><span class="p">(</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">imageUrl</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">fullName</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">LoginSuccess</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_ui_LoginScreen.kt'>commonMain\kotlin\me\onvo\onvo\presentation\ui\LoginScreen.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/presentation/ui/LoginScreen.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.animation.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.animation.core.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.background</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.rememberScrollState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.CircleShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.RoundedCornerShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.text.KeyboardActions</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.text.KeyboardOptions</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.verticalScroll</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.filled.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.draw.clip</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.draw.shadow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.Brush</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.graphicsLayer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.layout.ContentScale</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.font.FontWeight</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.ImeAction</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.KeyboardType</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.PasswordVisualTransformation</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.VisualTransformation</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.style.TextAlign</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">coil3.compose.AsyncImage</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.AuthUiState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.AuthViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.compose.koinInject</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">LoginScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">:</span><span class="w"> </span><span class="n">AuthViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">koinInject</span><span class="p">(),</span>
<span class="w">    </span><span class="n">onLoginSuccess</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onForgotPassword</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">inputValue</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">passwordVisible</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">verifiedId</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="o">&lt;</span><span class="kt">String?</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">userImageUrl</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="o">&lt;</span><span class="kt">String?</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">userFullName</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="o">&lt;</span><span class="kt">String?</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">inputType</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">uiState</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">uiState</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">scrollState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberScrollState</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Handle login success</span>
<span class="w">    </span><span class="n">LaunchedEffect</span><span class="p">(</span><span class="n">uiState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">LoginSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">onLoginSuccess</span><span class="p">()</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Handle successful input verification</span>
<span class="w">    </span><span class="n">LaunchedEffect</span><span class="p">(</span><span class="n">uiState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">CheckInputSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">CheckInputSuccess</span>
<span class="w">            </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">id</span>
<span class="w">            </span><span class="n">inputType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">type</span>
<span class="w">            </span><span class="n">userImageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">imageUrl</span>
<span class="w">            </span><span class="n">userFullName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">fullName</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span>
<span class="w">                </span><span class="n">Brush</span><span class="p">.</span><span class="na">verticalGradient</span><span class="p">(</span>
<span class="w">                    </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">                        </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1f</span><span class="p">),</span>
<span class="w">                        </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surface</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">verticalScroll</span><span class="p">(</span><span class="n">scrollState</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">            </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">40.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">            </span><span class="c1">// App Logo/Title with animation</span>
<span class="w">            </span><span class="n">AnimatedAppLogo</span><span class="p">()</span>

<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">48.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">            </span><span class="c1">// Main Card</span>
<span class="w">            </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                    </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">shadow</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">)),</span>
<span class="w">                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CardDefaults</span><span class="p">.</span><span class="na">cardColors</span><span class="p">(</span>
<span class="w">                    </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surface</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                    </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// User Avatar (shown after verification)</span>
<span class="w">                    </span><span class="n">AnimatedVisibility</span><span class="p">(</span>
<span class="w">                        </span><span class="n">visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">userImageUrl</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                        </span><span class="n">enter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fadeIn</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expandVertically</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">scaleIn</span><span class="p">(),</span>
<span class="w">                        </span><span class="n">exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fadeOut</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">shrinkVertically</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">scaleOut</span><span class="p">()</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                            </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">AsyncImage</span><span class="p">(</span>
<span class="w">                                </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userImageUrl</span><span class="p">,</span>
<span class="w">                                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;User Avatar&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">100.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">clip</span><span class="p">(</span><span class="n">CircleShape</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primaryContainer</span><span class="p">),</span>
<span class="w">                                </span><span class="n">contentScale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ContentScale</span><span class="p">.</span><span class="na">Crop</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">                            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userFullName</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Welcome&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleLarge</span><span class="p">,</span>
<span class="w">                                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">                                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">inputType</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputType</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">                                </span><span class="p">)</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="c1">// Welcome Text (shown initially)</span>
<span class="w">                    </span><span class="n">AnimatedVisibility</span><span class="p">(</span>
<span class="w">                        </span><span class="n">visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                        </span><span class="n">enter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fadeIn</span><span class="p">(),</span>
<span class="w">                        </span><span class="n">exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fadeOut</span><span class="p">()</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                            </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Welcome Back!&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">headlineMedium</span><span class="p">,</span>
<span class="w">                                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">                                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Sign in to continue&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyLarge</span><span class="p">,</span>
<span class="w">                                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">                    </span><span class="c1">// Input Field (Email/Username/Phone)</span>
<span class="w">                    </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">                        </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputValue</span><span class="p">,</span>
<span class="w">                        </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">inputValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">verifiedId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                                </span><span class="n">userImageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                                </span><span class="n">userFullName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                                </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">                                </span><span class="n">viewModel</span><span class="p">.</span><span class="na">resetUiState</span><span class="p">()</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Email, Username, or Phone&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                        </span><span class="n">leadingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                                </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Person</span><span class="p">,</span>
<span class="w">                                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                                </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="n">trailingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">CheckInputSuccess</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                                        </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">CheckCircle</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Verified&quot;</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                                    </span><span class="p">)</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                                </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">verifiedId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                                            </span><span class="n">strokeWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.</span><span class="n">dp</span>
<span class="w">                                        </span><span class="p">)</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                                </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                        </span><span class="n">singleLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                        </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">!is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">,</span>
<span class="w">                        </span><span class="n">keyboardOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardOptions</span><span class="p">(</span>
<span class="w">                            </span><span class="n">keyboardType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardType</span><span class="p">.</span><span class="na">Text</span><span class="p">,</span>
<span class="w">                            </span><span class="n">imeAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImeAction</span><span class="p">.</span><span class="na">Next</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                        </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OutlinedTextFieldDefaults</span><span class="p">.</span><span class="na">colors</span><span class="p">(</span>
<span class="w">                            </span><span class="n">focusedBorderColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span>
<span class="w">                            </span><span class="n">unfocusedBorderColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">outline</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5f</span><span class="p">)</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="n">isError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                    </span><span class="p">)</span>

<span class="w">                    </span><span class="c1">// Error message for input</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">4.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">).</span><span class="na">message</span><span class="p">,</span>
<span class="w">                            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">error</span><span class="p">,</span>
<span class="w">                            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodySmall</span><span class="p">,</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">                    </span><span class="c1">// Password Field (animated entry)</span>
<span class="w">                    </span><span class="n">AnimatedVisibility</span><span class="p">(</span>
<span class="w">                        </span><span class="n">visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                        </span><span class="n">enter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fadeIn</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expandVertically</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">slideInVertically</span><span class="p">(),</span>
<span class="w">                        </span><span class="n">exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fadeOut</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">shrinkVertically</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">slideOutVertically</span><span class="p">()</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Column</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">                                </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">password</span><span class="p">,</span>
<span class="w">                                </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">},</span>
<span class="w">                                </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Password&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                                </span><span class="n">leadingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                                        </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Lock</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                                    </span><span class="p">)</span>
<span class="w">                                </span><span class="p">},</span>
<span class="w">                                </span><span class="n">trailingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">Row</span><span class="p">(</span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                            </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                                                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                                                    </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                                                    </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                                                </span><span class="n">strokeWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.</span><span class="n">dp</span>
<span class="w">                                            </span><span class="p">)</span>
<span class="w">                                        </span><span class="p">}</span>
<span class="w">                                        </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                                            </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">passwordVisible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">passwordVisible</span><span class="w"> </span><span class="p">}</span>
<span class="w">                                        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                                                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">passwordVisible</span><span class="p">)</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Visibility</span>
<span class="w">                                                </span><span class="k">else</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">VisibilityOff</span><span class="p">,</span>
<span class="w">                                                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">passwordVisible</span><span class="p">)</span>
<span class="w">                                                    </span><span class="s">&quot;Hide password&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;Show password&quot;</span><span class="p">,</span>
<span class="w">                                                </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">                                            </span><span class="p">)</span>
<span class="w">                                        </span><span class="p">}</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                </span><span class="p">},</span>
<span class="w">                                </span><span class="n">visualTransformation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">passwordVisible</span><span class="p">)</span>
<span class="w">                                    </span><span class="n">VisualTransformation</span><span class="p">.</span><span class="na">None</span>
<span class="w">                                </span><span class="k">else</span>
<span class="w">                                    </span><span class="n">PasswordVisualTransformation</span><span class="p">(),</span>
<span class="w">                                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                                </span><span class="n">singleLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                                </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">!is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">,</span>
<span class="w">                                </span><span class="n">keyboardOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardOptions</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">keyboardType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardType</span><span class="p">.</span><span class="na">Password</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">imeAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImeAction</span><span class="p">.</span><span class="na">Done</span>
<span class="w">                                </span><span class="p">),</span>
<span class="w">                                </span><span class="n">keyboardActions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardActions</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">onDone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                            </span><span class="n">viewModel</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="n">verifiedId</span><span class="o">!!</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span>
<span class="w">                                        </span><span class="p">}</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                </span><span class="p">),</span>
<span class="w">                                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OutlinedTextFieldDefaults</span><span class="p">.</span><span class="na">colors</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">focusedBorderColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">unfocusedBorderColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">outline</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5f</span><span class="p">)</span>
<span class="w">                                </span><span class="p">),</span>
<span class="w">                                </span><span class="n">isError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                            </span><span class="c1">// Error message for password</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">4.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">).</span><span class="na">message</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">error</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodySmall</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                                </span><span class="p">)</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">                    </span><span class="c1">// Action Buttons</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">verifiedId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Button</span><span class="p">(</span>
<span class="w">                            </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">inputValue</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">viewModel</span><span class="p">.</span><span class="na">checkInput</span><span class="p">(</span><span class="n">inputValue</span><span class="p">)</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                            </span><span class="p">},</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                                </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">56.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                            </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputValue</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">!is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">,</span>
<span class="w">                            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                            </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ButtonDefaults</span><span class="p">.</span><span class="na">buttonColors</span><span class="p">(</span>
<span class="w">                                </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                                    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimary</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">strokeWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.</span><span class="n">dp</span>
<span class="w">                                </span><span class="p">)</span>
<span class="w">                            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="w">                                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                        </span><span class="s">&quot;Continue&quot;</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span>
<span class="w">                                    </span><span class="p">)</span>
<span class="w">                                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                                        </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">ArrowForward</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">)</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                            </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">OutlinedButton</span><span class="p">(</span>
<span class="w">                                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                                    </span><span class="n">userImageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                                    </span><span class="n">userFullName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                                    </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">                                    </span><span class="n">inputValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">                                    </span><span class="n">viewModel</span><span class="p">.</span><span class="na">resetUiState</span><span class="p">()</span>
<span class="w">                                </span><span class="p">},</span>
<span class="w">                                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">56.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                                </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">!is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">,</span>
<span class="w">                                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">ArrowBack</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                                </span><span class="p">)</span>
<span class="w">                                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                    </span><span class="s">&quot;Change&quot;</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span>
<span class="w">                                </span><span class="p">)</span>
<span class="w">                            </span><span class="p">}</span>

<span class="w">                            </span><span class="n">Button</span><span class="p">(</span>
<span class="w">                                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="n">viewModel</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="n">verifiedId</span><span class="o">!!</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                </span><span class="p">},</span>
<span class="w">                                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">56.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                                </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">password</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">!is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">,</span>
<span class="w">                                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                                        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimary</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">strokeWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.</span><span class="n">dp</span>
<span class="w">                                    </span><span class="p">)</span>
<span class="w">                                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                        </span><span class="s">&quot;Login&quot;</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span>
<span class="w">                                    </span><span class="p">)</span>
<span class="w">                                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                                        </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Login</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">)</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">                    </span><span class="c1">// Forgot Password Link</span>
<span class="w">                    </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">                        </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onForgotPassword</span><span class="p">,</span>
<span class="w">                        </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uiState</span><span class="w"> </span><span class="k">!is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="s">&quot;Forgot password?&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyLarge</span><span class="p">,</span>
<span class="w">                            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">            </span><span class="c1">// Retry button for initialization errors</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uiState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">verifiedId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">inputValue</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">OutlinedButton</span><span class="p">(</span>
<span class="w">                    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">retry</span><span class="p">()</span><span class="w"> </span><span class="p">},</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Refresh</span><span class="p">,</span><span class="w"> </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Retry&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">40.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">AnimatedAppLogo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">infiniteTransition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberInfiniteTransition</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">scale</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">infiniteTransition</span><span class="p">.</span><span class="na">animateFloat</span><span class="p">(</span>
<span class="w">        </span><span class="n">initialValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.95f</span><span class="p">,</span>
<span class="w">        </span><span class="n">targetValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.05f</span><span class="p">,</span>
<span class="w">        </span><span class="n">animationSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infiniteRepeatable</span><span class="p">(</span>
<span class="w">            </span><span class="n">animation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tween</span><span class="p">(</span><span class="m">2000</span><span class="p">,</span><span class="w"> </span><span class="n">easing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LinearEasing</span><span class="p">),</span>
<span class="w">            </span><span class="n">repeatMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RepeatMode</span><span class="p">.</span><span class="na">Reverse</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Surface</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">100.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">shadow</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">CircleShape</span><span class="p">),</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CircleShape</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primaryContainer</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Box</span><span class="p">(</span>
<span class="w">                </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Lock</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">graphicsLayer</span><span class="p">(</span><span class="n">scaleX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">scaleY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale</span><span class="p">),</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ONVO&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">displaySmall</span><span class="p">,</span>
<span class="w">            </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_ui_PasswordResetScreen.kt'>commonMain\kotlin\me\onvo\onvo\presentation\ui\PasswordResetScreen.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/presentation/ui/PasswordResetScreen.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.animation.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.animation.core.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.background</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.rememberScrollState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.CircleShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.RoundedCornerShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.text.KeyboardActions</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.text.KeyboardOptions</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.verticalScroll</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.automirrored.filled.ArrowBack</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.filled.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.draw.clip</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.draw.shadow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.Brush</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.graphicsLayer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.vector.ImageVector</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.layout.ContentScale</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.font.FontWeight</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.ImeAction</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.KeyboardType</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.PasswordVisualTransformation</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.VisualTransformation</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.style.TextAlign</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">coil3.compose.AsyncImage</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.PasswordResetStep</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.PasswordResetViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.compose.koinInject</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">PasswordResetScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">koinInject</span><span class="p">(),</span>
<span class="w">    </span><span class="n">onBackClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onPasswordChanged</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">isFromSettings</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">isFromSettings</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="n">prefilledUserId</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">state</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">scrollState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberScrollState</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Initialize from settings if applicable</span>
<span class="w">    </span><span class="n">LaunchedEffect</span><span class="p">(</span><span class="n">prefilledUserId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">prefilledUserId</span><span class="p">.</span><span class="na">isNullOrEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">viewModel</span><span class="p">.</span><span class="na">initializeFromSettings</span><span class="p">(</span><span class="n">prefilledUserId</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Handle success - pass isFromSettings flag to callback</span>
<span class="w">    </span><span class="n">LaunchedEffect</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">currentStep</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">currentStep</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">Success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">successStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">currentStep</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">Success</span>
<span class="w">            </span><span class="n">onPasswordChanged</span><span class="p">(</span><span class="n">successStep</span><span class="p">.</span><span class="na">isFromSettings</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span>
<span class="w">                </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isFromSettings</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Change Password&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;Reset Password&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">navigationIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">IconButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onBackClick</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">AutoMirrored</span><span class="p">.</span><span class="na">Filled</span><span class="p">.</span><span class="na">ArrowBack</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Back&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TopAppBarDefaults</span><span class="p">.</span><span class="na">topAppBarColors</span><span class="p">(</span>
<span class="w">                    </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surface</span><span class="p">,</span>
<span class="w">                    </span><span class="n">titleContentColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">paddingValues</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">Box</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">paddingValues</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">background</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Brush</span><span class="p">.</span><span class="na">verticalGradient</span><span class="p">(</span>
<span class="w">                        </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">                            </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05f</span><span class="p">),</span>
<span class="w">                            </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surface</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                    </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">verticalScroll</span><span class="p">(</span><span class="n">scrollState</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">                </span><span class="c1">// Step indicator (only if not from settings)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isFromSettings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">EnhancedStepIndicator</span><span class="p">(</span><span class="n">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">currentStep</span><span class="p">)</span>
<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">32.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="c1">// Main Card</span>
<span class="w">                </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">shadow</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">)),</span>
<span class="w">                    </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                    </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CardDefaults</span><span class="p">.</span><span class="na">cardColors</span><span class="p">(</span>
<span class="w">                        </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surface</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// Show loading overlay</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">isLoading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                                </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">                                </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">                                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">48.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                                    </span><span class="n">strokeWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4.</span><span class="n">dp</span>
<span class="w">                                </span><span class="p">)</span>
<span class="w">                                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                    </span><span class="s">&quot;Processing...&quot;</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyLarge</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">                                </span><span class="p">)</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="c1">// Show appropriate step content</span>
<span class="w">                            </span><span class="n">AnimatedContent</span><span class="p">(</span>
<span class="w">                                </span><span class="n">targetState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">currentStep</span><span class="p">,</span>
<span class="w">                                </span><span class="n">transitionSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="n">fadeIn</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">slideInVertically</span><span class="p">()</span><span class="w"> </span><span class="n">togetherWith</span>
<span class="w">                                            </span><span class="n">fadeOut</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">slideOutVertically</span><span class="p">()</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                                </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">step</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterUserId</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="n">UserInputStep</span><span class="p">(</span>
<span class="w">                                            </span><span class="n">viewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">error</span>
<span class="w">                                        </span><span class="p">)</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                    </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="n">CodeStep</span><span class="p">(</span>
<span class="w">                                            </span><span class="n">viewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">step</span><span class="p">.</span><span class="na">message</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">error</span>
<span class="w">                                        </span><span class="p">)</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                    </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterNewPassword</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="n">PasswordStep</span><span class="p">(</span>
<span class="w">                                            </span><span class="n">viewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">error</span>
<span class="w">                                        </span><span class="p">)</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                    </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="n">SuccessStep</span><span class="p">(</span>
<span class="w">                                            </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">step</span><span class="p">.</span><span class="na">userName</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">step</span><span class="p">.</span><span class="na">isFromSettings</span>
<span class="w">                                        </span><span class="p">)</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">40.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">EnhancedStepIndicator</span><span class="p">(</span><span class="n">currentStep</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">stepNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">currentStep</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterUserId</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="m">1</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="m">2</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterNewPassword</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="m">3</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="m">3</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">Row</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">SpaceEvenly</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">EnhancedStepCircle</span><span class="p">(</span>
<span class="w">            </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Verify&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Person</span><span class="p">,</span>
<span class="w">            </span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stepNumber</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">            </span><span class="n">isComplete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stepNumber</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">AnimatedStepLine</span><span class="p">(</span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stepNumber</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">EnhancedStepCircle</span><span class="p">(</span>
<span class="w">            </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Code&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Email</span><span class="p">,</span>
<span class="w">            </span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stepNumber</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">            </span><span class="n">isComplete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stepNumber</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">2</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">AnimatedStepLine</span><span class="p">(</span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stepNumber</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">        </span><span class="n">EnhancedStepCircle</span><span class="p">(</span>
<span class="w">            </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Password&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Lock</span><span class="p">,</span>
<span class="w">            </span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stepNumber</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">            </span><span class="n">isComplete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">EnhancedStepCircle</span><span class="p">(</span>
<span class="w">    </span><span class="n">number</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="n">label</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">icon</span><span class="p">:</span><span class="w"> </span><span class="n">ImageVector</span><span class="p">,</span>
<span class="w">    </span><span class="n">isActive</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="n">isComplete</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Surface</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">56.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CircleShape</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">isComplete</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="n">isActive</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primaryContainer</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surfaceVariant</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">shadowElevation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isActive</span><span class="p">)</span><span class="w"> </span><span class="m">4.</span><span class="n">dp</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="m">0.</span><span class="n">dp</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Box</span><span class="p">(</span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isComplete</span><span class="p">)</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Check</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">icon</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">isComplete</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimary</span>
<span class="w">                        </span><span class="n">isActive</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimaryContainer</span>
<span class="w">                        </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">labelSmall</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isActive</span><span class="p">)</span>
<span class="w">                </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">AnimatedStepLine</span><span class="p">(</span><span class="n">isActive</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">animatedProgress</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">animateFloatAsState</span><span class="p">(</span>
<span class="w">        </span><span class="n">targetValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isActive</span><span class="p">)</span><span class="w"> </span><span class="m">1f</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="m">0f</span><span class="p">,</span>
<span class="w">        </span><span class="n">animationSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tween</span><span class="p">(</span><span class="m">500</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">48.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">4.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">clip</span><span class="p">(</span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">2.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surfaceVariant</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Box</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxHeight</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(</span><span class="n">animatedProgress</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SuccessStep</span><span class="p">(</span><span class="n">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">isFromSettings</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">infiniteTransition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberInfiniteTransition</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">scale</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">infiniteTransition</span><span class="p">.</span><span class="na">animateFloat</span><span class="p">(</span>
<span class="w">        </span><span class="n">initialValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9f</span><span class="p">,</span>
<span class="w">        </span><span class="n">targetValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.1f</span><span class="p">,</span>
<span class="w">        </span><span class="n">animationSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infiniteRepeatable</span><span class="p">(</span>
<span class="w">            </span><span class="n">animation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tween</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">easing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FastOutSlowInEasing</span><span class="p">),</span>
<span class="w">            </span><span class="n">repeatMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RepeatMode</span><span class="p">.</span><span class="na">Reverse</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Surface</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">100.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CircleShape</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primaryContainer</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2f</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Box</span><span class="p">(</span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">CheckCircle</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">60.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">graphicsLayer</span><span class="p">(</span><span class="n">scaleX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">scaleY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale</span><span class="p">),</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Success!&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">headlineMedium</span><span class="p">,</span>
<span class="w">            </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span>
<span class="w">            </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isFromSettings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s">&quot;Your password has been changed successfully&quot;</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s">&quot;Welcome back, </span><span class="si">$</span><span class="n">userName</span><span class="s">!\nRedirecting to home...&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyLarge</span><span class="p">,</span>
<span class="w">            </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">UserInputStep</span><span class="p">(</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">userInput</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">StepHeader</span><span class="p">(</span>
<span class="w">            </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Person</span><span class="p">,</span>
<span class="w">            </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Enter Your Information&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;We&#39;ll send a reset code to your registered email&quot;</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInput</span><span class="p">,</span>
<span class="w">            </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">userInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span>
<span class="w">                </span><span class="n">viewModel</span><span class="p">.</span><span class="na">clearError</span><span class="p">()</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Username, Email, or Phone&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="n">leadingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Person</span><span class="p">,</span>
<span class="w">                    </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">            </span><span class="n">singleLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">keyboardOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardOptions</span><span class="p">(</span>
<span class="w">                </span><span class="n">keyboardType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardType</span><span class="p">.</span><span class="na">Text</span><span class="p">,</span>
<span class="w">                </span><span class="n">imeAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImeAction</span><span class="p">.</span><span class="na">Done</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">keyboardActions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardActions</span><span class="p">(</span>
<span class="w">                </span><span class="n">onDone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">userInput</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">())</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">requestCodeByInput</span><span class="p">(</span><span class="n">userInput</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">isError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ErrorMessage</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">Button</span><span class="p">(</span>
<span class="w">            </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">requestCodeByInput</span><span class="p">(</span><span class="n">userInput</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">56.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInput</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">(),</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Send</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="s">&quot;Send Reset Code&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">CodeStep</span><span class="p">(</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">,</span>
<span class="w">    </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">code</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">StepHeader</span><span class="p">(</span>
<span class="w">            </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Email</span><span class="p">,</span>
<span class="w">            </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Enter Reset Code&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Enter the 6-digit code sent to your email&quot;</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">code</span><span class="p">,</span>
<span class="w">            </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">it</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">all</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">char</span><span class="p">.</span><span class="na">isDigit</span><span class="p">()</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span>
<span class="w">                    </span><span class="n">viewModel</span><span class="p">.</span><span class="na">clearError</span><span class="p">()</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;6-Digit Code&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="n">leadingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Lock</span><span class="p">,</span>
<span class="w">                    </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">            </span><span class="n">singleLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">keyboardOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardOptions</span><span class="p">(</span>
<span class="w">                </span><span class="n">keyboardType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardType</span><span class="p">.</span><span class="na">Number</span><span class="p">,</span>
<span class="w">                </span><span class="n">imeAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImeAction</span><span class="p">.</span><span class="na">Done</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">keyboardActions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardActions</span><span class="p">(</span>
<span class="w">                </span><span class="n">onDone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">submitCode</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">isError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ErrorMessage</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">Button</span><span class="p">(</span>
<span class="w">            </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">submitCode</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">56.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">code</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">6</span><span class="p">,</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">VerifiedUser</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="s">&quot;Verify Code&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">            </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">resendCode</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Refresh</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">18.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Resend Code&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">PasswordStep</span><span class="p">(</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">newPassword</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">confirmPassword</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">showPassword</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">showConfirmPassword</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">StepHeader</span><span class="p">(</span>
<span class="w">            </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Key</span><span class="p">,</span>
<span class="w">            </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Create New Password&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Password must be at least 6 characters&quot;</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newPassword</span><span class="p">,</span>
<span class="w">            </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">newPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span>
<span class="w">                </span><span class="n">viewModel</span><span class="p">.</span><span class="na">clearError</span><span class="p">()</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;New Password&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="n">leadingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Lock</span><span class="p">,</span>
<span class="w">                    </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">trailingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">IconButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">showPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">showPassword</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showPassword</span><span class="p">)</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Visibility</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">VisibilityOff</span><span class="p">,</span>
<span class="w">                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showPassword</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Hide&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;Show&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">visualTransformation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showPassword</span><span class="p">)</span>
<span class="w">                </span><span class="n">VisualTransformation</span><span class="p">.</span><span class="na">None</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">PasswordVisualTransformation</span><span class="p">(),</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">            </span><span class="n">singleLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">keyboardOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardOptions</span><span class="p">(</span>
<span class="w">                </span><span class="n">keyboardType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardType</span><span class="p">.</span><span class="na">Password</span><span class="p">,</span>
<span class="w">                </span><span class="n">imeAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImeAction</span><span class="p">.</span><span class="na">Next</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">confirmPassword</span><span class="p">,</span>
<span class="w">            </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">confirmPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span>
<span class="w">                </span><span class="n">viewModel</span><span class="p">.</span><span class="na">clearError</span><span class="p">()</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Confirm Password&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="n">leadingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Lock</span><span class="p">,</span>
<span class="w">                    </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">trailingIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">IconButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">showConfirmPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">showConfirmPassword</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showConfirmPassword</span><span class="p">)</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Visibility</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">VisibilityOff</span><span class="p">,</span>
<span class="w">                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showConfirmPassword</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Hide&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;Show&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">visualTransformation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showConfirmPassword</span><span class="p">)</span>
<span class="w">                </span><span class="n">VisualTransformation</span><span class="p">.</span><span class="na">None</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">PasswordVisualTransformation</span><span class="p">(),</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">            </span><span class="n">singleLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">keyboardOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardOptions</span><span class="p">(</span>
<span class="w">                </span><span class="n">keyboardType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardType</span><span class="p">.</span><span class="na">Password</span><span class="p">,</span>
<span class="w">                </span><span class="n">imeAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImeAction</span><span class="p">.</span><span class="na">Done</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">keyboardActions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardActions</span><span class="p">(</span>
<span class="w">                </span><span class="n">onDone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">newPassword</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">confirmPassword</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">())</span>
<span class="w">                        </span><span class="n">viewModel</span><span class="p">.</span><span class="na">changePassword</span><span class="p">(</span><span class="n">newPassword</span><span class="p">,</span><span class="w"> </span><span class="n">confirmPassword</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">isError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ErrorMessage</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">Button</span><span class="p">(</span>
<span class="w">            </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">changePassword</span><span class="p">(</span><span class="n">newPassword</span><span class="p">,</span><span class="w"> </span><span class="n">confirmPassword</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">56.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newPassword</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">confirmPassword</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">(),</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Check</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="s">&quot;Change Password&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">StepHeader</span><span class="p">(</span>
<span class="w">    </span><span class="n">icon</span><span class="p">:</span><span class="w"> </span><span class="n">ImageVector</span><span class="p">,</span>
<span class="w">    </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">subtitle</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Surface</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">72.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CircleShape</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primaryContainer</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3f</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Box</span><span class="p">(</span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icon</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">36.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">headlineSmall</span><span class="p">,</span>
<span class="w">            </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">            </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subtitle</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span><span class="p">,</span>
<span class="w">            </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">ErrorMessage</span><span class="p">(</span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Surface</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">errorContainer</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Error</span><span class="p">,</span>
<span class="w">                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">error</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">message</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodySmall</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onErrorContainer</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_ui_ProfileScreen.kt'>commonMain\kotlin\me\onvo\onvo\presentation\ui\ProfileScreen.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/presentation/ui/ProfileScreen.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.animation.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.animation.core.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.background</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.border</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.clickable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.LazyColumn</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.rememberLazyListState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.CircleShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.RoundedCornerShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.automirrored.filled.ArrowBack</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.filled.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.TabRowDefaults.tabIndicatorOffset</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.draw.clip</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.Brush</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.Color</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.vector.ImageVector</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.layout.ContentScale</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.font.FontWeight</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.style.TextAlign</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.style.TextOverflow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.sp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">coil3.compose.AsyncImage</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.ProfileViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.compose.koinInject</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlin.math.min</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">ProfileScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="n">onBackClick</span><span class="p">:</span><span class="w"> </span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">:</span><span class="w"> </span><span class="n">ProfileViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">koinInject</span><span class="p">()</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isOwnProfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">scrollState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberLazyListState</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Load profile data</span>
<span class="w">    </span><span class="n">LaunchedEffect</span><span class="p">(</span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isOwnProfile</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">viewModel</span><span class="p">.</span><span class="na">loadCurrentUserStatus</span><span class="p">()</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">viewModel</span><span class="p">.</span><span class="na">loadUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentUserState</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">currentUserState</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">profileState</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">profileState</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isRefreshing</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">isRefreshing</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Load full profile when auth status is ready</span>
<span class="w">    </span><span class="n">LaunchedEffect</span><span class="p">(</span><span class="n">currentUserState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isOwnProfile</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">currentUserState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">userData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">currentUserState</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">).</span><span class="na">user</span>
<span class="w">            </span><span class="n">viewModel</span><span class="p">.</span><span class="na">loadUserProfile</span><span class="p">(</span><span class="n">userData</span><span class="p">.</span><span class="na">id</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Calculate scroll progress for animations</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">scrollOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">derivedStateOf</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">firstVisibleItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scrollState</span><span class="p">.</span><span class="na">firstVisibleItemIndex</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">firstVisibleOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scrollState</span><span class="p">.</span><span class="na">firstVisibleItemScrollOffset</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">firstVisibleItem</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">min</span><span class="p">(</span><span class="n">firstVisibleOffset</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">300f</span><span class="p">,</span><span class="w"> </span><span class="m">1f</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="m">1f</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">Box</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profileState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">LoadingScreen</span><span class="p">()</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">ProfileContent</span><span class="p">(</span>
<span class="w">                    </span><span class="n">profile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">profile</span><span class="p">,</span>
<span class="w">                    </span><span class="n">isOwnProfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isOwnProfile</span><span class="p">,</span>
<span class="w">                    </span><span class="n">scrollState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scrollState</span><span class="p">,</span>
<span class="w">                    </span><span class="n">scrollProgress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scrollOffset</span><span class="p">.</span><span class="na">value</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onRefresh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isOwnProfile</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="p">(</span><span class="n">currentUserState</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">)</span><span class="o">?.</span><span class="na">user</span><span class="o">?.</span><span class="na">id</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">viewModel</span><span class="p">.</span><span class="na">refreshProfile</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">userId</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">refreshProfile</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">ErrorScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">message</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onRetry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isOwnProfile</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">viewModel</span><span class="p">.</span><span class="na">loadCurrentUserStatus</span><span class="p">()</span>
<span class="w">                        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">userId</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">retry</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Animated Top App Bar</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profileState</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">AnimatedTopAppBar</span><span class="p">(</span>
<span class="w">                </span><span class="n">profile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">profileState</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">).</span><span class="na">profile</span><span class="p">,</span>
<span class="w">                </span><span class="n">scrollProgress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scrollOffset</span><span class="p">.</span><span class="na">value</span><span class="p">,</span>
<span class="w">                </span><span class="n">isOwnProfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isOwnProfile</span><span class="p">,</span>
<span class="w">                </span><span class="n">onBackClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onBackClick</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">AnimatedTopAppBar</span><span class="p">(</span>
<span class="w">    </span><span class="n">profile</span><span class="p">:</span><span class="w"> </span><span class="n">UserProfile</span><span class="p">,</span>
<span class="w">    </span><span class="n">scrollProgress</span><span class="p">:</span><span class="w"> </span><span class="kt">Float</span><span class="p">,</span>
<span class="w">    </span><span class="n">isOwnProfile</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="n">onBackClick</span><span class="p">:</span><span class="w"> </span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">)</span><span class="o">?</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TopAppBar</span><span class="p">(</span>
<span class="w">        </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">AnimatedVisibility</span><span class="p">(</span>
<span class="w">                </span><span class="n">visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scrollProgress</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0.7f</span><span class="p">,</span>
<span class="w">                </span><span class="n">enter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fadeIn</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expandHorizontally</span><span class="p">(),</span>
<span class="w">                </span><span class="n">exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fadeOut</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">shrinkHorizontally</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">,</span>
<span class="w">                    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">AsyncImage</span><span class="p">(</span>
<span class="w">                        </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">image</span><span class="p">,</span>
<span class="w">                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">32.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">clip</span><span class="p">(</span><span class="n">CircleShape</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">2.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span><span class="w"> </span><span class="n">CircleShape</span><span class="p">),</span>
<span class="w">                        </span><span class="n">contentScale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ContentScale</span><span class="p">.</span><span class="na">Crop</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">fullname</span><span class="p">,</span>
<span class="w">                        </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span><span class="p">,</span>
<span class="w">                        </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">                        </span><span class="n">maxLines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">                        </span><span class="n">overflow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextOverflow</span><span class="p">.</span><span class="na">Ellipsis</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">navigationIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isOwnProfile</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">IconButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">onBackClick</span><span class="o">?.</span><span class="na">invoke</span><span class="p">()</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                        </span><span class="n">Icons</span><span class="p">.</span><span class="na">AutoMirrored</span><span class="p">.</span><span class="na">Filled</span><span class="p">.</span><span class="na">ArrowBack</span><span class="p">,</span>
<span class="w">                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Back&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">IconButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* More options */</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">MoreVert</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;More&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TopAppBarDefaults</span><span class="p">.</span><span class="na">topAppBarColors</span><span class="p">(</span>
<span class="w">            </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surface</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scrollProgress</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">ProfileContent</span><span class="p">(</span>
<span class="w">    </span><span class="n">profile</span><span class="p">:</span><span class="w"> </span><span class="n">UserProfile</span><span class="p">,</span>
<span class="w">    </span><span class="n">isOwnProfile</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="n">scrollState</span><span class="p">:</span><span class="w"> </span><span class="n">androidx</span><span class="p">.</span><span class="na">compose</span><span class="p">.</span><span class="na">foundation</span><span class="p">.</span><span class="na">lazy</span><span class="p">.</span><span class="na">LazyListState</span><span class="p">,</span>
<span class="w">    </span><span class="n">scrollProgress</span><span class="p">:</span><span class="w"> </span><span class="kt">Float</span><span class="p">,</span>
<span class="w">    </span><span class="n">onRefresh</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">selectedTab</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">tabs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span><span class="s">&quot;Threads&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Collections&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Posts&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">LazyColumn</span><span class="p">(</span>
<span class="w">        </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scrollState</span><span class="p">,</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Cover &amp; Profile Header Section</span>
<span class="w">        </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Box</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Cover Image with Gradient</span>
<span class="w">                </span><span class="n">Box</span><span class="p">(</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">180.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">AsyncImage</span><span class="p">(</span>
<span class="w">                        </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">image</span><span class="p">,</span><span class="w"> </span><span class="c1">// Use cover image if available</span>
<span class="w">                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Cover&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">                        </span><span class="n">contentScale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ContentScale</span><span class="p">.</span><span class="na">Crop</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                    </span><span class="c1">// Gradient overlay</span>
<span class="w">                    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span>
<span class="w">                                </span><span class="n">Brush</span><span class="p">.</span><span class="na">verticalGradient</span><span class="p">(</span>
<span class="w">                                    </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">                                        </span><span class="n">Color</span><span class="p">.</span><span class="na">Transparent</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surface</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3f</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">)</span>
<span class="w">                                </span><span class="p">)</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="c1">// Profile Image - Positioned to overlap cover</span>
<span class="w">                </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">120.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                    </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// Animated Profile Image</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">imageSize</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">animateDpAsState</span><span class="p">(</span>
<span class="w">                        </span><span class="n">targetValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scrollProgress</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0.5f</span><span class="p">)</span><span class="w"> </span><span class="m">64.</span><span class="n">dp</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="m">100.</span><span class="n">dp</span><span class="p">,</span>
<span class="w">                        </span><span class="n">animationSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tween</span><span class="p">(</span><span class="n">durationMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span>

<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">borderWidth</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">animateDpAsState</span><span class="p">(</span>
<span class="w">                        </span><span class="n">targetValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scrollProgress</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0.5f</span><span class="p">)</span><span class="w"> </span><span class="m">2.</span><span class="n">dp</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="m">4.</span><span class="n">dp</span><span class="p">,</span>
<span class="w">                        </span><span class="n">animationSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tween</span><span class="p">(</span><span class="n">durationMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span>

<span class="w">                    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="n">imageSize</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">border</span><span class="p">(</span>
<span class="w">                                </span><span class="n">borderWidth</span><span class="p">,</span>
<span class="w">                                </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span>
<span class="w">                                </span><span class="n">CircleShape</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">4.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">AsyncImage</span><span class="p">(</span>
<span class="w">                            </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">image</span><span class="p">,</span>
<span class="w">                            </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Profile Picture&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                                </span><span class="p">.</span><span class="na">clip</span><span class="p">(</span><span class="n">CircleShape</span><span class="p">)</span>
<span class="w">                                </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surfaceVariant</span><span class="p">),</span>
<span class="w">                            </span><span class="n">contentScale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ContentScale</span><span class="p">.</span><span class="na">Crop</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">                    </span><span class="c1">// Name with verification badge</span>
<span class="w">                    </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                        </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">,</span>
<span class="w">                        </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">fullname</span><span class="p">,</span>
<span class="w">                            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleLarge</span><span class="p">,</span>
<span class="w">                            </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">                            </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">22.</span><span class="n">sp</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profile</span><span class="p">.</span><span class="na">isVerified</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">6.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                                </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Verified</span><span class="p">,</span>
<span class="w">                                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Verified&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF6B7FED</span><span class="p">),</span>
<span class="w">                                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">22.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="c1">// Username</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;@</span><span class="si">${</span><span class="n">profile</span><span class="p">.</span><span class="na">username</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">                        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span><span class="p">,</span>
<span class="w">                        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15.</span><span class="n">sp</span>
<span class="w">                    </span><span class="p">)</span>

<span class="w">                    </span><span class="c1">// Bio</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profile</span><span class="p">.</span><span class="na">bio</span><span class="p">.</span><span class="na">isNotBlank</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">bio</span><span class="p">,</span>
<span class="w">                            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">                            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span><span class="p">,</span>
<span class="w">                            </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">                            </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">horizontal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">32.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="c1">// Followers/Following</span>
<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                    </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                        </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">                        </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">${</span><span class="n">profile</span><span class="p">.</span><span class="na">cnt</span><span class="p">.</span><span class="na">followers</span><span class="si">}</span><span class="s"> Followers&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">                            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span><span class="p">,</span>
<span class="w">                            </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Medium</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">${</span><span class="n">profile</span><span class="p">.</span><span class="na">cnt</span><span class="p">.</span><span class="na">following</span><span class="si">}</span><span class="s"> Following&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">                            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span><span class="p">,</span>
<span class="w">                            </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Medium</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Social Links Row</span>
<span class="w">        </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">SocialLinksRow</span><span class="p">(</span><span class="n">links</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">lnks</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Action Buttons</span>
<span class="w">        </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ActionButtonsRow</span><span class="p">(</span>
<span class="w">                </span><span class="n">isOwnProfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isOwnProfile</span><span class="p">,</span>
<span class="w">                </span><span class="n">followed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">followed</span><span class="p">,</span>
<span class="w">                </span><span class="n">onPostClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* TODO */</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">onShareClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* TODO */</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">onFollowClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* TODO */</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Tabs</span>
<span class="w">        </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TabRow</span><span class="p">(</span>
<span class="w">                </span><span class="n">selectedTabIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">selectedTab</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">surface</span><span class="p">,</span>
<span class="w">                </span><span class="n">contentColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span><span class="p">,</span>
<span class="w">                </span><span class="n">indicator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">tabPositions</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">                        </span><span class="n">Modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">tabIndicatorOffset</span><span class="p">(</span><span class="n">tabPositions</span><span class="o">[</span><span class="n">selectedTab</span><span class="o">]</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">3.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span>
<span class="w">                                </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span>
<span class="w">                                </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="n">topStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">topEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">tabs</span><span class="p">.</span><span class="na">forEachIndexed</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">Tab</span><span class="p">(</span>
<span class="w">                        </span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">selectedTab</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">index</span><span class="p">,</span>
<span class="w">                        </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">selectedTab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p">},</span>
<span class="w">                        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">                                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">selectedTab</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Normal</span><span class="p">,</span>
<span class="w">                                </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15.</span><span class="n">sp</span>
<span class="w">                            </span><span class="p">)</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Content Area (Posts will be added later)</span>
<span class="w">        </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Box</span><span class="p">(</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                    </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">400.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Posts will appear here&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyLarge</span><span class="p">,</span>
<span class="w">                    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SocialLinksRow</span><span class="p">(</span><span class="n">links</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserLink</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Filter and sort links</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">validLinks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">links</span>
<span class="w">        </span><span class="p">.</span><span class="na">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nb">it</span><span class="p">.</span><span class="na">d</span><span class="p">.</span><span class="na">isNotBlank</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                    </span><span class="o">!</span><span class="nb">it</span><span class="p">.</span><span class="na">d</span><span class="p">.</span><span class="na">trim</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;Test&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ignoreCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                    </span><span class="nb">it</span><span class="p">.</span><span class="na">d</span><span class="p">.</span><span class="na">trim</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;Test &quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="na">sortedBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">linkType</span><span class="p">.</span><span class="na">ordinal</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Sort by enum order</span>
<span class="w">        </span><span class="p">.</span><span class="na">take</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">validLinks</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">vertical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Social Media Title</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Connect&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">labelMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1">// Social Icons in scrollable row</span>
<span class="w">            </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                    </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">horizontal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">validLinks</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">SocialIconButton</span><span class="p">(</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">link</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SocialIconButton</span><span class="p">(</span><span class="n">link</span><span class="p">:</span><span class="w"> </span><span class="n">UserLink</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="p">(</span><span class="nv">icon</span><span class="p">,</span><span class="w"> </span><span class="nv">color</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getSocialIconWithColor</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="na">linkType</span><span class="p">)</span>

<span class="w">    </span><span class="n">Surface</span><span class="p">(</span>
<span class="w">        </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* TODO: Open link */</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">44.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">        </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CircleShape</span><span class="p">,</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1f</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Box</span><span class="p">(</span>
<span class="w">            </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icon</span><span class="p">,</span>
<span class="w">                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">link</span><span class="p">.</span><span class="na">linkType</span><span class="p">.</span><span class="na">displayName</span><span class="p">,</span>
<span class="w">                </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">22.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">ActionButtonsRow</span><span class="p">(</span>
<span class="w">    </span><span class="n">isOwnProfile</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="n">followed</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">,</span>
<span class="w">    </span><span class="n">onPostClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onShareClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onFollowClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Row</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">horizontal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">vertical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">        </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isOwnProfile</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Post something button</span>
<span class="w">            </span><span class="n">Button</span><span class="p">(</span>
<span class="w">                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onPostClick</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">),</span>
<span class="w">                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ButtonDefaults</span><span class="p">.</span><span class="na">buttonColors</span><span class="p">(</span>
<span class="w">                    </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Edit</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">18.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Post something&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15.</span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Share button</span>
<span class="w">            </span><span class="n">OutlinedButton</span><span class="p">(</span>
<span class="w">                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onShareClick</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">48.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">contentPadding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PaddingValues</span><span class="p">(</span><span class="m">0.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ButtonDefaults</span><span class="p">.</span><span class="na">outlinedButtonColors</span><span class="p">(</span>
<span class="w">                    </span><span class="n">contentColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Share</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Share&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Follow button</span>
<span class="w">            </span><span class="n">Button</span><span class="p">(</span>
<span class="w">                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onFollowClick</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">),</span>
<span class="w">                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">followed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">ButtonDefaults</span><span class="p">.</span><span class="na">outlinedButtonColors</span><span class="p">(</span>
<span class="w">                        </span><span class="n">contentColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">ButtonDefaults</span><span class="p">.</span><span class="na">buttonColors</span><span class="p">(</span>
<span class="w">                        </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">followed</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Following&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;Follow&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">SemiBold</span><span class="p">,</span>
<span class="w">                    </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15.</span><span class="n">sp</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Share button</span>
<span class="w">            </span><span class="n">OutlinedButton</span><span class="p">(</span>
<span class="w">                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onShareClick</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">48.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">contentPadding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PaddingValues</span><span class="p">(</span><span class="m">0.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Share</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Share&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">LoadingScreen</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">            </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CircularProgressIndicator</span><span class="p">()</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="s">&quot;Loading profile...&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">ErrorScreen</span><span class="p">(</span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">onRetry</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">            </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Error</span><span class="p">,</span>
<span class="w">                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">64.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">error</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Oops!&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">headlineMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">message</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span><span class="p">,</span>
<span class="w">                </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Button</span><span class="p">(</span>
<span class="w">                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onRetry</span><span class="p">,</span>
<span class="w">                </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Refresh</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Retry&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getSocialIconWithColor</span><span class="p">(</span><span class="n">linkType</span><span class="p">:</span><span class="w"> </span><span class="n">LinkType</span><span class="p">):</span><span class="w"> </span><span class="n">Pair</span><span class="o">&lt;</span><span class="n">ImageVector</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">linkType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">LINKEDIN</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Work</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF0A66C2</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">WHATSAPP</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Phone</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF25D366</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">SPOTIFY</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">MusicNote</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF1DB954</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">SNAPCHAT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Camera</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFFFC00</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">INSTAGRAM</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">CameraAlt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFE4405F</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">REDDIT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Forum</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFF4500</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">SOUND_CLOUD</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Cloud</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFF5500</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">PINTEREST</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">PushPin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFE60023</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">GITHUB</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Code</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF181717</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">TWITTER</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Tag</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF1DA1F2</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">GMAIL</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Email</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFEA4335</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">BEHANCE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Palette</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF1769FF</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">YOUTUBE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">PlayArrow</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFF0000</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">TIKTOK</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">MusicNote</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF000000</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">ANIME</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Theaters</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFF6B9D</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">FACEBOOK</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">ThumbUp</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF1877F2</span><span class="p">)</span>
<span class="w">        </span><span class="n">LinkType</span><span class="p">.</span><span class="na">OTHER</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Link</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF6B7280</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_ui_SourcesScreen.kt'>commonMain\kotlin\me\onvo\onvo\presentation\ui\SourcesScreen.kt</h2><div class="highlight"><pre><span></span><span class="c1">// presentation/ui/SourcesScreen.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.background</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.LazyColumn</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.items</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.RoundedCornerShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.collectAsState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.getValue</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.font.FontWeight</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.Source</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.SourceState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.SourcesUiState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel.SourcesViewModel</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">SourcesScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SourcesViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">uiState</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">uiState</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span>
<span class="w">                </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Sources&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TopAppBarDefaults</span><span class="p">.</span><span class="na">topAppBarColors</span><span class="p">(</span>
<span class="w">                    </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primaryContainer</span><span class="p">,</span>
<span class="w">                    </span><span class="n">titleContentColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimaryContainer</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">paddingValues</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">Box</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">paddingValues</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uiState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">LoadingContent</span><span class="p">()</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">sources</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">EmptyContent</span><span class="p">()</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">SourcesList</span><span class="p">(</span><span class="n">sources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">sources</span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">ErrorContent</span><span class="p">(</span>
<span class="w">                        </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">message</span><span class="p">,</span>
<span class="w">                        </span><span class="n">onRetry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">retry</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">LoadingContent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">            </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CircularProgressIndicator</span><span class="p">()</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Loading sources...&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">EmptyContent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;No sources available&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyLarge</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">ErrorContent</span><span class="p">(</span>
<span class="w">    </span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onRetry</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">            </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Error&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">headlineSmall</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">error</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">message</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Button</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onRetry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Retry&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SourcesList</span><span class="p">(</span><span class="n">sources</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Source</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">LazyColumn</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">contentPadding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PaddingValues</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">items</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">SourceItem</span><span class="p">(</span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SourceItem</span><span class="p">(</span><span class="n">source</span><span class="p">:</span><span class="w"> </span><span class="n">Source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Card</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">elevation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CardDefaults</span><span class="p">.</span><span class="na">cardElevation</span><span class="p">(</span><span class="n">defaultElevation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">        </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">            </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">spacedBy</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Header with name and state</span>
<span class="w">            </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">SpaceBetween</span><span class="p">,</span>
<span class="w">                </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">name</span><span class="p">,</span>
<span class="w">                    </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleLarge</span><span class="p">,</span>
<span class="w">                    </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="n">SourceStateChip</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">state</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// API info</span>
<span class="w">            </span><span class="n">InfoRow</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;API&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">api</span><span class="p">)</span>

<span class="w">            </span><span class="c1">// Base URL</span>
<span class="w">            </span><span class="n">InfoRow</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Base URL&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">baseUrl</span><span class="p">)</span>

<span class="w">            </span><span class="c1">// Version info</span>
<span class="w">            </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">SpaceBetween</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">InfoRow</span><span class="p">(</span>
<span class="w">                    </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Version&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">baseVersion</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="n">InfoRow</span><span class="p">(</span>
<span class="w">                    </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Image Ver.&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">imageUrlVersion</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Image Base URL</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">source</span><span class="p">.</span><span class="na">imageBaseUrl</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">InfoRow</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Image URL&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="p">.</span><span class="na">imageBaseUrl</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Delete flag</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">source</span><span class="p">.</span><span class="na">shouldDelete</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Ã¢Å¡Â Ã¯Â¸ Marked for deletion&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodySmall</span><span class="p">,</span>
<span class="w">                    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">error</span><span class="p">,</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span>
<span class="w">                            </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">errorContainer</span><span class="p">,</span>
<span class="w">                            </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">4.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">InfoRow</span><span class="p">(</span>
<span class="w">    </span><span class="n">label</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Column</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">labelSmall</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurfaceVariant</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">bodyMedium</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SourceStateChip</span><span class="p">(</span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="n">SourceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="p">(</span><span class="nv">color</span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SourceState</span><span class="p">.</span><span class="na">WORKING</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;Working&quot;</span>
<span class="w">        </span><span class="n">SourceState</span><span class="p">.</span><span class="na">UNDER_MAINTENANCE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">tertiary</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;Maintenance&quot;</span>
<span class="w">        </span><span class="n">SourceState</span><span class="p">.</span><span class="na">STOPPED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">error</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;Stopped&quot;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">Surface</span><span class="p">(</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2f</span><span class="p">),</span>
<span class="w">        </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">text</span><span class="p">,</span>
<span class="w">            </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">labelMedium</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color</span><span class="p">,</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">horizontal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">vertical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_viewmodel_AuthViewModel.kt'>commonMain\kotlin\me\onvo\onvo\presentation\viewmodel\AuthViewModel.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewModelScope</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.MutableStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.StateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.asStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.launch</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthUserData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.auth.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.profile.GetCurrentUserStatusUseCase</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.AuthUiState</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">AuthViewModel</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">getTokenUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">GetTokenUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">checkInputUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">CheckInputUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">loginUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">LoginUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">logoutUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">LogoutUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">getUserSessionUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">GetUserSessionUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">getCurrentUserStatusUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">GetCurrentUserStatusUseCase</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_uiState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="o">&lt;</span><span class="n">AuthUiState</span><span class="o">&gt;</span><span class="p">(</span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">uiState</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">AuthUiState</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_uiState</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_authState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="n">AuthState</span><span class="p">())</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">authState</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">AuthState</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_authState</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_isLoggedIn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isLoggedIn</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_isInitialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isInitialized</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_isInitialized</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Store current user data for navigation bar</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_currentUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="o">&lt;</span><span class="n">AuthUserData?&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentUser</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">AuthUserData?&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_currentUser</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">initializeAuth</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">initializeAuth</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span>

<span class="w">            </span><span class="c1">// First, check if we have an existing valid session</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">existingSession</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUserSessionUseCase</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">existingSession</span><span class="p">.</span><span class="na">isAuthenticated</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">existingSession</span><span class="p">.</span><span class="na">authToken</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// We have a token, verify it with the server</span>
<span class="w">                </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">statusResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCurrentUserStatusUseCase</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// Valid session confirmed by server</span>
<span class="w">                        </span><span class="n">_currentUser</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">statusResult</span><span class="p">.</span><span class="na">data</span>
<span class="w">                        </span><span class="n">_authState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthState</span><span class="p">(</span>
<span class="w">                            </span><span class="n">isAuthenticated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                            </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">statusResult</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span>
<span class="w">                            </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">statusResult</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">username</span><span class="p">,</span>
<span class="w">                            </span><span class="n">authToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">existingSession</span><span class="p">.</span><span class="na">authToken</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                        </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Initial</span>
<span class="w">                        </span><span class="n">_isInitialized</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// Token is invalid or session expired</span>
<span class="w">                        </span><span class="c1">// The repository already cleared the session</span>
<span class="w">                        </span><span class="n">_currentUser</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                        </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>

<span class="w">                        </span><span class="c1">// Get a new token for login</span>
<span class="w">                        </span><span class="n">getNewToken</span><span class="p">()</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// No valid session, get a new token</span>
<span class="w">                </span><span class="n">getNewToken</span><span class="p">()</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getNewToken</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">tokenResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getTokenUseCase</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Initial</span>
<span class="w">                </span><span class="n">_isInitialized</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;Failed to initialize. Please check your internet connection and restart the app.&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="n">_isInitialized</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">checkInput</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">isBlank</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">&quot;Please enter your username, email, or phone number&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span>

<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">checkInputUseCase</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">trim</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">data</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">CheckInputSuccess</span><span class="p">(</span>
<span class="w">                            </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span>
<span class="w">                            </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">username</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;user&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">imageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">image</span><span class="p">,</span>
<span class="w">                            </span><span class="n">fullName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">fullname</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                            </span><span class="n">data</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;User not found&quot;</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                        </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to verify input. Please try again.&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="na">isBlank</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">&quot;Please enter your password&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span>

<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loginUseCase</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">data</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">data</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="kd">val</span><span class="w"> </span><span class="nv">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">username</span>

<span class="w">                        </span><span class="c1">// Get fresh user status after login</span>
<span class="w">                        </span><span class="n">refreshUserStatus</span><span class="p">()</span>

<span class="w">                        </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                        </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">LoginSuccess</span><span class="p">(</span><span class="n">userName</span><span class="p">)</span>

<span class="w">                        </span><span class="c1">// Update auth state</span>
<span class="w">                        </span><span class="kd">val</span><span class="w"> </span><span class="nv">session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUserSessionUseCase</span><span class="p">()</span>
<span class="w">                        </span><span class="n">_authState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">session</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                            </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Login failed. Please check your credentials.&quot;</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                        </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Login failed. Please try again.&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">logout</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">logoutUseCase</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">                    </span><span class="n">_authState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthState</span><span class="p">()</span>
<span class="w">                    </span><span class="n">_currentUser</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Initial</span>

<span class="w">                    </span><span class="c1">// Get a new token for next login</span>
<span class="w">                    </span><span class="n">getTokenUseCase</span><span class="p">()</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// Still clear local state even if API fails</span>
<span class="w">                    </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">                    </span><span class="n">_authState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthState</span><span class="p">()</span>
<span class="w">                    </span><span class="n">_currentUser</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Initial</span>

<span class="w">                    </span><span class="c1">// Get a new token for next login</span>
<span class="w">                    </span><span class="n">getTokenUseCase</span><span class="p">()</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Refresh session state and user data</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">refreshSession</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">refreshUserStatus</span><span class="p">()</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUserSessionUseCase</span><span class="p">()</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">session</span><span class="p">.</span><span class="na">isAuthenticated</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_authState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">session</span>
<span class="w">                </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">LoginSuccess</span><span class="p">(</span><span class="n">session</span><span class="p">.</span><span class="na">userName</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;User&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Refresh current user status from server</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">refreshUserStatus</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCurrentUserStatusUseCase</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_currentUser</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">data</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// If unauthorized, logout</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="o">?.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;expired&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ignoreCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="o">||</span>
<span class="w">                    </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="o">?.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;unauthorized&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ignoreCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">logout</span><span class="p">()</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">resetUiState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthUiState</span><span class="p">.</span><span class="na">Initial</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">retry</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">initializeAuth</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_viewmodel_PasswordResetViewModel.kt'>commonMain\kotlin\me\onvo\onvo\presentation\viewmodel\PasswordResetViewModel.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/presentation/viewmodel/PasswordResetViewModel.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewModelScope</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.MutableStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.StateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.asStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.launch</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.PasswordResetUiState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.repository.AuthRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.auth.CheckInputUseCase</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.passwordreset.*</span>

<span class="c1">// Enhanced UI State with explicit step tracking</span>
<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetStep</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">EnterUserId</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">EnterCode</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">EnterNewPassword</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Success</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">isFromSettings</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetState</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentStep</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterUserId</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isLoading</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">errorType</span><span class="p">:</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">.</span><span class="na">ErrorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">.</span><span class="na">ErrorType</span><span class="p">.</span><span class="na">GENERAL</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isFromSettings</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="p">)</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">PasswordResetViewModel</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">checkInputUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">CheckInputUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">requestResetCodeUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">RequestResetCodeUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">submitResetCodeUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">SubmitResetCodeUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">changePasswordUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">ChangePasswordUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">authRepository</span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="n">PasswordResetState</span><span class="p">())</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">PasswordResetState</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_isLoggedIn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isLoggedIn</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Initialize from settings with known user ID</span>
<span class="cm">     * User is already logged in, just changing password</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">initializeFromSettings</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                </span><span class="n">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">),</span>
<span class="w">                </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                </span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span><span class="c1">// Mark as settings flow</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">requestResetCodeUseCase</span><span class="p">(</span><span class="n">userId</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">data</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">error</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;email_not_found&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                            </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;This account does not have a recovery email.&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">.</span><span class="na">ErrorType</span><span class="p">.</span><span class="na">NO_EMAIL</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                            </span><span class="n">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="p">(</span>
<span class="w">                                </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span>
<span class="w">                                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span>
<span class="w">                            </span><span class="p">),</span>
<span class="w">                            </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                            </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to send reset code&quot;</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                        </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to send reset code. Please try again.&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Step 1: Check user input and request code</span>
<span class="cm">     * This is for forgot password flow (user not logged in)</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">requestCodeByInput</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">isBlank</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Please enter your username, email, or phone number&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">.</span><span class="na">ErrorType</span><span class="p">.</span><span class="na">GENERAL</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                </span><span class="n">isFromSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">  </span><span class="c1">// Mark as forgot password flow</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1">// First, check the input to get user ID</span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">checkResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">checkInputUseCase</span><span class="p">(</span><span class="n">input</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">checkResult</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span>
<span class="w">                    </span><span class="c1">// Now request the reset code</span>
<span class="w">                    </span><span class="n">requestCode</span><span class="p">(</span><span class="n">userId</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                        </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">checkResult</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;User not found. Please check your input.&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">.</span><span class="na">ErrorType</span><span class="p">.</span><span class="na">USER_NOT_FOUND</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Request reset code with user ID</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">requestCode</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">requestResetCodeUseCase</span><span class="p">(</span><span class="n">userId</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">data</span>
<span class="w">                </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">response</span><span class="p">.</span><span class="na">error</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;email_not_found&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                            </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;This account does not have a recovery email.&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">.</span><span class="na">ErrorType</span><span class="p">.</span><span class="na">NO_EMAIL</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="n">response</span><span class="p">.</span><span class="na">isSuccess</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// Successfully sent code - move to next step</span>
<span class="w">                        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                            </span><span class="n">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="p">(</span>
<span class="w">                                </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span>
<span class="w">                                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span>
<span class="w">                            </span><span class="p">),</span>
<span class="w">                            </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                            </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                            </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to send reset code&quot;</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                    </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to send reset code. Please try again.&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Step 2: Submit verification code</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">submitCode</span><span class="p">(</span><span class="n">code</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">currentStep</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentStep</span><span class="w"> </span><span class="k">!is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Please enter a valid 6-digit code&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">.</span><span class="na">ErrorType</span><span class="p">.</span><span class="na">INVALID_CODE</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>

<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">submitResetCodeUseCase</span><span class="p">(</span><span class="n">code</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// Code verified - move to password entry</span>
<span class="w">                    </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                        </span><span class="n">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterNewPassword</span><span class="p">(</span><span class="n">currentStep</span><span class="p">.</span><span class="na">userId</span><span class="p">),</span>
<span class="w">                        </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// Stay on code step but show error</span>
<span class="w">                    </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                        </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Invalid code. Please try again.&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetUiState</span><span class="p">.</span><span class="na">ErrorType</span><span class="p">.</span><span class="na">INVALID_CODE</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Step 3: Change password</span>
<span class="cm">     * Behavior differs based on isFromSettings:</span>
<span class="cm">     * - Forgot Password: Auto-login after success</span>
<span class="cm">     * - Change Password: Stay logged in</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">changePassword</span><span class="p">(</span><span class="n">newPassword</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">confirmPassword</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">newPassword</span><span class="p">.</span><span class="na">isBlank</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Please enter a new password&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">newPassword</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Password must be at least 6 characters&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">newPassword</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">confirmPassword</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Passwords do not match&quot;</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>

<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">changePasswordUseCase</span><span class="p">(</span><span class="n">newPassword</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">.</span><span class="na">data</span><span class="o">?.</span><span class="na">username</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;User&quot;</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isFromSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">isFromSettings</span>

<span class="w">                    </span><span class="c1">// If from forgot password flow, the user is now logged in</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isFromSettings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                    </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                        </span><span class="n">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">userName</span><span class="p">,</span><span class="w"> </span><span class="n">isFromSettings</span><span class="p">),</span>
<span class="w">                        </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// Stay on password step but show error</span>
<span class="w">                    </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                        </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to change password. Please try again.&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Resend code (from code entry step)</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">resendCode</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">currentStep</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentStep</span><span class="w"> </span><span class="k">!is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>

<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="n">requestCode</span><span class="p">(</span><span class="n">currentStep</span><span class="p">.</span><span class="na">userId</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Go back to previous step</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">goBack</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">currentStep</span>
<span class="w">        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">currentStep</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                    </span><span class="n">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterUserId</span><span class="p">,</span>
<span class="w">                    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterNewPassword</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span>
<span class="w">                    </span><span class="n">currentStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetStep</span><span class="p">.</span><span class="na">EnterCode</span><span class="p">(</span><span class="n">currentStep</span><span class="p">.</span><span class="na">userId</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">),</span>
<span class="w">                    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Clear error</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">clearError</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Reset to initial state</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">reset</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PasswordResetState</span><span class="p">()</span>
<span class="w">        </span><span class="n">_isLoggedIn</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_viewmodel_ProfileViewModel.kt'>commonMain\kotlin\me\onvo\onvo\presentation\viewmodel\ProfileViewModel.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel</span>


<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewModelScope</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.MutableStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.StateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.asStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.launch</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util.State</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.ProfileUiState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.AuthStatusUiState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.profile.GetCurrentUserStatusUseCase</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.profile.GetUserProfileUseCase</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ProfileViewModel</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">getCurrentUserStatusUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">GetCurrentUserStatusUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">getUserProfileUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">GetUserProfileUseCase</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_currentUserState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="o">&lt;</span><span class="n">AuthStatusUiState</span><span class="o">&gt;</span><span class="p">(</span><span class="n">AuthStatusUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentUserState</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">AuthStatusUiState</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_currentUserState</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_profileState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="o">&lt;</span><span class="n">ProfileUiState</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">profileState</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">ProfileUiState</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_profileState</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_isRefreshing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isRefreshing</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_isRefreshing</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">loadCurrentUserStatus</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">loadCurrentUserStatus</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_currentUserState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">.</span><span class="na">Loading</span>

<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCurrentUserStatusUseCase</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_currentUserState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_currentUserState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                        </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to load user status&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_currentUserState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AuthStatusUiState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">loadUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_profileState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Loading</span>

<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUserProfileUseCase</span><span class="p">(</span><span class="n">userId</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_profileState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_profileState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                        </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to load profile&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_profileState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">refreshProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_isRefreshing</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>

<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUserProfileUseCase</span><span class="p">(</span><span class="n">userId</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_profileState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">data</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_profileState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProfileUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                        </span><span class="n">result</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Failed to refresh profile&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">_isRefreshing</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">retry</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">userId</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">userId</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">loadCurrentUserStatus</span><span class="p">()</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_presentation_viewmodel_SourcesViewModel.kt'>commonMain\kotlin\me\onvo\onvo\presentation\viewmodel\SourcesViewModel.kt</h2><div class="highlight"><pre><span></span><span class="c1">// presentation/viewmodel/SourcesViewModel.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.viewmodel</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewModelScope</span>
<span class="c1">//import dev.zacsweers.metro.AppScope</span>
<span class="c1">//import dev.zacsweers.metro.Inject</span>
<span class="c1">//import dev.zacsweers.metro.SingleIn</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.MutableStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.StateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.asStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.launch</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.Source</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.usecase.GetSourcesUseCase</span>

<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">SourcesUiState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Loading</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Success</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">sources</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Source</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">//@Inject</span>
<span class="c1">//@SingleIn(AppScope::class)</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">SourcesViewModel</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">getSourcesUseCase</span><span class="p">:</span><span class="w"> </span><span class="n">GetSourcesUseCase</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_uiState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="o">&lt;</span><span class="n">SourcesUiState</span><span class="o">&gt;</span><span class="p">(</span><span class="n">SourcesUiState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">uiState</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">SourcesUiState</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_uiState</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">loadSources</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">loadSources</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">            </span><span class="n">getSourcesUseCase</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">onSuccess</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sources</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="p">.</span><span class="na">onFailure</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SourcesUiState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span>
<span class="w">                        </span><span class="n">error</span><span class="p">.</span><span class="na">message</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown error occurred&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">retry</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">loadSources</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_test_screens.kt'>commonMain\kotlin\me\onvo\onvo\test\screens.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/test/screens.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.test</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.clickable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.LazyColumn</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.items</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.automirrored.filled.ArrowBack</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.presentation.ui.ProfileScreen</span>

<span class="c1">// Home Screen</span>
<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">HomeScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">onUserClick</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Home&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">LazyColumn</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">items</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">PostCard</span><span class="p">(</span>
<span class="w">                    </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;user_</span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;User </span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;This is post content from user </span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onUserClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onUserClick</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Search Screen</span>
<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">SearchScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">onUserClick</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">searchQuery</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Search&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">                </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">searchQuery</span><span class="p">,</span>
<span class="w">                </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">searchQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Search users...&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                    </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">LazyColumn</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">items</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">UserListItem</span><span class="p">(</span>
<span class="w">                        </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;search_user_</span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Search User </span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onUserClick</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Discovery Screen</span>
<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">DiscoveryScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">onUserClick</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Discovery&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">LazyColumn</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">items</span><span class="p">(</span><span class="m">8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">PostCard</span><span class="p">(</span>
<span class="w">                    </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;discovery_user_</span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Discovery User </span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Trending post content </span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onUserClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onUserClick</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// User Profile Screen (Other Users) - Now uses real ProfileScreen</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">UserProfileScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onBackClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Convert string userId to Int</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">userIdInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userId</span><span class="p">.</span><span class="na">removePrefix</span><span class="p">(</span><span class="s">&quot;user_&quot;</span><span class="p">).</span><span class="na">toIntOrNull</span><span class="p">()</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="m">1452</span>

<span class="w">    </span><span class="n">ProfileScreen</span><span class="p">(</span>
<span class="w">        </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userIdInt</span><span class="p">,</span>
<span class="w">        </span><span class="n">onBackClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onBackClick</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Settings Detail Screen</span>
<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">SettingsDetailScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">settingType</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onBackClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span>
<span class="w">                </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">settingType</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">navigationIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">IconButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onBackClick</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">AutoMirrored</span><span class="p">.</span><span class="na">Filled</span><span class="p">.</span><span class="na">ArrowBack</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Back&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Settings for: </span><span class="si">$</span><span class="n">settingType</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Configure your </span><span class="si">$</span><span class="n">settingType</span><span class="s"> settings here&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Create Post Screen</span>
<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">CreatePostScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">onPostCreated</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onBackClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">postContent</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span>
<span class="w">                </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Create Post&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">navigationIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">IconButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onBackClick</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="na">AutoMirrored</span><span class="p">.</span><span class="na">Filled</span><span class="p">.</span><span class="na">ArrowBack</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Back&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">                </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">postContent</span><span class="p">,</span>
<span class="w">                </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">postContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;What&#39;s on your mind?&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                    </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">200.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Button</span><span class="p">(</span>
<span class="w">                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onPostCreated</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Post&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Helper Composables</span>
<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">PostCard</span><span class="p">(</span>
<span class="w">    </span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">content</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onUserClick</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Card</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userName</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">clickable</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">onUserClick</span><span class="p">(</span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">content</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">UserListItem</span><span class="p">(</span>
<span class="w">    </span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">userName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onClick</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ListItem</span><span class="p">(</span>
<span class="w">        </span><span class="n">headlineContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">userName</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">clickable</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">onClick</span><span class="p">(</span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SettingItem</span><span class="p">(</span>
<span class="w">    </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ListItem</span><span class="p">(</span>
<span class="w">        </span><span class="n">headlineContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">clickable</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onClick</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_test_SettingsScreen.kt'>commonMain\kotlin\me\onvo\onvo\test\SettingsScreen.kt</h2><div class="highlight"><pre><span></span><span class="c1">// File: commonMain/kotlin/me/onvo/onvo/test/SettingsScreen.kt</span>
<span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.test</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.Image</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.clickable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.LazyColumn</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.items</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.filled.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">co.touchlab.kermit.Logger</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeMode</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.ThemeViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">onvo.composeapp.generated.resources.Res</span>
<span class="k">import</span><span class="w"> </span><span class="nn">onvo.composeapp.generated.resources.compose_multiplatform</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.jetbrains.compose.resources.painterResource</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">SettingsScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">themeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">ThemeViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSettingClick</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onLogout</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onChangePassword</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">currentTheme</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">.</span><span class="na">themeMode</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">showThemeDialog</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Logger</span><span class="p">.</span><span class="na">a</span><span class="p">(</span><span class="s">&quot;SettingsScreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;hi loggg 111111&quot;</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Settings&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">LazyColumn</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Image</span><span class="p">(</span><span class="n">painterResource</span><span class="p">(</span><span class="n">Res</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">compose_multiplatform</span><span class="p">),</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Theme Setting</span>
<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">ThemeSettingItem</span><span class="p">(</span>
<span class="w">                    </span><span class="n">currentTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentTheme</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">showThemeDialog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">HorizontalDivider</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">vertical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Security Section</span>
<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">SectionHeader</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Security&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">SettingItemWithIcon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Change Password&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Lock</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onChangePassword</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">HorizontalDivider</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">vertical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// General Settings Section</span>
<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">SectionHeader</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;General&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">items</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="s">&quot;Account&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Privacy&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Notifications&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Appearance&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Help&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">SettingItem</span><span class="p">(</span>
<span class="w">                    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">setting</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">onSettingClick</span><span class="p">(</span><span class="n">setting</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">HorizontalDivider</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">vertical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">SettingItemWithIcon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Logout&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">ExitToApp</span><span class="p">,</span>
<span class="w">                    </span><span class="n">textColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">error</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onLogout</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showThemeDialog</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ThemeSelectionDialog</span><span class="p">(</span>
<span class="w">            </span><span class="n">currentTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentTheme</span><span class="p">,</span>
<span class="w">            </span><span class="n">onThemeSelected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">theme</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">themeViewModel</span><span class="p">.</span><span class="na">setThemeMode</span><span class="p">(</span><span class="n">theme</span><span class="p">)</span>
<span class="w">                </span><span class="n">showThemeDialog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="n">onDismiss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">showThemeDialog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SectionHeader</span><span class="p">(</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">typography</span><span class="p">.</span><span class="na">titleMedium</span><span class="p">,</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">horizontal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">vertical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">ThemeSettingItem</span><span class="p">(</span>
<span class="w">    </span><span class="n">currentTheme</span><span class="p">:</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">,</span>
<span class="w">    </span><span class="n">onClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ListItem</span><span class="p">(</span>
<span class="w">        </span><span class="n">headlineContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Theme&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="n">supportingContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">currentTheme</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">LIGHT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Light&quot;</span>
<span class="w">                    </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">DARK</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Dark&quot;</span>
<span class="w">                    </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">SYSTEM</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;System Default&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">leadingContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">currentTheme</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">LIGHT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">LightMode</span>
<span class="w">                    </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">DARK</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">DarkMode</span>
<span class="w">                    </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">SYSTEM</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Brightness4</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Theme&quot;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">clickable</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onClick</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SettingItemWithIcon</span><span class="p">(</span>
<span class="w">    </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">icon</span><span class="p">:</span><span class="w"> </span><span class="n">androidx</span><span class="p">.</span><span class="na">compose</span><span class="p">.</span><span class="na">ui</span><span class="p">.</span><span class="na">graphics</span><span class="p">.</span><span class="na">vector</span><span class="p">.</span><span class="na">ImageVector</span><span class="p">,</span>
<span class="w">    </span><span class="n">textColor</span><span class="p">:</span><span class="w"> </span><span class="n">androidx</span><span class="p">.</span><span class="na">compose</span><span class="p">.</span><span class="na">ui</span><span class="p">.</span><span class="na">graphics</span><span class="p">.</span><span class="na">Color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onSurface</span><span class="p">,</span>
<span class="w">    </span><span class="n">onClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ListItem</span><span class="p">(</span>
<span class="w">        </span><span class="n">headlineContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textColor</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">leadingContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icon</span><span class="p">,</span>
<span class="w">                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">                </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textColor</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">clickable</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onClick</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">ThemeSelectionDialog</span><span class="p">(</span>
<span class="w">    </span><span class="n">currentTheme</span><span class="p">:</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">,</span>
<span class="w">    </span><span class="n">onThemeSelected</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">ThemeMode</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onDismiss</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">AlertDialog</span><span class="p">(</span>
<span class="w">        </span><span class="n">onDismissRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onDismiss</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Select Theme&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Column</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">entries</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                            </span><span class="p">.</span><span class="na">clickable</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">onThemeSelected</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">vertical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                        </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">RadioButton</span><span class="p">(</span>
<span class="w">                            </span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentTheme</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span>
<span class="w">                            </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">onThemeSelected</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">mode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">LIGHT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Light&quot;</span>
<span class="w">                                </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">DARK</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Dark&quot;</span>
<span class="w">                                </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">SYSTEM</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;System Default&quot;</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">confirmButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TextButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onDismiss</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Close&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">SettingItem</span><span class="p">(</span>
<span class="w">    </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onClick</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ListItem</span><span class="p">(</span>
<span class="w">        </span><span class="n">headlineContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">clickable</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onClick</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_theme_splash_screen_shouldShowSplash.kt'>commonMain\kotlin\me\onvo\onvo\theme\splash_screen\shouldShowSplash.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.splash_screen</span>

<span class="kd">expect</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">shouldShowSplash</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_theme_splash_screen_SplashScreen.kt'>commonMain\kotlin\me\onvo\onvo\theme\splash_screen\SplashScreen.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.splash_screen</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.animation.core.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.Image</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.background</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.MaterialTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Text</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.draw.alpha</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.draw.scale</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.font.FontWeight</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.sp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.delay</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.jetbrains.compose.resources.painterResource</span>
<span class="k">import</span><span class="w"> </span><span class="nn">onvo.composeapp.generated.resources.Res</span>
<span class="k">import</span><span class="w"> </span><span class="nn">onvo.composeapp.generated.resources.compose_multiplatform</span>

<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">SplashScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">onSplashFinished</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">startAnimation</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Scale animation</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">scale</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">animateFloatAsState</span><span class="p">(</span>
<span class="w">        </span><span class="n">targetValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">startAnimation</span><span class="p">)</span><span class="w"> </span><span class="m">1f</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="m">0.5f</span><span class="p">,</span>
<span class="w">        </span><span class="n">animationSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tween</span><span class="p">(</span>
<span class="w">            </span><span class="n">durationMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">800</span><span class="p">,</span>
<span class="w">            </span><span class="n">easing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FastOutSlowInEasing</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Alpha animation</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">alpha</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">animateFloatAsState</span><span class="p">(</span>
<span class="w">        </span><span class="n">targetValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">startAnimation</span><span class="p">)</span><span class="w"> </span><span class="m">1f</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="m">0f</span><span class="p">,</span>
<span class="w">        </span><span class="n">animationSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tween</span><span class="p">(</span>
<span class="w">            </span><span class="n">durationMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">800</span><span class="p">,</span>
<span class="w">            </span><span class="n">easing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FastOutSlowInEasing</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="n">LaunchedEffect</span><span class="p">(</span><span class="kt">Unit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">startAnimation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="n">delay</span><span class="p">(</span><span class="m">2500</span><span class="p">)</span><span class="w"> </span><span class="c1">// Show splash for 2.5 seconds</span>
<span class="w">        </span><span class="n">onSplashFinished</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">Box</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">),</span>
<span class="w">        </span><span class="n">contentAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">            </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">scale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// App Logo</span>
<span class="w">            </span><span class="n">Image</span><span class="p">(</span>
<span class="w">                </span><span class="n">painter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">painterResource</span><span class="p">(</span><span class="n">Res</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">compose_multiplatform</span><span class="p">),</span>
<span class="w">                </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;App Logo&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                    </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">120.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">            </span><span class="c1">// App Name</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ONVO&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">42.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimary</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">            </span><span class="c1">// Tagline</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Your Multiplatform Experience&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimary</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8f</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_theme_ThemeManager.kt'>commonMain\kotlin\me\onvo\onvo\theme\ThemeManager.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme</span>

<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.MutableStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.StateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.asStateFlow</span>

<span class="kd">enum</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">ThemeMode</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">LIGHT</span><span class="p">,</span>
<span class="w">    </span><span class="n">DARK</span><span class="p">,</span>
<span class="w">    </span><span class="n">SYSTEM</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ThemeManager</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_themeMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">SYSTEM</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">themeMode</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">ThemeMode</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_themeMode</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setThemeMode</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_themeMode</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">toggleTheme</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_themeMode</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">_themeMode</span><span class="p">.</span><span class="na">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">LIGHT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">DARK</span>
<span class="w">            </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">DARK</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">LIGHT</span>
<span class="w">            </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">SYSTEM</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">LIGHT</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_theme_Themes.kt'>commonMain\kotlin\me\onvo\onvo\theme\Themes.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme</span>


<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.isSystemInDarkTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.MaterialTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.darkColorScheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.lightColorScheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.Color</span>

<span class="c1">// Light Theme Colors</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightPrimary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF6200EE</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnPrimary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFFFFFF</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightPrimaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFBB86FC</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnPrimaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF3700B3</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightSecondary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF03DAC6</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnSecondary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF000000</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightSecondaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF018786</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnSecondaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFFFFFF</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightTertiary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF03DAC6</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnTertiary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF000000</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFB00020</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFFFFFF</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightBackground</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFFFBFE</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnBackground</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF1C1B1F</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightSurface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFFFBFE</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnSurface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF1C1B1F</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightSurfaceVariant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFE7E0EC</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightOnSurfaceVariant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF49454F</span><span class="p">)</span>

<span class="c1">// Dark Theme Colors</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkPrimary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFBB86FC</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnPrimary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF3700B3</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkPrimaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF6200EE</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnPrimaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFFFFFF</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkSecondary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF03DAC6</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnSecondary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF000000</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkSecondaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF018786</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnSecondaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFFFFFFF</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkTertiary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF03DAC6</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnTertiary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF000000</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFCF6679</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF000000</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkBackground</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF1C1B1F</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnBackground</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFE6E1E5</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkSurface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF1C1B1F</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnSurface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFE6E1E5</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkSurfaceVariant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFF49454F</span><span class="p">)</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkOnSurfaceVariant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="m">0</span><span class="n">xFFCAC4D0</span><span class="p">)</span>

<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">LightColorScheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lightColorScheme</span><span class="p">(</span>
<span class="w">    </span><span class="n">primary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightPrimary</span><span class="p">,</span>
<span class="w">    </span><span class="n">onPrimary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnPrimary</span><span class="p">,</span>
<span class="w">    </span><span class="n">primaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightPrimaryContainer</span><span class="p">,</span>
<span class="w">    </span><span class="n">onPrimaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnPrimaryContainer</span><span class="p">,</span>
<span class="w">    </span><span class="n">secondary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightSecondary</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSecondary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnSecondary</span><span class="p">,</span>
<span class="w">    </span><span class="n">secondaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightSecondaryContainer</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSecondaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnSecondaryContainer</span><span class="p">,</span>
<span class="w">    </span><span class="n">tertiary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightTertiary</span><span class="p">,</span>
<span class="w">    </span><span class="n">onTertiary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnTertiary</span><span class="p">,</span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightError</span><span class="p">,</span>
<span class="w">    </span><span class="n">onError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnError</span><span class="p">,</span>
<span class="w">    </span><span class="n">background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightBackground</span><span class="p">,</span>
<span class="w">    </span><span class="n">onBackground</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnBackground</span><span class="p">,</span>
<span class="w">    </span><span class="n">surface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightSurface</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSurface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnSurface</span><span class="p">,</span>
<span class="w">    </span><span class="n">surfaceVariant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightSurfaceVariant</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSurfaceVariant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LightOnSurfaceVariant</span>
<span class="p">)</span>

<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">DarkColorScheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">darkColorScheme</span><span class="p">(</span>
<span class="w">    </span><span class="n">primary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkPrimary</span><span class="p">,</span>
<span class="w">    </span><span class="n">onPrimary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnPrimary</span><span class="p">,</span>
<span class="w">    </span><span class="n">primaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkPrimaryContainer</span><span class="p">,</span>
<span class="w">    </span><span class="n">onPrimaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnPrimaryContainer</span><span class="p">,</span>
<span class="w">    </span><span class="n">secondary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkSecondary</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSecondary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnSecondary</span><span class="p">,</span>
<span class="w">    </span><span class="n">secondaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkSecondaryContainer</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSecondaryContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnSecondaryContainer</span><span class="p">,</span>
<span class="w">    </span><span class="n">tertiary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkTertiary</span><span class="p">,</span>
<span class="w">    </span><span class="n">onTertiary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnTertiary</span><span class="p">,</span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkError</span><span class="p">,</span>
<span class="w">    </span><span class="n">onError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnError</span><span class="p">,</span>
<span class="w">    </span><span class="n">background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkBackground</span><span class="p">,</span>
<span class="w">    </span><span class="n">onBackground</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnBackground</span><span class="p">,</span>
<span class="w">    </span><span class="n">surface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkSurface</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSurface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnSurface</span><span class="p">,</span>
<span class="w">    </span><span class="n">surfaceVariant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkSurfaceVariant</span><span class="p">,</span>
<span class="w">    </span><span class="n">onSurfaceVariant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkOnSurfaceVariant</span>
<span class="p">)</span>

<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">AppTheme</span><span class="p">(</span>
<span class="w">    </span><span class="n">darkTheme</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isSystemInDarkTheme</span><span class="p">(),</span>
<span class="w">    </span><span class="n">content</span><span class="p">:</span><span class="w"> </span><span class="nd">@Composable</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">colorScheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">darkTheme</span><span class="p">)</span><span class="w"> </span><span class="n">DarkColorScheme</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">LightColorScheme</span>

<span class="w">    </span><span class="n">MaterialTheme</span><span class="p">(</span>
<span class="w">        </span><span class="n">colorScheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colorScheme</span><span class="p">,</span>
<span class="w">        </span><span class="n">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">content</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
<h2 id='commonMain_kotlin_me_onvo_onvo_theme_ThemeViewModel.kt'>commonMain\kotlin\me\onvo\onvo\theme\ThemeViewModel.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme</span>


<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewModelScope</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.MutableStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.StateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.asStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.launch</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore.PreferencesManager</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ThemeViewModel</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">preferencesManager</span><span class="p">:</span><span class="w"> </span><span class="n">PreferencesManager</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_themeMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="n">ThemeMode</span><span class="p">.</span><span class="na">SYSTEM</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">themeMode</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">ThemeMode</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_themeMode</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_isDarkMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isDarkMode</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_isDarkMode</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">loadThemePreferences</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">loadThemePreferences</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">getThemeMode</span><span class="p">().</span><span class="na">collect</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">_themeMode</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">isDarkMode</span><span class="p">().</span><span class="na">collect</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">isDark</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">_isDarkMode</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isDark</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">toggleTheme</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">newDarkMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">_isDarkMode</span><span class="p">.</span><span class="na">value</span>
<span class="w">            </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">setDarkMode</span><span class="p">(</span><span class="n">newDarkMode</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setThemeMode</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">preferencesManager</span><span class="p">.</span><span class="na">setThemeMode</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='iosMain_kotlin_me_onvo_onvo_core_device_DeviceInfoProvider.ios.kt'>iosMain\kotlin\me\onvo\onvo\core\device\DeviceInfoProvider.ios.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.DeviceInfo</span>


<span class="k">import</span><span class="w"> </span><span class="nn">platform.UIKit.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">platform.Foundation.*</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">DeviceInfoProvider</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getDeviceInfo</span><span class="p">():</span><span class="w"> </span><span class="n">DeviceInfo</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UIDevice</span><span class="p">.</span><span class="na">currentDevice</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">DeviceInfo</span><span class="p">(</span>
<span class="w">            </span><span class="n">deviceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="na">identifierForVendor</span><span class="o">?.</span><span class="na">UUIDString</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">brand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Apple&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="na">model</span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">systemName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="na">systemName</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;iOS&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">systemVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="na">systemVersion</span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">appVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAppVersion</span><span class="p">(),</span>
<span class="w">            </span><span class="n">buildNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBuildNumber</span><span class="p">(),</span>
<span class="w">            </span><span class="n">uniqueId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="na">identifierForVendor</span><span class="o">?.</span><span class="na">UUIDString</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">deviceName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">isTablet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="na">userInterfaceIdiom</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">UIUserInterfaceIdiomPad</span><span class="p">,</span>
<span class="w">            </span><span class="n">carrier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCarrier</span><span class="p">(),</span>
<span class="w">            </span><span class="n">timezone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSTimeZone</span><span class="p">.</span><span class="na">localTimeZone</span><span class="p">.</span><span class="na">name</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAppVersion</span><span class="p">():</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">NSBundle</span><span class="p">.</span><span class="na">mainBundle</span><span class="p">.</span><span class="na">infoDictionary</span>
<span class="w">            </span><span class="o">?.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;CFBundleShortVersionString&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;1.0.0&quot;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getBuildNumber</span><span class="p">():</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">NSBundle</span><span class="p">.</span><span class="na">mainBundle</span><span class="p">.</span><span class="na">infoDictionary</span>
<span class="w">            </span><span class="o">?.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;CFBundleVersion&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getCarrier</span><span class="p">():</span><span class="w"> </span><span class="kt">String?</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// iOS carrier info requires CoreTelephony framework</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='iosMain_kotlin_me_onvo_onvo_core_util_CryptoUtil.ios.kt'>iosMain\kotlin\me\onvo\onvo\core\util\CryptoUtil.ios.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util</span>

<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.cinterop.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">platform.CoreCrypto.CC_MD5</span>
<span class="k">import</span><span class="w"> </span><span class="nn">platform.CoreCrypto.CC_MD5_DIGEST_LENGTH</span>
<span class="k">import</span><span class="w"> </span><span class="nn">platform.Foundation.*</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalForeignApi</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="kd">actual</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">CryptoUtil</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">md5</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Convert input String Ã¢â€ â€™ NSData</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">nsData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">toNSData</span><span class="p">()</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="w">        </span><span class="c1">// Allocate buffer for MD5 result</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">digest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UByteArray</span><span class="p">(</span><span class="n">CC_MD5_DIGEST_LENGTH</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Compute MD5</span>
<span class="w">        </span><span class="n">nsData</span><span class="p">.</span><span class="na">bytes</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">digest</span><span class="p">.</span><span class="na">usePinned</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">pinned</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">CC_MD5</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">nsData</span><span class="p">.</span><span class="na">length</span><span class="p">.</span><span class="na">toUInt</span><span class="p">(),</span><span class="w"> </span><span class="n">pinned</span><span class="p">.</span><span class="na">addressOf</span><span class="p">(</span><span class="m">0</span><span class="p">))</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="w">        </span><span class="c1">// Convert digest bytes to lowercase hex string</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">buildString</span><span class="p">(</span><span class="n">CC_MD5_DIGEST_LENGTH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">digest</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="nb">it</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="m">16</span><span class="p">).</span><span class="na">padStart</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Ã¢Å“â€¦ Helper extension for UTF-8 conversion</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="nf">toNSData</span><span class="p">():</span><span class="w"> </span><span class="n">NSData? </span><span class="o">=</span>
<span class="w">    </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">NSString</span><span class="p">).</span><span class="na">dataUsingEncoding</span><span class="p">(</span><span class="n">NSUTF8StringEncoding</span><span class="p">)</span>
</pre></div>
<h2 id='iosMain_kotlin_me_onvo_onvo_di_platformModule.ios.kt'>iosMain\kotlin\me\onvo\onvo\di\platformModule.ios.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device.DeviceInfoProvider</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>


<span class="kd">actual</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">platformModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">DeviceInfoProvider</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='iosMain_kotlin_me_onvo_onvo_MainViewController.kt'>iosMain\kotlin\me\onvo\onvo\MainViewController.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.window.ComposeUIViewController</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">MainViewController</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ComposeUIViewController</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">App</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
</pre></div>
<h2 id='iosMain_kotlin_me_onvo_onvo_Platform.ios.kt'>iosMain\kotlin\me\onvo\onvo\Platform.ios.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">platform.UIKit.UIDevice</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">IOSPlatform</span><span class="p">:</span><span class="w"> </span><span class="n">Platform</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UIDevice</span><span class="p">.</span><span class="na">currentDevice</span><span class="p">.</span><span class="na">systemName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">UIDevice</span><span class="p">.</span><span class="na">currentDevice</span><span class="p">.</span><span class="na">systemVersion</span>
<span class="p">}</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getPlatform</span><span class="p">():</span><span class="w"> </span><span class="n">Platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IOSPlatform</span><span class="p">()</span>
</pre></div>
<h2 id='iosMain_kotlin_me_onvo_onvo_theme_splash_screen_shouldShowSplash.ios.kt'>iosMain\kotlin\me\onvo\onvo\theme\splash_screen\shouldShowSplash.ios.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.splash_screen</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">shouldShowSplash</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span>
<span class="w">    </span><span class="k">get</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</pre></div>
<h2 id='jvmMain_kotlin_me_onvo_onvo_core_datastore_DataStoreFactory.jvm.kt'>jvmMain\kotlin\me\onvo\onvo\core\datastore\DataStoreFactory.jvm.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore</span>

<span class="c1">// File: composeApp/src/jvmMain/kotlin/me/onvo/onvo/core/datastore/DataStoreFactory.jvm.kt</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.core.DataStore</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.Preferences</span>
<span class="k">import</span><span class="w"> </span><span class="nn">java.io.File</span>
<span class="k">import</span><span class="w"> </span><span class="nn">okio.Path</span>
<span class="k">import</span><span class="w"> </span><span class="nn">okio.Path.Companion.toPath</span>


<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">createPreferencesDataStore</span><span class="p">():</span><span class="w"> </span><span class="n">DataStore</span><span class="o">&lt;</span><span class="n">Preferences</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">androidx</span><span class="p">.</span><span class="na">datastore</span><span class="p">.</span><span class="na">preferences</span><span class="p">.</span><span class="na">core</span><span class="p">.</span><span class="na">PreferenceDataStoreFactory</span><span class="p">.</span><span class="na">createWithPath</span><span class="p">(</span>
<span class="w">            </span><span class="n">produceFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">userHome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;user.home&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">appDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">userHome</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.onvo&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">appDir</span><span class="p">.</span><span class="na">exists</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">appDir</span><span class="p">.</span><span class="na">mkdirs</span><span class="p">()</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="c1">// Return an okio.Path</span>
<span class="w">                </span><span class="p">(</span><span class="n">appDir</span><span class="p">.</span><span class="na">absolutePath</span><span class="p">.</span><span class="na">toPath</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dataStoreFileName</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
<h2 id='jvmMain_kotlin_me_onvo_onvo_core_device_DeviceInfoProvider.jvm.kt'>jvmMain\kotlin\me\onvo\onvo\core\device\DeviceInfoProvider.jvm.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.domain.model.DeviceInfo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">java.net.InetAddress</span>
<span class="k">import</span><span class="w"> </span><span class="nn">java.util.*</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">DeviceInfoProvider</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getDeviceInfo</span><span class="p">():</span><span class="w"> </span><span class="n">DeviceInfo</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">osName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;os.name&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">osVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;os.version&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">hostName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">InetAddress</span><span class="p">.</span><span class="na">getLocalHost</span><span class="p">().</span><span class="na">hostName</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="s">&quot;Desktop&quot;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">DeviceInfo</span><span class="p">(</span>
<span class="w">            </span><span class="n">deviceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hostName</span><span class="p">,</span>
<span class="w">            </span><span class="n">brand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Desktop&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">osName</span><span class="p">,</span>
<span class="w">            </span><span class="n">systemName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">osName</span><span class="p">,</span>
<span class="w">            </span><span class="n">systemVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">osVersion</span><span class="p">,</span>
<span class="w">            </span><span class="n">appVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">buildNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">uniqueId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hostName</span><span class="p">,</span>
<span class="w">            </span><span class="n">deviceName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hostName</span><span class="p">,</span>
<span class="w">            </span><span class="n">isTablet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">            </span><span class="n">carrier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">            </span><span class="n">timezone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TimeZone</span><span class="p">.</span><span class="na">getDefault</span><span class="p">().</span><span class="na">id</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='jvmMain_kotlin_me_onvo_onvo_core_network_HttpClientFactory.jvm.kt'>jvmMain\kotlin\me\onvo\onvo\core\network\HttpClientFactory.jvm.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.HttpClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.engine.cio.CIO</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">HttpClientFactory</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">create</span><span class="p">():</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">(</span><span class="n">CIO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// same plugins</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='jvmMain_kotlin_me_onvo_onvo_core_util_CryptoUtil.jvm.kt'>jvmMain\kotlin\me\onvo\onvo\core\util\CryptoUtil.jvm.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.util</span>


<span class="k">import</span><span class="w"> </span><span class="nn">java.security.MessageDigest</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">CryptoUtil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">md5</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">md</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MessageDigest</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;MD5&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">digest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">md</span><span class="p">.</span><span class="na">digest</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">())</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">digest</span><span class="p">.</span><span class="na">joinToString</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;%02x&quot;</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='jvmMain_kotlin_me_onvo_onvo_di_platformModule.jvm.kt'>jvmMain\kotlin\me\onvo\onvo\di\platformModule.jvm.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.di</span>

<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.device.DeviceInfoProvider</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>


<span class="kd">actual</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">platformModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">DeviceInfoProvider</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id='jvmMain_kotlin_me_onvo_onvo_main.kt'>jvmMain\kotlin\me\onvo\onvo\main.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.window.Window</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.window.application</span>
<span class="k">import</span><span class="w"> </span><span class="nn">me.onvo.onvo.di.initKoin</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">initKoin</span><span class="p">()</span><span class="w"> </span><span class="c1">// start Koin for desktop</span>
<span class="w">     </span><span class="n">application</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Window</span><span class="p">(</span>
<span class="w">        </span><span class="n">onCloseRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">::</span><span class="n">exitApplication</span><span class="p">,</span>
<span class="w">        </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ONVO&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">App</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}}</span>
</pre></div>
<h2 id='jvmMain_kotlin_me_onvo_onvo_Platform.jvm.kt'>jvmMain\kotlin\me\onvo\onvo\Platform.jvm.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">JVMPlatform</span><span class="p">:</span><span class="w"> </span><span class="n">Platform</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Java </span><span class="si">${</span><span class="n">System</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;</span><span class="n">java</span><span class="p">.</span><span class="na">version</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span>
<span class="p">}</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getPlatform</span><span class="p">():</span><span class="w"> </span><span class="n">Platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JVMPlatform</span><span class="p">()</span>
</pre></div>
<h2 id='jvmMain_kotlin_me_onvo_onvo_theme_splash_screen_shouldShowSplash.jvm.kt'>jvmMain\kotlin\me\onvo\onvo\theme\splash_screen\shouldShowSplash.jvm.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.theme.splash_screen</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">shouldShowSplash</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span>
<span class="w">    </span><span class="k">get</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</pre></div>
<h2 id='nativeMain_kotlin_me_onvo_onvo_core_datastore_DataStoreFactory.native.kt'>nativeMain\kotlin\me\onvo\onvo\core\datastore\DataStoreFactory.native.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.datastore</span>


<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.core.DataStore</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.datastore.preferences.core.Preferences</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.cinterop.ExperimentalForeignApi</span>
<span class="k">import</span><span class="w"> </span><span class="nn">platform.Foundation.NSDocumentDirectory</span>
<span class="k">import</span><span class="w"> </span><span class="nn">platform.Foundation.NSFileManager</span>
<span class="k">import</span><span class="w"> </span><span class="nn">platform.Foundation.NSUserDomainMask</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalForeignApi</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">getPreferencesDataStorePath</span><span class="p">():</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">documentDirectory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSFileManager</span><span class="p">.</span><span class="na">defaultManager</span><span class="p">.</span><span class="na">URLForDirectory</span><span class="p">(</span>
<span class="w">        </span><span class="n">directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSDocumentDirectory</span><span class="p">,</span>
<span class="w">        </span><span class="n">inDomain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSUserDomainMask</span><span class="p">,</span>
<span class="w">        </span><span class="n">appropriateForURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">        </span><span class="n">create</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">requireNotNull</span><span class="p">(</span><span class="n">documentDirectory</span><span class="p">).</span><span class="na">path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;/</span><span class="si">$</span><span class="n">dataStoreFileName</span><span class="s">&quot;</span>
<span class="p">}</span>

<span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">createPreferencesDataStore</span><span class="p">():</span><span class="w"> </span><span class="n">DataStore</span><span class="o">&lt;</span><span class="n">Preferences</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getPreferencesDataStorePath</span><span class="p">()</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">getPreferencesDataStore</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
<h2 id='nativeMain_kotlin_me_onvo_onvo_core_network_HttpClientFactory.native.kt'>nativeMain\kotlin\me\onvo\onvo\core\network\HttpClientFactory.native.kt</h2><div class="highlight"><pre><span></span><span class="k">package</span><span class="w"> </span><span class="nn">me.onvo.onvo.core.network</span>



<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.HttpClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.engine.darwin.Darwin</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.contentnegotiation.ContentNegotiation</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.HttpTimeout</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.serialization.kotlinx.json.*</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.serialization.json.Json</span>
<span class="k">import</span><span class="w"> </span><span class="nn">io.ktor.client.plugins.logging.*</span>


<span class="kd">actual</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">HttpClientFactory</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">actual</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">create</span><span class="p">():</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">(</span><span class="n">Darwin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">install</span><span class="p">(</span><span class="n">ContentNegotiation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">json</span><span class="p">(</span><span class="n">Json</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ignoreUnknownKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">install</span><span class="p">(</span><span class="n">Logging</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Logger</span><span class="p">.</span><span class="na">SIMPLE</span><span class="p">;</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogLevel</span><span class="p">.</span><span class="na">INFO</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="n">install</span><span class="p">(</span><span class="n">HttpTimeout</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">requestTimeoutMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15000</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="n">engine</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">configureRequest</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// optional: configure darwin-specific things</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>


<span class="p">}</span>
</pre></div>
<h2 id='repo_viewer.py'>repo_viewer.py</h2><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jinja2</span><span class="w"> </span><span class="kn">import</span> <span class="n">Template</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pygments</span><span class="w"> </span><span class="kn">import</span> <span class="n">highlight</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pygments.lexers</span><span class="w"> </span><span class="kn">import</span> <span class="n">guess_lexer_for_filename</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pygments.formatters</span><span class="w"> </span><span class="kn">import</span> <span class="n">HtmlFormatter</span>

<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="c1"># CONFIG</span>
<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="n">SKIP_EXTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="s2">&quot;.jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;.jpeg&quot;</span><span class="p">,</span> <span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.bmp&quot;</span><span class="p">,</span> <span class="s2">&quot;.svg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;.mp4&quot;</span><span class="p">,</span> <span class="s2">&quot;.mov&quot;</span><span class="p">,</span> <span class="s2">&quot;.avi&quot;</span><span class="p">,</span> <span class="s2">&quot;.mkv&quot;</span><span class="p">,</span> <span class="s2">&quot;.webm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;.mp3&quot;</span><span class="p">,</span> <span class="s2">&quot;.wav&quot;</span><span class="p">,</span> <span class="s2">&quot;.ogg&quot;</span><span class="p">,</span> <span class="s2">&quot;.flac&quot;</span><span class="p">,</span>
    <span class="s2">&quot;.ico&quot;</span><span class="p">,</span> <span class="s2">&quot;.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;.rar&quot;</span><span class="p">,</span> <span class="s2">&quot;.7z&quot;</span><span class="p">,</span> <span class="s2">&quot;.tar&quot;</span><span class="p">,</span> <span class="s2">&quot;.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;.exe&quot;</span><span class="p">,</span> <span class="s2">&quot;.dll&quot;</span><span class="p">,</span> <span class="s2">&quot;.so&quot;</span><span class="p">,</span> <span class="s2">&quot;.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
<span class="p">}</span>

<span class="n">repo</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">repo</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SKIP_EXTS</span><span class="p">]</span>
<span class="n">formatter</span> <span class="o">=</span> <span class="n">HtmlFormatter</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;monokai&quot;</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="c1"># BUILD FOLDER TREE</span>
<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="k">def</span><span class="w"> </span><span class="nf">generate_tree</span><span class="p">(</span><span class="n">start_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="n">entries</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">start_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_file</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
        <span class="n">connector</span> <span class="o">=</span> <span class="s2">&quot;Ã¢â€â€Ã¢â€â‚¬Ã¢â€â‚¬ &quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ &quot;</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">connector</span><span class="si">}{</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">new_prefix</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;    &quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;Ã¢â€â€š   &quot;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">generate_tree</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">new_prefix</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SKIP_EXTS</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">connector</span><span class="si">}{</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lines</span>

<span class="n">tree_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">generate_tree</span><span class="p">(</span><span class="n">repo</span><span class="p">))</span>

<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="c1"># BUILD CODE CONTENTS</span>
<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="n">text_dump</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Ã°Å¸â€œ Repository Structure</span><span class="se">\n</span><span class="si">{</span><span class="n">tree_text</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Ã°Å¸â€œâ€ Code Contents</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
<span class="n">code_blocks_html</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
    <span class="n">rel_path</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span>
    <span class="n">file_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rel_path</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read_text</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="c1"># Add to plain text dump</span>
    <span class="n">text_dump</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;==== </span><span class="si">{</span><span class="n">rel_path</span><span class="si">}</span><span class="s2"> ====</span><span class="se">\n</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Highlight for HTML</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">lexer</span> <span class="o">=</span> <span class="n">guess_lexer_for_filename</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pygments.lexers</span><span class="w"> </span><span class="kn">import</span> <span class="n">TextLexer</span>
        <span class="n">lexer</span> <span class="o">=</span> <span class="n">TextLexer</span><span class="p">()</span>
    <span class="n">highlighted</span> <span class="o">=</span> <span class="n">highlight</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">lexer</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
    <span class="n">code_blocks_html</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;h2 id=&#39;</span><span class="si">{</span><span class="n">file_id</span><span class="si">}</span><span class="s2">&#39;&gt;</span><span class="si">{</span><span class="n">rel_path</span><span class="si">}</span><span class="s2">&lt;/h2&gt;</span><span class="si">{</span><span class="n">highlighted</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Write plain text file</span>
<span class="n">dump_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;repo_dump.txt&quot;</span><span class="p">)</span>
<span class="n">dump_path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_dump</span><span class="p">),</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="c1"># TEMPLATE</span>
<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">&lt;meta charset=&quot;utf-8&quot;&gt;</span>
<span class="s2">&lt;title&gt;Repo Viewer&lt;/title&gt;</span>
<span class="s2">&lt;style&gt;</span>
<span class="s2">body {</span>
<span class="s2">  background: #272822; color: #f8f8f2;</span>
<span class="s2">  font-family: monospace; padding: 20px;</span>
<span class="s2">}</span>
<span class="s2">pre.tree {</span>
<span class="s2">  background: #1e1f1c; padding: 15px;</span>
<span class="s2">  border-radius: 6px; color: #a6e22e;</span>
<span class="s2">  overflow-x: auto; line-height: 1.4;</span>
<span class="s2">}</span>
<span class="s2">h1 { color: #a6e22e; }</span>
<span class="s2">h2 {</span>
<span class="s2">  margin-top: 40px;</span>
<span class="s2">  border-bottom: 1px solid #444;</span>
<span class="s2">  color: #66d9ef;</span>
<span class="s2">  font-size: 1.1rem;</span>
<span class="s2">}</span>
<span class="s2">button {</span>
<span class="s2">  background: #66d9ef; color: #272822;</span>
<span class="s2">  border: none; padding: 10px 15px;</span>
<span class="s2">  margin-right: 10px; border-radius: 4px;</span>
<span class="s2">  cursor: pointer; font-weight: bold;</span>
<span class="s2">}</span>
<span class="s2">button:hover { background: #5cb6cf; }</span>
<span class="s2">#buttons { margin-bottom: 20px; }</span>
<span class="s2">{{ formatter.get_style_defs(&#39;.highlight&#39;) }}</span>
<span class="s2">&lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">&lt;h1&gt;Ã°Å¸â€œ Repository Structure&lt;/h1&gt;</span>

<span class="s2">&lt;div id=&quot;buttons&quot;&gt;</span>
<span class="s2">  &lt;button onclick=&quot;copyAll()&quot;&gt;Ã°Å¸â€œâ€¹ Copy All Text&lt;/button&gt;</span>
<span class="s2">  &lt;button onclick=&quot;downloadText()&quot;&gt;Ã°Å¸â€™Â¾ Download as .txt&lt;/button&gt;</span>
<span class="s2">&lt;/div&gt;</span>

<span class="s2">&lt;pre id=&quot;tree&quot; class=&quot;tree&quot;&gt;{{ tree_text }}&lt;/pre&gt;</span>

<span class="s2">&lt;h1&gt;Ã°Å¸â€œâ€ Code Contents&lt;/h1&gt;</span>
<span class="s2">&lt;div id=&quot;code&quot;&gt;{{ code_blocks|safe }}&lt;/div&gt;</span>

<span class="s2">&lt;script&gt;</span>
<span class="s2">function copyAll() {</span>
<span class="s2">  const text = document.getElementById(&quot;tree&quot;).innerText + &quot;</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">n&quot; + document.getElementById(&quot;code&quot;).innerText;</span>
<span class="s2">  navigator.clipboard.writeText(text)</span>
<span class="s2">    .then(() =&gt; alert(&quot;Ã¢Å“â€¦ All text copied to clipboard!&quot;))</span>
<span class="s2">    .catch(err =&gt; alert(&quot;Ã¢Å’ Failed to copy: &quot; + err));</span>
<span class="s2">}</span>

<span class="s2">function downloadText() {</span>
<span class="s2">  const text = document.getElementById(&quot;tree&quot;).innerText + &quot;</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">n&quot; + document.getElementById(&quot;code&quot;).innerText;</span>
<span class="s2">  const blob = new Blob([text], {type: &quot;text/plain&quot;});</span>
<span class="s2">  const url = URL.createObjectURL(blob);</span>
<span class="s2">  const a = document.createElement(&quot;a&quot;);</span>
<span class="s2">  a.href = url;</span>
<span class="s2">  a.download = &quot;repo_dump.txt&quot;;</span>
<span class="s2">  a.click();</span>
<span class="s2">  URL.revokeObjectURL(url);</span>
<span class="s2">}</span>
<span class="s2">&lt;/script&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="c1"># RENDER OUTPUT</span>
<span class="c1"># Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬Ã¢â€â‚¬</span>
<span class="n">html_output</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
    <span class="n">tree_text</span><span class="o">=</span><span class="n">tree_text</span><span class="p">,</span>
    <span class="n">code_blocks</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code_blocks_html</span><span class="p">),</span>
    <span class="n">formatter</span><span class="o">=</span><span class="n">formatter</span>
<span class="p">)</span>
<span class="n">Path</span><span class="p">(</span><span class="s2">&quot;repo_view.html&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">html_output</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ã¢Å“â€¦ Generated repo_view.html and repo_dump.txt (with copy/download buttons)&quot;</span><span class="p">)</span>
</pre></div>
</div>

<script>
function copyAll() {
  const text = document.getElementById("tree").innerText + "\n\n" + document.getElementById("code").innerText;
  navigator.clipboard.writeText(text)
    .then(() => alert("âœ… All text copied to clipboard!"))
    .catch(err => alert("âŒ Failed to copy: " + err));
}

function downloadText() {
  const text = document.getElementById("tree").innerText + "\n\n" + document.getElementById("code").innerText;
  const blob = new Blob([text], {type: "text/plain"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "repo_dump.txt";
  a.click();
  URL.revokeObjectURL(url);
}
</script>
</body>
</html>